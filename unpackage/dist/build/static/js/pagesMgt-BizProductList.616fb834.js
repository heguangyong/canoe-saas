(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesMgt-BizProductList"],{"0e23":function(t,e,a){"use strict";var n=a("d169"),i=a.n(n);i.a},"17cb":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"grid col-2"},t._l(t.productList,(function(e,n){return a("v-uni-view",{key:n},[a("v-uni-view",{staticClass:"product rel"},[a("v-uni-view",{on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.goProductDetail(e)}}},[a("v-uni-image",{staticClass:"product-image",attrs:{mode:"aspectFill",src:e.cover}}),a("v-uni-text",{staticClass:"product-title"},[t._v(t._s(e.title))]),a("v-uni-view",{staticClass:"price-line",staticStyle:{"margin-top":"-20rpx"}},[e.price>0?a("v-uni-text",{staticClass:"text-bold text-red text-lg"},[t._v(t._s("￥"+e.price))]):a("v-uni-text",{staticClass:"text-gray"},[t._v("价格面议")])],1)],1),t.isShowSwitch?a("v-uni-view",{staticClass:"cu-bar margin-left-sm margin-right-sm round",staticStyle:{"margin-top":"-20rpx"}},[a("v-uni-view",[a("v-uni-text",{class:e.on_sale?"text-red":"text-gray"},[t._v(t._s(e.state))])],1),a("v-uni-switch",{staticClass:"green",class:e.on_sale?"checked":"",attrs:{checked:!!e.on_sale},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.switchOnSale(e,n)}}})],1):t._e()],1)],1)})),1)},r=[]},"1a02":function(t,e,a){var n=a("24fb");e=n(!1),e.push([t.i,".product[data-v-31c7343f]{background-color:#fff;border-radius:%?18?%;margin:%?10?% %?10?%}.product-image[data-v-31c7343f]{background-color:#dcdcdc;width:%?350?%;height:%?350?%;border-top-left-radius:%?18?%;border-top-right-radius:%?18?%;margin-bottom:10px}.product-title[data-v-31c7343f]{margin-left:%?8?%;margin-right:%?8?%;text-overflow:ellipsis;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;height:%?70?%;font-size:%?24?%}.price-line[data-v-31c7343f]{margin-left:%?8?%;margin-right:%?8?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center}",""]),t.exports=e},"61ba":function(t,e,a){"use strict";var n;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("cu-custom",{attrs:{isBack:!0}},[a("template",{attrs:{slot:"backText"},slot:"backText"},[t._v("返回")]),a("template",{attrs:{slot:"content"},slot:"content"},[t._v("最新产品")])],2),a("v-uni-view",[t.categories.length>1?a("v-uni-view",{staticClass:"padding-sm flex flex-wrap"},t._l(t.categories,(function(e,n){return a("v-uni-view",{key:n,staticClass:"padding-xs"},[e.checked?a("v-uni-view",{staticClass:"cu-tag  line-grey round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseTag(n)}}},[t._v(t._s(e.label))]):a("v-uni-view",{staticClass:"cu-tag round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseTag(n)}}},[t._v(t._s(e.label))])],1)})),1):t._e(),t.isManageTags?a("v-uni-view",[a("v-uni-view",{staticClass:"cu-bar margin-top bg-white solid-bottom"},[a("v-uni-view",{staticClass:"action"},[a("v-uni-text",[t._v("产品标签（逗号分割）")])],1),a("v-uni-view",{staticClass:"action"},[a("v-uni-button",{staticClass:"cu-btn line-grey round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveTags.apply(void 0,arguments)}}},[t._v("保存")])],1)],1),a("v-uni-view",{staticClass:"cu-form-group align-start"},[a("v-uni-textarea",{staticClass:"bg-white",attrs:{"scroll-y":"true",maxlength:"140",placeholder:"产品标签"},model:{value:t.bizCard.tags.products,callback:function(e){t.$set(t.bizCard.tags,"products",e)},expression:"bizCard.tags.products"}})],1)],1):t._e(),a("ups-products",{attrs:{productList:t.checkedProducts,isEdit:!0,isShowSwitch:!0},on:{operateProduct:function(e){arguments[0]=e=t.$handleEvent(e),t.popupOperateProduct.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"cu-tabbar-height"}),a("v-uni-view",{staticClass:"cu-bar bg-white tabbar border foot"},[a("v-uni-button",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goMy.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"cuIcon-my"}),t._v("我的")],1),a("v-uni-button",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.manageTags.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"cuIcon-tag"}),t._v("管理标签")],1),a("v-uni-view",{staticClass:"bg-white submit text-lg"})],1)],1)],1)},r=[]},"73e5":function(t,e,a){"use strict";var n=a("4ea4");a("4160"),a("c975"),a("4d63"),a("ac1f"),a("25f0"),a("5319"),a("1276"),a("498a"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var i=n(a("1da1")),r=n(a("5530")),c=a("2f62"),s=n(a("6ac9")),o=n(a("f977")),u=n(a("d3b3")),d={components:{"ups-products":o.default,"uni-popup":s.default},data:function(){return{products:[],checkedLabels:[],checkedProducts:[],page:1,cardId:-1,bizCard:{},categories:[{label:"全部",checked:!0}],isManageTags:!1}},onShow:function(){this.getList()},onPullDownRefresh:function(){this.page=1,this.getList(),uni.stopPullDownRefresh()},onReachBottom:function(){this.page++,this.getList()},computed:(0,r.default)({},(0,c.mapState)(["user"])),methods:{getList:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,1==a.page&&(a.products=[]),n=[],i=null,e.next=6,u.default.callFunction({name:"web",data:{$url:"getProductListByCardId",cardId:a.user.userInfo.bizCardId,checkedLabels:a.checkedLabels,page:a.page}});case 6:return i=e.sent,n=JSON.parse(i.result.data),n.forEach((function(t){t.state=t.on_sale?"已上架":"未上架",a.products.push(t)})),a.checkedProducts=a.products,e.next=12,u.default.callFunction({name:"web",data:{$url:"getCardDetailById",id:a.user.userInfo.bizCardId}});case 12:i=e.sent,a.bizCard=JSON.parse(i.result.data),0==a.checkedLabels.length&&a.doCategories();case 15:case"end":return e.stop()}}),e)})))()},goMy:function(){uni.reLaunch({url:"/pages/my/home"})},manageTags:function(){this.isManageTags=!0},doCategories:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a,n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t,n=a.bizCard.tags||{card:"",products:"",activity:"",trends:""},i=n.products||"",a.categories=[{label:"全部",checked:!0,manage:!1}],r="",i=i.replace(RegExp("，","g"),","),i.indexOf(",")>0&&i.split(",").forEach((function(t){t.trim().length>0&&r.indexOf(t)<0&&(r+=t,a.categories.push({label:t,checked:!1,manage:!1}))}));case 7:case"end":return e.stop()}}),e)})))()},saveTags:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,u.default.callFunction({name:"sys",data:{$url:"updateCard",card:a.bizCard}});case 3:a.doCategories(),a.isManageTags=!1;case 5:case"end":return e.stop()}}),e)})))()},chooseTag:function(t){var e=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=e,n.checkedLabels=[],n.checkedProducts=[],0==t?(n.checkedLabels=[],n.categories[0].checked=!0,n.page=1,n.getList(),n.categories.forEach((function(t){"全部"!=t.label&&(t.checked=!1)}))):(n.categories[t].checked=!n.categories[t].checked,n.categories.forEach((function(t){t.checked&&"全部"!=t.label&&n.checkedLabels.push(t.label)})),0==n.checkedLabels.length?(n.checkedLabels=[],n.categories[0].checked=!0,n.page=1,n.getList()):(n.categories[0].checked=!1,n.page=1,n.getList())),n.$forceUpdate();case 5:case"end":return a.stop()}}),a)})))()},goAddProduct:function(){uni.navigateTo({url:"/pagesMgt/BizProductInput"})},popupOperateProduct:function(t,e,a){var n=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=n,!"switchState"){t.next=7;break}return i.products[a].on_sale=!e.on_sale,t.next=5,wx.cloud.callFunction({name:"cmn",data:{$url:"updateProduct",product:i.products[a]}});case 5:i.products[a].state=i.products[a].on_sale?"已上架":"未上架",i.$forceUpdate();case 7:case"end":return t.stop()}}),t)})))()}}};e.default=d},"7d44":function(t,e,a){"use strict";a("a9e3"),a("b680"),a("ac1f"),a("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"ups-products",props:{productList:{type:Array,required:!0},isEdit:{type:[Boolean,String],required:!1,default:!1},isShowSwitch:{type:[Boolean,String],required:!1,default:!1}},data:function(){return{}},computed:{priceArray:function(t){var e=String(Number(t).toFixed(2)).split(".");return e}},methods:{goProductDetail:function(t){var e="";e=this.isEdit?"/pagesCmn/product/ProductDetail?id="+t._id:"/pagesCmn/product/ProductDetailExt?id="+t._id,uni.navigateTo({url:e})},switchOnSale:function(t,e){this.$emit("operateProduct","switchState",t,e)}}};e.default=n},d169:function(t,e,a){var n=a("1a02");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("4f06").default;i("22b02324",n,!0,{sourceMap:!1,shadowMode:!1})},d7ca:function(t,e,a){"use strict";a.r(e);var n=a("73e5"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},e371:function(t,e,a){"use strict";a.r(e);var n=a("7d44"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},f392:function(t,e,a){"use strict";a.r(e);var n=a("61ba"),i=a("d7ca");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var c,s=a("f0c5"),o=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"e2dcb60a",null,!1,n["a"],c);e["default"]=o.exports},f977:function(t,e,a){"use strict";a.r(e);var n=a("17cb"),i=a("e371");for(var r in i)"default"!==r&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("0e23");var c,s=a("f0c5"),o=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"31c7343f",null,!1,n["a"],c);e["default"]=o.exports}}]);