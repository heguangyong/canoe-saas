(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesMgt-SendOrder"],{"0891":function(e,t,n){var i=n("429e");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var a=n("4f06").default;a("01f9876b",i,!0,{sourceMap:!1,shadowMode:!1})},"16d4":function(e,t,n){"use strict";(function(e){var i=n("4ea4");n("d3b7"),n("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("96cf");var a=i(n("1da1")),r=i(n("5530")),s=n("2f62"),o=i(n("e3fb")),u=i(n("6ac9")),c={components:{"uni-popup":u.default},data:function(){return{isUps:!1,bizCard:{},cardRecipient:{key:"",name:"",phone:"",address:""},order:{_id:"",recipient:{key:"",name:"",phone:"",address:"",remark:""},express_corp:"",express_num:""},isRecipientRemark:!1,sendTypes:["自己联系快递","无需快递"]}},onLoad:function(t){t.id&&(this.order._id=t.id,e("log","orderId",this.order._id," at pagesMgt/SendOrder.vue:125"))},onShow:function(){this.getDetail()},computed:(0,r.default)((0,r.default)({},(0,s.mapState)(["user"])),{},{formatDateTime:function(){return function(e){var t=e;return t?o.default.formatTime(t,"yyyy-MM-dd HH:mm"):""}}}),methods:(0,r.default)((0,r.default)({},(0,s.mapMutations)(["updateUser"])),{},{getDetail:function(){var e=this;return(0,a.default)(regeneratorRuntime.mark((function t(){var n,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,1==n.page&&(n.orderList=[]),i=null,t.next=5,wx.cloud.callFunction({name:"cmn",data:{$url:"getOrderById",id:n.order._id}});case 5:return i=t.sent,n.order=i.result.data,n.isRecipientRemark=!o.default.isEmpty(n.order.recipient.remark),t.next=10,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:n.user.userInfo.bizCardId}});case 10:i=t.sent,n.bizCard=i.result.data,t.t0=regeneratorRuntime.keys(n.bizCard.recipients);case 13:if((t.t1=t.t0()).done){t.next=20;break}if(a=t.t1.value,!n.bizCard.recipients[a].as_default){t.next=18;break}return n.cardRecipient=n.bizCard.recipients[a],t.abrupt("break",20);case 18:t.next=13;break;case 20:case"end":return t.stop()}}),t)})))()},goDetail:function(e){uni.navigateTo({url:"/pagesCmn/product/ProductDetailExt?id="+e})},showSendTypes:function(){var e=this;e.$nextTick((function(){e.isUps=!0,e.$refs["showPopupSendTypes"].open()}))},cancel:function(e){this.$refs["show"+e].close()},change:function(e){e.show?this.isUps=!0:this.isUps=!1},typeChange:function(e){var t=this;t.order.send_type=e.detail.value,t.$forceUpdate(),t.$refs["showPopupSendTypes"].close()},inputExpressNum:function(e){var t=this;return(0,a.default)(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=t,i.order.express_num=e.detail.value;case 2:case"end":return n.stop()}}),n)})))()},inputExpressCorp:function(e){var t=this;return(0,a.default)(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=t,i.order.express_corp=e.detail.value;case 2:case"end":return n.stop()}}),n)})))()},goCardAddress:function(){uni.navigateTo({url:"/pagesMgt/AddressList"})},sendOrder:function(){var e=this;return(0,a.default)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,"商家受理中"!=n.order.apply_state){t.next=7;break}return t.next=4,wx.cloud.callFunction({name:"cmn",data:{$url:"updateOrder",order:n.order}});case 4:uni.showToast({icon:"none",title:"顾客申请退货，无法发货！"}),t.next=22;break;case 7:if("无需快递"!=n.order.send_type){t.next=10;break}t.next=17;break;case 10:if("自己联系快递"!=n.order.send_type){t.next=17;break}if(!o.default.isEmpty(n.order.express_corp)){t.next=14;break}return uni.showToast({icon:"none",title:"需要输入快递公司"}),t.abrupt("return");case 14:if(!o.default.isEmpty(n.order.express_num)){t.next=17;break}return uni.showToast({icon:"none",title:"需要输入快递单号"}),t.abrupt("return");case 17:return n.order.order_state="shipped",t.next=20,wx.cloud.callFunction({name:"cmn",data:{$url:"updateOrder",order:n.order}});case 20:uni.showToast({icon:"success",title:"更新为发货成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),1e3);case 22:case"end":return t.stop()}}),t)})))()}})};t.default=c}).call(this,n("0de9")["log"])},"281b":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var i={uniPopup:n("6ac9").default},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{class:1==e.isUps?"prevent":""},[n("cu-custom",{attrs:{isBack:!0}},[n("template",{attrs:{slot:"backText"},slot:"backText"},[e._v("返回")]),n("template",{attrs:{slot:"content"},slot:"content"},[e._v("订单发货")])],2),n("v-uni-view",{staticClass:"page"},[n("v-uni-view",{staticClass:"cu-list menu-avatar no-padding"},[n("v-uni-view",{staticClass:"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs"},[n("v-uni-view",{staticClass:"cu-avatar round bg-green"},[n("v-uni-view",{staticClass:"text-df text-cut"},[e._v("收")])],1),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"text-grey"},[e._v(e._s(e.order.recipient.name)),n("v-uni-text",{staticClass:"margin-left-sm text-abc"},[e._v(e._s(e.order.recipient.phone))])],1),n("v-uni-view",{staticClass:"text-gray text-sm text-cut"},[e._v(e._s(e.order.recipient.address))])],1)],1)],1),n("v-uni-view",{staticClass:"margin-xs solid-bottom"},[n("v-uni-view",{staticClass:"cu-form-group",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showSendTypes.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"title"},[e._v("发货方式")]),n("v-uni-view",{staticClass:"text-right"},[e._v(e._s(e.order.send_type))]),n("v-uni-view",{staticClass:"action cuIcon-right"})],1),"自己联系快递"==e.order.send_type?[n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("快递单号")]),n("v-uni-input",{staticClass:"text-right",on:{blur:function(t){arguments[0]=t=e.$handleEvent(t),e.inputExpressNum.apply(void 0,arguments)}},model:{value:e.order.express_num,callback:function(t){e.$set(e.order,"express_num",t)},expression:"order.express_num"}})],1),n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"title"},[e._v("快递公司")]),n("v-uni-input",{staticClass:"text-right",on:{blur:function(t){arguments[0]=t=e.$handleEvent(t),e.inputExpressCorp.apply(void 0,arguments)}},model:{value:e.order.express_corp,callback:function(t){e.$set(e.order,"express_corp",t)},expression:"order.express_corp"}})],1)]:e._e()],2),n("v-uni-view",{staticClass:"cu-bar  margin-top-sm solid-bottom"},[n("v-uni-view",{staticClass:"action"},[e._v("默认退货地址")])],1),n("v-uni-view",{staticClass:"cu-list menu-avatar no-padding",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goCardAddress.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs"},[n("v-uni-view",{staticClass:"cu-avatar round"},[n("v-uni-view",{staticClass:"text-df text-cut"},[e._v(e._s(e.cardRecipient.key))])],1),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"text-grey"},[e._v(e._s(e.cardRecipient.name)),n("v-uni-text",{staticClass:"margin-left-sm text-abc"},[e._v(e._s(e.cardRecipient.phone))])],1),n("v-uni-view",{staticClass:"text-gray text-sm text-cut"},[e._v(e._s(e.cardRecipient.address))])],1),n("v-uni-view",{staticClass:"action"},[n("v-uni-text",{staticClass:"cuIcon-right text-grey",staticStyle:{"font-size":"38rpx"}})],1)],1)],1),n("v-uni-view",{staticClass:"cu-tabbar-height"}),n("v-uni-view",{staticClass:"cu-tabbar-height"}),e.isUps?e._e():n("v-uni-view",{staticClass:"cu-bar bg-white tabbar border  foot"},[n("v-uni-view",{staticClass:"bg-green submit text-lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.sendOrder.apply(void 0,arguments)}}},[e._v("立即发货")])],1)],1),e.isUps?n("v-uni-view",{staticClass:"shade"}):e._e(),n("uni-popup",{ref:"showPopupSendTypes",attrs:{type:"bottom"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.change.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"popup bg-white"},[n("v-uni-text",{staticClass:"cuIcon-close popup-close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel("PopupSendTypes")}}}),n("v-uni-text",{staticClass:"popup-title"},[e._v("选择发货方式")]),n("v-uni-view",{staticClass:"popup-content"},[n("v-uni-scroll-view",{staticClass:"ups-height",attrs:{"scroll-y":"true"}},[n("v-uni-view",[n("v-uni-radio-group",{staticClass:"block",on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.typeChange.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"cu-list menu text-left"},e._l(e.sendTypes,(function(t,i){return n("v-uni-view",{key:i,staticClass:"cu-item"},[n("v-uni-label",{staticClass:"flex justify-between align-center flex-sub"},[n("v-uni-view",{staticClass:"flex-sub"},[e._v(e._s(t))]),n("v-uni-radio",{staticClass:"round",class:t==e.order.send_type?"checked":"",attrs:{checked:t==e.item.send_type,value:t}})],1)],1)})),1)],1),n("v-uni-view",{staticClass:"cu-bar solid-bottom margin-top-xxs radius"})],1)],1)],1)],1)],1)],1)},r=[]},"429e":function(e,t,n){var i=n("24fb");t=i(!1),t.push([e.i,".page[data-v-7d307c00]{z-index:0;height:100vh}\n/* 底部分享 */.popup[data-v-7d307c00]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;height:%?420?%;padding-bottom:62px;position:fixed;left:0;bottom:0;width:100%;z-index:95;border-top-left-radius:3%;border-top-right-radius:3%}.popup-close[data-v-7d307c00]{position:absolute;top:%?30?%;left:%?30?%;font-size:%?39?%;text-align:center;font-weight:700;z-index:199}.popup-title[data-v-7d307c00]{margin-top:%?15?%;line-height:%?60?%;font-size:%?28?%;padding:%?5?% 0;text-align:center;font-weight:700}.popup-content[data-v-7d307c00]{\ndisplay:-webkit-box;display:-webkit-flex;display:flex;\n-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:5px;max-height:%?950?%}\n/* 起到固定的作用 ,从而解决原页面触摸穿透的问题*/.prevent[data-v-7d307c00]{width:100%;height:100%;\n\t/*自动回到顶部*/\n\t/*position: fixed;*/top:0;left:0;overflow:hidden}\n/* 遮罩样式 */.shade[data-v-7d307c00]{width:100%;height:100%;position:fixed;top:0;left:0;z-index:90}.ups-height[data-v-7d307c00]{height:%?350?%;position:fixed;left:0;bottom:0;z-index:99}",""]),e.exports=t},"682a":function(e,t,n){"use strict";var i=n("0891"),a=n.n(i);a.a},c0e8:function(e,t,n){"use strict";n.r(t);var i=n("16d4"),a=n.n(i);for(var r in i)"default"!==r&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=a.a},e3fb:function(e,t,n){function i(e){return""===e||("null"===e||("undefined"===e||(!e&&0!==e&&""!==e||(!(!Array.prototype.isPrototypeOf(e)||0!==e.length)||!(!Object.prototype.isPrototypeOf(e)||0!==Object.keys(e).length)))))}function a(e,t){if(e){switch(t||(t="yyyy-MM-dd"),typeof e){case"string":e=new Date(e.replace(/-/,"/"));break;case"number":e=new Date(e);break}if(!(!e instanceof Date)){var n={yyyy:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),MM:(""+(e.getMonth()+101)).substr(1),dd:(""+(e.getDate()+100)).substr(1),HH:(""+(e.getHours()+100)).substr(1),mm:(""+(e.getMinutes()+100)).substr(1),ss:(""+(e.getSeconds()+100)).substr(1)};return t.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return n[arguments[0]]}))}}}function r(){return this.dateFormat(new Date,"yyyyMMdd")}function s(e,t){if(e){switch(t||(t="yyyy-MM-dd"),typeof e){case"string":e=new Date(e);break;case"number":e=new Date(e);break}if(!(!e instanceof Date)){var n={yyyy:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),MM:(""+(e.getMonth()+101)).substr(1),dd:(""+(e.getDate()+100)).substr(1),HH:(""+(e.getHours()+100)).substr(1),mm:(""+(e.getMinutes()+100)).substr(1),ss:(""+(e.getSeconds()+100)).substr(1)};return t.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return n[arguments[0]]}))}}}function o(e,t){var n=!1,i=Date.parse(e),a=Date.parse(t),r=new Date(a).setHours(0,0,0,0);return i<r&&(n=!0),n}function u(e,t){var n=!1,i=Date.parse(e),a=Date.parse(t);return i<a&&(n=!0),n}function c(e){if(e){var t=Date.parse(e),n=Date.parse(new Date),i=Math.abs(n-t);if(i>6048e5){var a=new Date(t),r=a.getFullYear(),s=a.getMonth()+1,o=a.getDate(),u=(new Date).getFullYear();return u==r?s+"月"+o+"日":r+"年"+s+"月"+o+"日"}if(i<6048e5&&i>864e5){var c=Math.floor(i/864e5);return c+"天前"}if(i<864e5&&i>36e5){c=Math.floor(i/36e5);return c+"小时前"}if(i<36e5&&i>=0)return"刚刚"}}function d(e){var t=/^[1][3,4,5,7,8,9][0-9]{9}$/;return!(!t.test(e)||11!=e.length)}function l(){var e=new Date,t="user/"+e.getFullYear()+(""+(e.getMonth()+101)).substr(1)+"/";return t}function p(e){var t="",n=6e4,i=60*n,a=24*i,r=30*a,s=(new Date).getTime(),o=s-e;if(!(o<0)){var u=o/r,c=o/(7*a),d=o/a,l=o/i,p=o/n;return t=u>=1?parseInt(u)+"月前":c>=1?parseInt(c)+"周前":d>=1?parseInt(d)+"天前":l>=1?parseInt(l)+"小时前":p>=1?parseInt(p)+"分钟前":"刚刚",t}}n("b64b"),n("e25e"),n("ac1f"),n("5319"),e.exports={isEmpty:i,dateFormat:a,today:r,formatTime:s,isDayBefore:o,isTimeBefore:u,formatCreateTime:c,isPhoneAvailable:d,cloudUploadPath:l,getDateDiff:p}},e71a:function(e,t,n){"use strict";n.r(t);var i=n("281b"),a=n("c0e8");for(var r in a)"default"!==r&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n("682a");var s,o=n("f0c5"),u=Object(o["a"])(a["default"],i["b"],i["c"],!1,null,"7d307c00",null,!1,i["a"],s);t["default"]=u.exports}}]);