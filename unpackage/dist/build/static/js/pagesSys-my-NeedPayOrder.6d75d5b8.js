(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesSys-my-NeedPayOrder"],{2298:function(t,e,i){var a=i("26bd");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("4300e41d",a,!0,{sourceMap:!1,shadowMode:!1})},"26bd":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".page[data-v-0ddd65b6]{z-index:0;height:100vh}\n/* 底部分享 */.popup[data-v-0ddd65b6]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;height:%?920?%;padding-bottom:62px;position:fixed;left:0;bottom:0;width:100%;z-index:95;border-top-left-radius:3%;border-top-right-radius:3%}.popup-close[data-v-0ddd65b6]{position:absolute;top:%?30?%;left:%?30?%;font-size:%?39?%;text-align:center;font-weight:700;z-index:199}.popup-title[data-v-0ddd65b6]{margin-top:%?15?%;line-height:%?60?%;font-size:%?28?%;padding:%?5?% 0;text-align:center;font-weight:700}.popup-content[data-v-0ddd65b6]{\ndisplay:-webkit-box;display:-webkit-flex;display:flex;\n-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:5px;max-height:%?950?%}\n/* 起到固定的作用 ,从而解决原页面触摸穿透的问题*/.prevent[data-v-0ddd65b6]{width:100%;height:100%;\n\t/*自动回到顶部*/\n\t/*position: fixed;*/top:0;left:0;overflow:hidden}\n/* 遮罩样式 */.shade[data-v-0ddd65b6]{width:100%;height:100%;position:fixed;top:0;left:0;z-index:90}.ups-height[data-v-0ddd65b6]{height:%?850?%;position:fixed;left:0;bottom:0;z-index:99}.content-box[data-v-0ddd65b6]{\ndisplay:-webkit-box;display:-webkit-flex;display:flex;\n-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:100%}.qrcode-image[data-v-0ddd65b6]{\ndisplay:-webkit-box;display:-webkit-flex;display:flex;\n-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:%?390?%;height:%?500?%;overflow:hidden;border-radius:%?50?%}.content-text[data-v-0ddd65b6]{font-size:%?26?%;color:#333;padding-top:5px;padding-bottom:10px}",""]),t.exports=e},"6c8e":function(t,e,i){"use strict";i.r(e);var a=i("b003b"),n=i("d6a4");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("a654");var r,o=i("f0c5"),c=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"0ddd65b6",null,!1,a["a"],r);e["default"]=c.exports},9190:function(t,e,i){"use strict";(function(t){var a=i("4ea4");i("4160"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var n=a(i("1da1")),s=a(i("5530")),r=i("2f62"),o=a(i("e3fb")),c=a(i("6ac9")),u={components:{"uni-popup":c.default},data:function(){return{isLoad:!1,isUps:!1,bizCard:{},order:{_id:"",recipient:{key:"",name:"",phone:"",address:"",remark:""},items:[],order_price:0,price_items:0,price_shipping:0,order_total_item_num:0,order_num:"",create_at:null},isRecipientRemark:!1}},onLoad:function(e){e.id&&(this.order._id=e.id,t("log","orderId",this.order._id," at pagesSys/my/NeedPayOrder.vue:172"))},onShow:function(){this.getDetail()},computed:(0,s.default)((0,s.default)({},(0,r.mapState)(["user"])),{},{formatDateTime:function(){return function(t){var e=t;return e?o.default.formatTime(e,"yyyy-MM-dd HH:mm"):""}}}),methods:(0,s.default)((0,s.default)({},(0,r.mapMutations)(["updateUser"])),{},{getDetail:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,a=null,e.next=4,wx.cloud.callFunction({name:"cmn",data:{$url:"getNeedPayOrderById",_id:i.order._id}});case 4:a=e.sent,i.order=a.result.data,i.isRecipientRemark=!o.default.isEmpty(i.order.recipient.remark);case 7:case"end":return e.stop()}}),e)})))()},goDetail:function(t){uni.navigateTo({url:"/pagesCmn/product/ProductDetailExt?id="+t})},payOrder:function(e){var i=this;return(0,n.default)(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=i,n.isLoad=!0,n.order.items.forEach((function(t){t.item_state="applyReturnPay"})),n.order.order_state="needSend",n.order.pay_type=e,t("log","order",n.order," at pagesSys/my/NeedPayOrder.vue:223"),a.next=8,wx.cloud.callFunction({name:"cmn",data:{$url:"payOrder",order:n.order}});case 8:n.isLoad=!1,uni.showToast({icon:"success",title:"付款成功"}),n.$refs["showPopupPayOrder"].close(),setTimeout((function(){uni.redirectTo({url:"/pagesSys/my/WaitSendOrder?id="+n.order._id})}),1e3);case 12:case"end":return a.stop()}}),a)})))()},startTalk:function(){uni.navigateTo({url:"/pagesSys/site/service"})},cancelOrder:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,i.order.order_state="canceled",e.next=4,wx.cloud.callFunction({name:"cmn",data:{$url:"updateOrder",order:i.order}});case 4:uni.showToast({icon:"success",title:"订单已取消"}),setTimeout((function(){uni.navigateBack()}),1e3);case 6:case"end":return e.stop()}}),e)})))()},showPayOrder:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t,e.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:i.user.userInfo.bizCardId}});case 3:a=e.sent,i.bizCard=a.result.data,i.$nextTick((function(){i.isUps=!0,i.$refs["showPopupPayOrder"].open()}));case 6:case"end":return e.stop()}}),e)})))()},cancel:function(t){this.$refs["show"+t].close()},change:function(t){t.show?this.isUps=!0:this.isUps=!1},inputBillNum:function(e){var i=this;t("log","inputBillNum",e," at pagesSys/my/NeedPayOrder.vue:299"),i.order.bill_num=e.detail.value,i.$forceUpdate()}})};e.default=u}).call(this,i("0de9")["log"])},a654:function(t,e,i){"use strict";var a=i("2298"),n=i.n(a);n.a},b003b:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var a={uniPopup:i("6ac9").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{class:1==t.isUps?"prevent":""},[i("cu-custom",{attrs:{isBack:!0}},[i("template",{attrs:{slot:"backText"},slot:"backText"},[t._v("返回")]),i("template",{attrs:{slot:"content"},slot:"content"},[t._v("订单详情")]),i("template",{attrs:{slot:"right"},slot:"right"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-view",{staticClass:"cu-load load-cuIcon",class:t.isLoad?"loading":"over"})],1)],1)],2),i("v-uni-view",{staticClass:"page"},[i("v-uni-view",{staticClass:"margin-xs flex align-center text-center"},[i("v-uni-text",{staticClass:"padding-xxl bg-green text-xxl radius",staticStyle:{width:"100%"}},[t._v("待付款")])],1),i("v-uni-view",{staticClass:"cu-bar  margin-top-sm solid-bottom"},[i("v-uni-view",{staticClass:"action"},[t._v("物流信息")])],1),i("v-uni-view",{staticClass:"cu-list menu-avatar no-padding"},[i("v-uni-view",{staticClass:"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs"},[i("v-uni-view",{staticClass:"cu-avatar round"},[i("v-uni-view",{staticClass:"text-sm text-cut"},[t._v(t._s(t.order.recipient.key))])],1),i("v-uni-view",{staticClass:"content"},[i("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(t.order.recipient.name)),i("v-uni-text",{staticClass:"margin-left-sm text-abc"},[t._v(t._s(t.order.recipient.phone))])],1),i("v-uni-view",{staticClass:"text-gray text-sm text-cut"},[t._v(t._s(t.order.recipient.address))])],1)],1)],1),i("v-uni-view",{staticClass:"cu-bar  margin-top-sm solid-bottom"},[i("v-uni-view",{staticClass:"action"},[t._v("商品信息")])],1),i("v-uni-view",{staticClass:"cu-card article solid-bottom",staticStyle:{width:"100%"}},[t._l(t.order.items,(function(e,a){return[i("v-uni-view",{key:a+"_0",staticClass:"cu-item shadow flex solid-bottom",staticStyle:{margin:"0 10rpx 0 10rpx",padding:"20rpx 0"}},[i("v-uni-view",{staticClass:"content"},[i("v-uni-image",{staticClass:"bg-gray",staticStyle:{width:"30%"},attrs:{src:e.cover,mode:"aspectFill"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goDetail(e.id)}}}),i("v-uni-view",{staticClass:"desc",staticStyle:{width:"70%"}},[i("v-uni-view",{staticClass:"text-content",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goDetail(e.id)}}},[i("v-uni-text",{attrs:{clas:"text-bold"}},[t._v(t._s(e.title))]),i("v-uni-text",{staticClass:"text-cut text-sm"},[t._v(t._s(e.content))])],1),i("v-uni-view",{staticClass:"flex margin-top-sm  \ufeffjustify-between"},[i("v-uni-view",{staticClass:"cu-capsule radius "},[i("v-uni-text",{staticClass:"text-gray"},[t._v(t._s("¥ "+parseFloat(e.price).toFixed(2)+e.unit_name))])],1),i("v-uni-view",{staticClass:"text-gray"},[t._v(t._s("x"+e.num))])],1)],1)],1)],1)]}))],2),i("v-uni-view",{staticClass:"margin-xs solid-bottom"},[i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title",staticStyle:{"font-size":"26upx"}},[t._v("商品总价")]),i("v-uni-view",{staticClass:"text-left"},[t._v(t._s("¥ "+parseFloat(t.order.price_items).toFixed(2)))])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title",staticStyle:{"font-size":"26upx"}},[t._v("订单运费")]),i("v-uni-view",{staticClass:"text-left"},[t._v(t._s("¥ "+parseFloat(t.order.price_shipping).toFixed(2)))])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"}),i("v-uni-view",{staticClass:"text-left"},[t._v("共"+t._s(t.order.order_total_item_num)+"件，实付款"),i("v-uni-text",{staticClass:"margin-left-sm text-red text-lg text-bold"},[t._v(t._s("¥ "+parseFloat(t.order.order_price).toFixed(2)))])],1)],1)],1),i("v-uni-view",{staticClass:"margin-xs solid-bottom"},[i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title",staticStyle:{"font-size":"26upx"}},[t._v("订单编号")]),i("v-uni-view",{staticClass:"text-left"},[t._v(t._s(t.order.order_num))])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title",staticStyle:{"font-size":"26upx"}},[t._v("用户备注")]),i("v-uni-view",{staticClass:"text-left"},[t._v(t._s(t.order.recipient.remark))])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title",staticStyle:{"font-size":"26upx"}},[t._v("下单时间")]),i("v-uni-view",{staticClass:"text-left"},[t._v(t._s(t.formatDateTime(t.order.create_at)))])],1)],1),i("v-uni-view",{staticClass:"cu-tabbar-height"}),i("v-uni-view",{staticClass:"cu-tabbar-height"}),t.isUps?t._e():i("v-uni-view",{staticClass:"cu-bar bg-white tabbar border  foot"},[i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startTalk.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cuIcon-cu-image"},[i("v-uni-text",{staticClass:"cuIcon-message lg text-bold text-grey"})],1),i("v-uni-view",{staticClass:"text-gray"},[t._v("联系商家")])],1),i("v-uni-view",{staticClass:"action",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancelOrder.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"cuIcon-cu-image"},[i("v-uni-text",{staticClass:"cuIcon-close lg text-bold text-grey"})],1),i("v-uni-view",{staticClass:"text-gray"},[t._v("取消订单")])],1),i("v-uni-view",{staticClass:"bg-green submit text-lg",staticStyle:{width:"30%"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showPayOrder.apply(void 0,arguments)}}},[t._v("付款")])],1)],1),t.isUps?i("v-uni-view",{staticClass:"shade"}):t._e(),i("uni-popup",{ref:"showPopupPayOrder",attrs:{type:"bottom"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"popup bg-white"},[i("v-uni-text",{staticClass:"cuIcon-close popup-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel("PopupPayOrder")}}}),i("v-uni-text",{staticClass:"popup-title"},[t._v("付款")]),i("v-uni-view",{staticClass:"popup-content"},[i("v-uni-scroll-view",{staticClass:"ups-height",attrs:{"scroll-y":"true"}},t._l(t.bizCard.pay_info,(function(e,a){return e.is_open?i("v-uni-view",{key:a,staticClass:"content-box solid-bottom margin-bottom-xl"},[i("v-uni-image",{staticClass:"qrcode-image",attrs:{src:e.qrcode,mode:"aspectFit"}}),i("v-uni-view",{staticClass:"content-text"},[t._v(t._s("合计 ¥ "+parseFloat(t.order.need_price).toFixed(2)))]),i("v-uni-view",{staticClass:"content-text"},[t._v(t._s("请粘贴支付单据中的"+e.bill_num_name+":")),i("v-uni-input",{staticClass:"margin-top-lg text-bold justify-center solid-bottom bg-gray",staticStyle:{"margin-left":"-20rpx"},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.inputBillNum.apply(void 0,arguments)}},model:{value:t.order.bill_num,callback:function(e){t.$set(t.order,"bill_num",e)},expression:"order.bill_num"}})],1),i("v-uni-button",{staticClass:"cu-btn  round line-red",attrs:{disabled:t.isLoad},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.payOrder(e.title)}}},[t._v(t._s("点此确认已"+e.title))])],1):t._e()})),1)],1)],1)],1)],1)},s=[]},d6a4:function(t,e,i){"use strict";i.r(e);var a=i("9190"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},e3fb:function(t,e,i){function a(t){return""===t||("null"===t||("undefined"===t||(!t&&0!==t&&""!==t||(!(!Array.prototype.isPrototypeOf(t)||0!==t.length)||!(!Object.prototype.isPrototypeOf(t)||0!==Object.keys(t).length)))))}function n(t,e){if(t){switch(e||(e="yyyy-MM-dd"),typeof t){case"string":t=new Date(t.replace(/-/,"/"));break;case"number":t=new Date(t);break}if(!(!t instanceof Date)){var i={yyyy:t.getFullYear(),M:t.getMonth()+1,d:t.getDate(),H:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),MM:(""+(t.getMonth()+101)).substr(1),dd:(""+(t.getDate()+100)).substr(1),HH:(""+(t.getHours()+100)).substr(1),mm:(""+(t.getMinutes()+100)).substr(1),ss:(""+(t.getSeconds()+100)).substr(1)};return e.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return i[arguments[0]]}))}}}function s(){return this.dateFormat(new Date,"yyyyMMdd")}function r(t,e){if(t){switch(e||(e="yyyy-MM-dd"),typeof t){case"string":t=new Date(t);break;case"number":t=new Date(t);break}if(!(!t instanceof Date)){var i={yyyy:t.getFullYear(),M:t.getMonth()+1,d:t.getDate(),H:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),MM:(""+(t.getMonth()+101)).substr(1),dd:(""+(t.getDate()+100)).substr(1),HH:(""+(t.getHours()+100)).substr(1),mm:(""+(t.getMinutes()+100)).substr(1),ss:(""+(t.getSeconds()+100)).substr(1)};return e.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return i[arguments[0]]}))}}}function o(t,e){var i=!1,a=Date.parse(t),n=Date.parse(e),s=new Date(n).setHours(0,0,0,0);return a<s&&(i=!0),i}function c(t,e){var i=!1,a=Date.parse(t),n=Date.parse(e);return a<n&&(i=!0),i}function u(t){if(t){var e=Date.parse(t),i=Date.parse(new Date),a=Math.abs(i-e);if(a>6048e5){var n=new Date(e),s=n.getFullYear(),r=n.getMonth()+1,o=n.getDate(),c=(new Date).getFullYear();return c==s?r+"月"+o+"日":s+"年"+r+"月"+o+"日"}if(a<6048e5&&a>864e5){var u=Math.floor(a/864e5);return u+"天前"}if(a<864e5&&a>36e5){u=Math.floor(a/36e5);return u+"小时前"}if(a<36e5&&a>=0)return"刚刚"}}function l(t){var e=/^[1][3,4,5,7,8,9][0-9]{9}$/;return!(!e.test(t)||11!=t.length)}function d(){var t=new Date,e="user/"+t.getFullYear()+(""+(t.getMonth()+101)).substr(1)+"/";return e}function v(t){var e="",i=6e4,a=60*i,n=24*a,s=30*n,r=(new Date).getTime(),o=r-t;if(!(o<0)){var c=o/s,u=o/(7*n),l=o/n,d=o/a,v=o/i;return e=c>=1?parseInt(c)+"月前":u>=1?parseInt(u)+"周前":l>=1?parseInt(l)+"天前":d>=1?parseInt(d)+"小时前":v>=1?parseInt(v)+"分钟前":"刚刚",e}}i("b64b"),i("e25e"),i("ac1f"),i("5319"),t.exports={isEmpty:a,dateFormat:n,today:s,formatTime:r,isDayBefore:o,isTimeBefore:c,formatCreateTime:u,isPhoneAvailable:l,cloudUploadPath:d,getDateDiff:v}}}]);