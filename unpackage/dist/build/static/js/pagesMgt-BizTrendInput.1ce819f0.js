(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesMgt-BizTrendInput"],{1320:function(t,e,i){"use strict";(function(t){var a=i("4ea4");i("99af"),i("4160"),i("a9e3"),i("ac1f"),i("1276"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("b85c")),s=a(i("5530")),o=i("2f62"),c=i("e3fb"),r={name:"imageUploadMovable",props:{imgList:{type:Array,required:!0,default:function(){return[]}},imgSize:{type:Number,default:function(){return 80}},maxNum:{type:Number,default:9}},data:function(){return{scopeImgList:this.imgList,areaBoxInfo:{},x:0,y:0,idx:0,moveSrc:"",areaBoxTop:0,hoverImgIdx:"",inBoxXY:{}}},watch:(0,s.default)((0,s.default)({},(0,o.mapState)(["user","cloudPath"])),{},{imgList:function(){var t=this;t.scopeImgList=t.imgList,this.getDomInfo("areaBox",(function(e){t.areaBoxInfo=e,t.scopeImgList.forEach((function(i,a){t.getDomInfo("img"+a,(function(t){i.x=t.left-e.left})),t.getDomInfo("img"+a,(function(t){i.y=t.top-e.top}))}))}))}}),mounted:function(){var t=this;this.getDomInfo("areaBox",(function(e){t.areaBoxInfo=e,t.scopeImgList.forEach((function(i,a){t.getDomInfo("img"+a,(function(t){i.x=t.left-e.left})),t.getDomInfo("img"+a,(function(t){i.y=t.top-e.top}))}))}))},methods:{chooseFile:function(){var e=this,i=this.maxNum-this.scopeImgList.length;i<0&&(i=0),wx.chooseImage({count:i,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){var i,a=(0,n.default)(t.tempFilePaths);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=s.split("."),r=o[o.length-1];wx.cloud.uploadFile({cloudPath:(0,c.cloudUploadPath)()+"".concat(Date.now(),"-").concat(Math.floor(1e7*Math.random(0,1)),".")+r,filePath:s}).then((function(t){uni.hideLoading(),t.fileID&&(e.$emit("upload",t.fileID),wx.cloud.callFunction({name:"sys",data:{$url:"cloudImgSecCheck",fileID:t.fileID}}).then((function(t){0==t.result.code||uni.showToast({icon:"none",title:"图片含有违规内容，请重新选择!"})})))}))}}catch(u){a.e(u)}finally{a.f()}},fail:function(e){t("log",e," at components/ups-movable/index.vue:152")}})},viewFile:function(t){wx.previewImage({urls:this.scopeImgList[t.currentTarget.dataset.index],current:t.currentTarget.dataset.url})},deleteFile:function(t){var e=this;uni.showModal({title:"删除",content:"确定要删除?",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&e.$emit("remove",t)}})},moveHandle:function(){},onChange:function(t){},tstr:function(t,e){var i=this.areaBoxInfo.top,a=this.areaBoxInfo.left;this.x=this.scopeImgList[t].x,this.y=this.scopeImgList[t].y,this.moveSrc=this.scopeImgList[t].url,this.idx=t;var n=e.changedTouches[0].clientX-a,s=e.changedTouches[0].clientY-i;this.inBoxXY={x:n-this.scopeImgList[t].x,y:s-this.scopeImgList[t].y}},tsmo:function(t){var e=this,i=this.areaBoxInfo.top,a=this.areaBoxInfo.left,n=this.imgSize,s=t.changedTouches[0].clientX-a,o=t.changedTouches[0].clientY-i;this.x=s-this.inBoxXY.x,this.y=o-this.inBoxXY.y,this.scopeImgList.forEach((function(t,i){s>t.x&&s<t.x+n&&o>t.y&&o<t.y+n&&(e.hoverImgIdx="img"+i)}))},toend:function(e){var i=this,a=this.areaBoxInfo.top,n=this.areaBoxInfo.left,s=this.imgSize,o=e.changedTouches[0].clientX-n,c=e.changedTouches[0].clientY-a;for(var r in this.scopeImgList){var u=this.scopeImgList[r];if(o>u.x&&o<u.x+s&&c>u.y&&c<u.y+s){i.scopeImgList[i.idx].url=i.scopeImgList[r].url,i.scopeImgList[r].url=i.moveSrc;break}}this.moveSrc="",this.hoverImgIdx="",t("log","change",this.imgList,this.scopeImgList,i.scopeImgList," at components/ups-movable/index.vue:241"),this.$emit("moveEndList",this.imgList)},getDomInfo:function(t,e){var i=uni.createSelectorQuery().in(this);i.select("#"+t).boundingClientRect().exec((function(t){e(t[0])}))}}};e.default=r}).call(this,i("0de9")["log"])},"178a":function(t,e,i){"use strict";var a=i("7bab"),n=i.n(a);n.a},"2a94":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".solids[data-v-36839de3]{border:%?1?% dashed #aaa}.iconfont[data-v-36839de3]{font-size:%?100?%}",""]),t.exports=e},"2f3f":function(t,e,i){"use strict";i.r(e);var a=i("1320"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},"35ca":function(t,e,i){"use strict";i.r(e);var a=i("b119"),n=i("2f3f");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("604f");var o,c=i("f0c5"),r=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"78270430",null,!1,a["a"],o);e["default"]=r.exports},3977:function(t,e,i){"use strict";(function(t){var a=i("4ea4");i("4160"),i("c975"),i("a434"),i("4d63"),i("ac1f"),i("25f0"),i("5319"),i("1276"),i("498a"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf");var n=a(i("1da1")),s=a(i("5530")),o=i("2f62"),c=a(i("9af9")),r=a(i("35ca")),u=a(i("1b4d")),l=a(i("2f65")),d={components:{"ups-uploads":c.default,"ups-movable":r.default,"ups-product":u.default,"ups-activity":l.default},data:function(){return{trend:{carousels:[],imgList:[],videos:[],cover:"",content:"",likes_ids:[],productList:[],activityList:[]},isPickProduct:!1,productList:[],checkedProductList:[],categories:[{label:"全部",checked:!0}],activityList:[],isShowSelectPhotoOrVideo:!1,isShowResource:!1,isVideosType:!1,modalName:null,tab:["产品","活动"],tabCur:0}},onLoad:function(){var t=this;t.getProductList(),t.getActivityList()},computed:(0,s.default)({},(0,o.mapState)(["user"])),methods:{selectVideo:function(t){this.isVideosType=t,this.isShowSelectPhotoOrVideo=!0},submit:function(e){var i=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a,n,s,o,c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=i,n=a.trend.title+a.trend.content,e.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"msgSecCheck",value:n}});case 4:if(s=e.sent,0==s.result.code){e.next=8;break}return uni.showToast({icon:"none",title:"内容含有违规内容，请修改后提交"}),e.abrupt("return");case 8:if(0!=a.trend.carousels.length||0!=a.trend.videos.length){e.next=11;break}return uni.showToast({icon:"none",title:"请先选好照片或视频。"}),e.abrupt("return");case 11:return a.trend.user_id=a.user._id,a.trend.user_name=a.user.userInfo.nickName,a.trend.card_id=a.user.userInfo.bizCardId,e.next=16,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:a.user.userInfo.bizCardId}});case 16:return o=e.sent,c=o.result.data,a.trend.name=c.name,a.trend.avatar=c.avatar,a.trend.is_open_comments=!0,a.trend.place_order_flag=!1,r="",a.trend.carousels.length>0?r=a.trend.carousels[0]:a.trend.videos.length>0&&(r=a.trend.videos[0]),e.next=26,wx.cloud.callFunction({name:"sys",data:{$url:"convertFileIdToUrl",fileId:r}});case 26:return o=e.sent,a.trend.carousels.length>0?a.trend.cover=o.result.data:a.trend.videos.length>0&&(a.trend.cover=o.result.data.substring(0,o.result.data.length-3)+"jpg"),e.next=30,wx.cloud.callFunction({name:"cmn",data:{$url:"addTrend",trend:a.trend}});case 30:return o=e.sent,t("log","new trendId",o.result._id," at pagesMgt/BizTrendInput.vue:295"),e.next=34,wx.cloud.callFunction({name:"cmn",data:{$url:"genTrendQrcode",id:o.result._id,page:"pagesCmn/trend/ShareTrendDetail",width:430}});case 34:uni.showToast({icon:"success",title:"发布成功"}),setTimeout((function(){uni.navigateTo({url:"/pagesMgt/BizTrendList"})}),1e3);case 36:case"end":return e.stop()}}),e)})))()},navBack:function(t){uni.navigateBack()},newProduct:function(){uni.navigateTo({url:"/pagesMgt/BizProductInput"})},newActivity:function(){uni.navigateTo({url:"/pagesMgt/BizActivityInput"})},moveEndListHandle:function(t){var e=this;e.trend.imgList=t,e.trend.carousels=[],e.trend.imgList.forEach((function(t){e.trend.carousels.push(t.url)})),e.$forceUpdate()},uploadCarousels:function(t){var e=this;this.trend.carousels.push(t),e.trend.imgList.push({url:t}),this.$forceUpdate()},removeCarousels:function(t){this.trend.carousels.splice(t,1),this.trend.imgList.splice(t,1),this.$forceUpdate()},uploadVideos:function(t){this.trend.videos.push(t),this.$forceUpdate()},removeVideos:function(t){this.trend.videos.splice(t,1),this.trend.videos.length,this.$forceUpdate()},getProductList:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var i,a,n,s,o,c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.productList.length){e.next=18;break}return i=t,e.next=4,wx.cloud.callFunction({name:"cmn",data:{$url:"getProductListByCardId",cardId:i.user.userInfo.bizCardId}});case 4:return a=e.sent,n=a.result,n.data.forEach((function(t){i.productList.push(t)})),i.checkedProductList=i.productList,e.next=10,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:i.user.userInfo.bizCardId}});case 10:a=e.sent,s=a.result.data,o=s.tags||{card:"",product:"",activity:"",trend:""},c=o.product||"",i.categories=[{label:"全部",checked:!0}],r="",c=c.replace(RegExp("，","g"),","),c.indexOf(",")>0&&c.split(",").forEach((function(t){t.trim().length>0&&r.indexOf(t)<0&&(r+=t,i.categories.push({label:t,checked:!1}))}));case 18:case"end":return e.stop()}}),e)})))()},chooseTag:function(t){var e=this;e.isLoad=!0;var i=[];e.checkedProductList=[],0==t?(i.push("全部"),e.categories[0].checked=!0,e.checkedProductList=e.productList,e.categories.forEach((function(t){"全部"!=t.label&&(t.checked=!1)}))):(e.categories[t].checked=!e.categories[t].checked,e.categories.forEach((function(t){t.checked&&"全部"!=t.label&&i.push(t.label)})),0==i.length?(i.push("全部"),e.categories[0].checked=!0,e.checkedProductList=e.productList):(e.categories[0].checked=!1,e.productList.forEach((function(t){var a=t.tags||"";for(var n in i)if(a.indexOf(i[n])>=0){e.checkedProductList.push(t);break}})))),e.$forceUpdate()},addProduct:function(t){var e=this;e.isPickProduct=!0,e.trend.activityList=[],t.isSelected=!0,e.trend.productList.push(t),e.isShowResource=e.trend.productList.length>0,e.$forceUpdate()},removeProduct:function(t){for(var e=-1,i=0;i<this.trend.productList.length;i++)if(t._id===this.trend.productList[i]._id){e=i;break}this.trend.productList.splice(e,1),t.isSelected=!1,this.$forceUpdate()},getActivityList:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.activityList.length){e.next=7;break}return i=t,e.next=4,wx.cloud.callFunction({name:"cmn",data:{$url:"getActivityListByCardId",cardId:i.user.userInfo.bizCardId}});case 4:a=e.sent,i.activityList=a.result.data,i.activityList.length>0&&(i.activityList.forEach((function(t){t.isSelected=!1;var e=t.sign_up.date+" "+t.sign_up.time,i=t.sign_in.date+" "+t.sign_in.time;t.sign_up=e,t.sign_in=i})),i.$forceUpdate());case 7:case"end":return e.stop()}}),e)})))()},addActivity:function(t){this.isPickProduct=!1,this.trend.productList=[],t.isSelected=!0,this.trend.activityList.push(t),this.isShowResource=this.trend.activityList.length>0,this.$forceUpdate()},removeActivity:function(t){for(var e=-1,i=0;i<this.trend.activityList.length;i++)if(t._id===this.trend.activityList[i]._id){e=i;break}this.trend.activityList.splice(e,1),t.isSelected=!1,this.$forceUpdate()},showModal:function(t){this.isShowResource=!0,this.modalName=t.currentTarget.dataset.target},hideModal:function(t){this.isShowResource=!1,this.modalName=null},tabSelect:function(t){this.tabCur=t.currentTarget.dataset.id,this.scrollLeft=60*(t.currentTarget.dataset.id-1),0===this.tabCur||1===this.tabCur||this.tabCur}}};e.default=d}).call(this,i("0de9")["log"])},"3c7a":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".movarea[data-v-78270430]{width:100%;height:75px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.imgBox[data-v-78270430]{width:100%;height:75px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap}.imgBox .imgItem[data-v-78270430]{position:relative}.imgBox .imgItem uni-image[data-v-78270430]{width:75px;height:75px;-webkit-transition:all .5s;transition:all .5s;vertical-align:top}.imgBox .imgItem .closeBtn[data-v-78270430]{background-color:red;color:#fff;border-radius:50%;text-align:center;position:absolute;top:0;right:0;width:16px;height:16px;line-height:16px;z-index:3;-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.moveV[data-v-78270430]{opacity:.8;z-index:999}.moveV uni-image[data-v-78270430]{width:75px;height:75px}.select[data-v-78270430]{-webkit-transform:scale(1.3);transform:scale(1.3)}",""]),t.exports=e},"4bf1":function(t,e,i){"use strict";i.r(e);var a=i("3977"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},"5c2f":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,'.product-menu[data-v-7a55c3cc]{border-radius:%?20?%}uni-page-body[data-v-7a55c3cc]{background-image:var(--gradualBlue);width:100vw;overflow:hidden}.DrawerPage[data-v-7a55c3cc]{position:fixed;width:100vw;height:85vh;left:0;background-color:#f1f1f1;-webkit-transition:all .4s;transition:all .4s}.DrawerPage.show[data-v-7a55c3cc]{-webkit-transform:scale(.9);transform:scale(.9);left:88vw;box-shadow:0 0 %?60?% rgba(0,0,0,.2);-webkit-transform-origin:0;transform-origin:0}.DrawerWindow[data-v-7a55c3cc]{position:absolute;width:85vw;height:100vh;left:0;top:0;-webkit-transform:scale(.9) translateX(-100%);transform:scale(.9) translateX(-100%);opacity:0;pointer-events:none;-webkit-transition:all .4s;transition:all .4s;padding:%?100?% 0}.DrawerWindow.show[data-v-7a55c3cc]{-webkit-transform:scale(1) translateX(0);transform:scale(1) translateX(0);opacity:1;pointer-events:all}.DrawerClose[data-v-7a55c3cc]{position:absolute;width:40vw;height:100vh;right:0;top:0;color:transparent;padding-bottom:%?30?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:end;-webkit-align-items:flex-end;align-items:flex-end;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;background-image:-webkit-linear-gradient(left,rgba(0,0,0,.01),rgba(0,0,0,.6));background-image:linear-gradient(90deg,rgba(0,0,0,.01),rgba(0,0,0,.6));letter-spacing:5px;font-size:%?50?%;opacity:0;pointer-events:none;-webkit-transition:all .4s;transition:all .4s}.DrawerClose.show[data-v-7a55c3cc]{opacity:1;pointer-events:all;width:15vw;color:#fff}.DrawerPage .cu-bar.tabbar .action uni-button.cuIcon[data-v-7a55c3cc]{width:%?64?%;height:%?64?%;line-height:%?64?%;margin:0;display:inline-block}.DrawerPage .cu-bar.tabbar .action .cu-avatar[data-v-7a55c3cc]{margin:0}.DrawerPage .nav[data-v-7a55c3cc]{-webkit-box-flex:1;-webkit-flex:1;flex:1}.DrawerPage .nav .cu-item.cur[data-v-7a55c3cc]{border-bottom:0;position:relative}.DrawerPage .nav .cu-item.cur[data-v-7a55c3cc]::after{content:"";width:%?10?%;height:%?10?%;background-color:currentColor;position:absolute;bottom:%?10?%;border-radius:%?10?%;left:0;right:0;margin:auto}.DrawerPage .cu-bar.tabbar .action[data-v-7a55c3cc]{-webkit-box-flex:initial;-webkit-flex:initial;flex:initial}.action[data-v-7a55c3cc]{padding:%?20?% %?20?% %?20?% %?20?%;font-size:%?42?%}body.?%PAGE?%[data-v-7a55c3cc]{background-image:var(--gradualBlue)}',""]),t.exports=e},"604f":function(t,e,i){"use strict";var a=i("f083"),n=i.n(a);n.a},"6ed6":function(t,e,i){"use strict";var a=i("f943"),n=i.n(a);n.a},"7bab":function(t,e,i){var a=i("2a94");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("8e7cff12",a,!0,{sourceMap:!1,shadowMode:!1})},"7df5":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",["image"===t.fileType?i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[t._l(t.fileList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"bg-img",attrs:{"data-url":t.fileList[a]},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.viewFile.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:t.fileList[a],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":a},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteFile.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),t.fileList.length<t.maxNum?i("v-uni-view",{staticClass:"solids",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseFile.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2):t._e(),"video"===t.fileType&&t.fileList.length>=t.maxNum?i("v-uni-view",[i("v-uni-view",{staticClass:"cu-tag bg-red fr",attrs:{"data-index":"0"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteFile.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1):t._e(),"video"===t.fileType?i("v-uni-view",{staticClass:"grid col-2 grid-square flex-sub rel"},[t.fileList.length>=t.maxNum?i("v-uni-video",{attrs:{src:t.fileList[0],"object-fit":"cover",controls:!0,muted:!0}}):t._e(),t.fileList.length<t.maxNum?i("v-uni-view",{staticClass:" grid col-4 grid-square flex-sub solids",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseFile.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"iconfont icon-shangchuanshipin text-gray abs center"})],1):t._e()],1):t._e()],1)},s=[]},"7e8f":function(t,e,i){"use strict";i.r(e);var a=i("f99c"),n=i("4bf1");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("6ed6");var o,c=i("f0c5"),r=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"7a55c3cc",null,!1,a["a"],o);e["default"]=r.exports},"9af9":function(t,e,i){"use strict";i.r(e);var a=i("7df5"),n=i("c418");for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("178a");var o,c=i("f0c5"),r=Object(c["a"])(n["default"],a["b"],a["c"],!1,null,"36839de3",null,!1,a["a"],o);e["default"]=r.exports},b119:function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.moveHandle.apply(void 0,arguments)}}},[i("v-uni-movable-area",{ref:"areaBox",staticClass:"movarea",attrs:{id:"areaBox"}},[i("v-uni-view",{staticClass:"imgBox"},[t._l(t.scopeImgList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"imgItem margin-right-sm margin-bottom-sm",style:{width:t.imgSize+"px",height:t.imgSize+"px"}},[i("v-uni-image",{ref:"img"+a,refInFor:!0,class:t.hoverImgIdx==="img"+a?"select":"",attrs:{id:"img"+a,src:e.url,mode:"aspectFill"},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.tstr(a,e)},touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.tsmo.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.toend.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"closeBtn",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteFile(a)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),t.scopeImgList.length<t.maxNum?i("v-uni-view",{staticClass:"imgItem solids",style:{width:t.imgSize+"px",height:t.imgSize+"px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseFile.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"abs center",style:{width:t.imgSize/2+"px",height:t.imgSize/2+"px"},attrs:{src:"cloud://prod-9goq82ctb17bd75f.7072-prod-9goq82ctb17bd75f-1306535128/resource/addPhoto.png",mode:"aspectFill"}})],1):t._e()],2),t.moveSrc?i("v-uni-movable-view",{staticClass:"moveV",style:{width:t.imgSize+"px",height:t.imgSize+"px"},attrs:{animation:!1,x:t.x,y:t.y,direction:"all"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.onChange.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:t.moveSrc,mode:"aspectFill"}})],1):t._e()],1)],1)},s=[]},c418:function(t,e,i){"use strict";i.r(e);var a=i("f80c"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},f083:function(t,e,i){var a=i("3c7a");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("2403a29d",a,!0,{sourceMap:!1,shadowMode:!1})},f80c:function(t,e,i){"use strict";(function(t){var a=i("4ea4");i("99af"),i("4160"),i("a9e3"),i("ac1f"),i("1276"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("b85c")),s=i("e3fb"),o={name:"Upload",props:{fileType:{type:String,required:!0},fileList:{type:Array,required:!0},maxNum:{type:Number,default:9}},data:function(){return{}},methods:{chooseFile:function(){var e=this,i=this.maxNum-this.fileList.length;i<0&&(i=0),"image"===this.fileType?wx.chooseImage({count:i,sizeType:["compressed"],sourceType:["album","camera"],success:function(i){var a,o=(0,n.default)(i.tempFilePaths);try{for(o.s();!(a=o.n()).done;){var c=a.value,r=c.split("."),u=r[r.length-1];wx.cloud.uploadFile({cloudPath:(0,s.cloudUploadPath)()+"".concat(Date.now(),"-").concat(Math.floor(1e7*Math.random(0,1)),".")+u,filePath:c}).then((function(i){uni.hideLoading(),i.fileID&&(e.$emit("upload",i.fileID),wx.cloud.callFunction({name:"sys",data:{$url:"cloudImgSecCheck",fileID:i.fileID}}).then((function(e){t("log",e.result," at components/ups-uploads/index.vue:82"),0==e.result.code||uni.showToast({icon:"none",title:"图片含有违规内容，请重新选择!"})})))}))}}catch(l){o.e(l)}finally{o.f()}},fail:function(e){t("log",e," at components/ups-uploads/index.vue:97")}}):"video"===this.fileType&&uni.chooseMedia({count:1,maxDuration:15,sourceType:["camera","album"],compressed:!0,success:function(i){t("log","uRes",i," at components/ups-uploads/index.vue:107"),uni.showLoading({title:"加载中"});var a=(0,s.cloudUploadPath)()+"".concat(Date.now(),"-").concat(Math.floor(1e7*Math.random(0,1))),n=[a+".jpg",a+".mp4"],o=[i.tempFiles[0].thumbTempFilePath,i.tempFiles[0].tempFilePath];n.forEach((function(i,a){wx.cloud.uploadFile({cloudPath:n[a],filePath:o[a]}).then((function(i){t("log","res",i," at components/ups-uploads/index.vue:118"),1==a&&(uni.hideLoading(),i.statusCode<300&&e.$emit("upload",i.fileID))}))}))},fail:function(e){t("log",e," at components/ups-uploads/index.vue:131")}})},viewFile:function(t){wx.previewImage({urls:this.fileList[t.currentTarget.dataset.index],current:t.currentTarget.dataset.url})},deleteFile:function(t){var e=this;uni.showModal({title:"删除",content:"确定要删除?",cancelText:"取消",confirmText:"确定",success:function(i){i.confirm&&e.$emit("remove",t.currentTarget.dataset.index)}})}}};e.default=o}).call(this,i("0de9")["log"])},f943:function(t,e,i){var a=i("5c2f");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("5592b92f",a,!0,{sourceMap:!1,shadowMode:!1})},f99c:function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return a}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("cu-custom",{attrs:{isBack:!0}},[i("template",{attrs:{slot:"content"},slot:"content"},[t._v("布置展厅")])],2),i("v-uni-scroll-view",{staticClass:"DrawerPage",class:"viewModal"==t.modalName?"show":"",attrs:{"scroll-y":!0}},[i("v-uni-form",[i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("标题")]),i("v-uni-text",{staticClass:"cuIcon-titles text-xs text-orange"}),i("v-uni-input",{attrs:{placeholder:"添加标题..."},model:{value:t.trend.title,callback:function(e){t.$set(t.trend,"title",e)},expression:"trend.title"}})],1),i("v-uni-view",{staticClass:"cu-form-group align-start"},[i("v-uni-textarea",{attrs:{maxlength:"140",placeholder:"添加说明..."},model:{value:t.trend.content,callback:function(e){t.$set(t.trend,"content",e)},expression:"trend.content"}})],1),t.isShowSelectPhotoOrVideo?t._e():i("v-uni-view",{staticClass:"padding flex"},[i("v-uni-button",{staticClass:"\ufeffflex-sub\ufeffline-grey  margin-xs radius \ufeffjustify-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectVideo(!1)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd margin-right",staticStyle:{"font-size":"30px"}}),t._v("拍照片")],1),i("v-uni-button",{staticClass:"\ufeffflex-sub \ufeffline-grey  margin-xs radius  justify-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectVideo(!0)}}},[i("v-uni-text",{staticClass:"cuIcon-record  margin-right",staticStyle:{"font-size":"30px"}}),t._v("拍视频")],1)],1),t.isShowSelectPhotoOrVideo?i("v-uni-view",{staticClass:"margin-top-lg"},[t.isVideosType?t._e():i("v-uni-view",{staticClass:"padding"},[i("ups-movable",{attrs:{imgList:t.trend.imgList,imgSize:"75",maxNum:"9"},on:{moveEndList:function(e){arguments[0]=e=t.$handleEvent(e),t.moveEndListHandle.apply(void 0,arguments)},upload:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadCarousels.apply(void 0,arguments)},remove:function(e){arguments[0]=e=t.$handleEvent(e),t.removeCarousels.apply(void 0,arguments)}}})],1),t.isVideosType?i("v-uni-view",{staticClass:"padding"},[i("ups-uploads",{attrs:{fileType:"video",fileList:t.trend.videos,maxNum:"1"},on:{upload:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadVideos.apply(void 0,arguments)},remove:function(e){arguments[0]=e=t.$handleEvent(e),t.removeVideos.apply(void 0,arguments)}}})],1):t._e()],1):t._e(),i("v-uni-view",{staticClass:"cu-tabbar-height"}),i("v-uni-view",{staticClass:"cu-tabbar-height"}),i("v-uni-view",{staticClass:"grid col-2 padding bg-gray "},[i("v-uni-button",{staticClass:"cu-btn  round line-grey",attrs:{"data-target":"viewModal"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showModal.apply(void 0,arguments)}}},[t._v("选取关联资源")])],1),t._t("default",[i("v-uni-view",{staticClass:"cu-list menu product-menu margin-bottom-xl shadow-lg",attrs:{"scroll-y":!0}},[t.isPickProduct?t._t("default",[t.trend.productList.length>0?t._t("default",[i("v-uni-text",{staticClass:"cu-item text-30"},[t._v("关联产品")]),t._l(t.trend.productList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item flow"},[i("ups-product",{attrs:{product:e}}),i("v-uni-view",{staticClass:"action text-gray",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.removeProduct(e)}}},[i("v-uni-text",{staticClass:"cuIcon-backdelete"})],1)],1)}))]):t._t("default",[i("v-uni-view",{staticClass:"cu-item"},[i("v-uni-view",{staticClass:"content"},[i("v-uni-text",{staticClass:"cuIcon-info text-gray"}),i("v-uni-text",{staticClass:"text-gray"},[t._v("没有放置资源")])],1)],1)])]):t._e(),t.isPickProduct?t._e():t._t("default",[t.trend.activityList.length>0?t._t("default",[i("v-uni-text",{staticClass:"cu-item text-30"},[t._v("关联活动")]),t._l(t.trend.activityList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item flow"},[i("ups-activity",{attrs:{activity:e}}),i("v-uni-view",{staticClass:"action text-gray",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.removeActivity(e)}}},[i("v-uni-text",{staticClass:"cuIcon-backdelete"})],1)],1)}))]):t._t("default",[i("v-uni-view",{staticClass:"cu-item"},[i("v-uni-view",{staticClass:"content "},[i("v-uni-text",{staticClass:"cuIcon-info text-gray"}),i("v-uni-text",{staticClass:"text-gray"},[t._v("没有放置资源")])],1)],1)])])],2)])],2)],1),t.isShowResource?t._e():i("v-uni-view",{staticClass:"cu-bar btn-group  foot bg-white"},[i("v-uni-button",{staticClass:"cu-btn   round line-grey",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.navBack.apply(void 0,arguments)}}},[t._v("取消")]),i("v-uni-button",{staticClass:"cu-btn   round line-grey",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("发布")])],1),i("v-uni-view",{staticClass:"DrawerClose",class:"viewModal"==t.modalName?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideModal.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-pullright"})],1),i("v-uni-scroll-view",{staticClass:"DrawerWindow",class:"viewModal"==t.modalName?"show":"",attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg"},[i("v-uni-scroll-view",{staticClass:"bg-white nav",attrs:{"scroll-x":!0}},[i("v-uni-view",{staticClass:"flex text-center"},t._l(2,(function(e,a){return i("v-uni-view",{key:a,staticClass:"cu-item flex-sub \ufeffsolid-bottom",class:a==t.tabCur?"text-green cur":"",attrs:{"data-id":a},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.tabSelect.apply(void 0,arguments)}}},[t._v(t._s(t.tab[a]))])})),1)],1),0==t.tabCur?t._t("default",[t.productList.length>0?t._t("default",[t.categories.length>1?i("v-uni-view",{staticClass:"padding-sm flex flex-wrap"},t._l(t.categories,(function(e,a){return i("v-uni-view",{key:a,staticClass:"padding-xs"},[e.checked?i("v-uni-view",{staticClass:"cu-tag bg-green radius",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseTag(a)}}},[t._v(t._s(e.label))]):i("v-uni-view",{staticClass:"cu-tag line-gray radius",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.chooseTag(a,e)}}},[t._v(t._s(e.label))])],1)})),1):t._e(),t._l(t.checkedProductList,(function(e,a){return e.isSelected?t._e():i("v-uni-view",{key:a,staticClass:"cu-item flow"},[i("ups-product",{attrs:{product:e}}),i("v-uni-view",{staticClass:"action text-gray",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.addProduct(e)}}},[i("v-uni-text",{staticClass:"cuIcon-add"})],1)],1)}))]):t._e(),0==t.productList.length?t._t("default",[i("v-uni-view",{staticClass:"cu-item arrow",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.newProduct.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"content"},[i("v-uni-text",{staticClass:"cuIcon-cart text-grey"}),i("v-uni-text",{staticClass:"text-grey"},[t._v("新增展品")])],1)],1)]):t._e()]):t._e(),1==t.tabCur?t._t("default",[t.activityList.length>0?t._t("default",t._l(t.activityList,(function(e,a){return e.isSelected?t._e():i("v-uni-view",{key:a,staticClass:"cu-item flow"},[i("ups-activity",{attrs:{activity:e}}),i("v-uni-view",{staticClass:"action text-gray",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.addActivity(e)}}},[i("v-uni-text",{staticClass:"cuIcon-add"})],1)],1)}))):t._e(),0==t.activityList.length?t._t("default",[i("v-uni-view",{staticClass:"cu-item arrow",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.newActivity.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"content "},[i("v-uni-text",{staticClass:"cuIcon-new text-grey"}),i("v-uni-text",{staticClass:"text-grey"},[t._v("新增活动")])],1)],1)]):t._e()]):t._e()],2)],1)],1)},s=[]}}]);