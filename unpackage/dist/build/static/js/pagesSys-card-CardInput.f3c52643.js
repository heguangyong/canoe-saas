(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesSys-card-CardInput"],{"198a":function(e,t,a){"use strict";a.r(t);var n=a("abb8"),i=a("2c5d");for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("8fca");var s,c=a("f0c5"),o=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"609dce10",null,!1,n["a"],s);t["default"]=o.exports},"2c5d":function(e,t,a){"use strict";a.r(t);var n=a("c4af"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},"3a66":function(e,t,a){"use strict";var n=a("d183"),i=a.n(n);i.a},"3eb2":function(e,t,a){"use strict";a.r(t);var n=a("c3ed"),i=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=i.a},4024:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".padding[data-v-609dce10]{padding:%?10?%}.text-box[data-v-609dce10]{height:%?100?%;\n\t/* background-color: #FFFFFF; */-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:%?24?%;color:#353535;line-height:1.8}uni-video[data-v-609dce10]{width:%?750?%}uni-image[data-v-609dce10]{width:%?750?%}.card-radius[data-v-609dce10]{border-radius:%?10?%}\n\n/* 起到固定的作用 ,从而解决原页面触摸穿透的问题*/.prevent[data-v-609dce10]{width:100%;height:100%;\n\t/*自动回到顶部*/\n\t/*position: fixed;*/top:0;left:0;overflow:hidden}\n\n/* 遮罩样式 */.shade[data-v-609dce10]{width:100%;height:100%;position:fixed;top:0;left:0;z-index:90}.popup[data-v-609dce10]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;height:%?950?%;padding-bottom:62px;position:fixed;left:0;bottom:0;width:100%;z-index:95;border-top-left-radius:3%;border-top-right-radius:3%}.trend-remove-popup[data-v-609dce10]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:5px;height:%?350?%}.popup-close[data-v-609dce10]{position:absolute;top:%?30?%;left:%?30?%;font-size:%?39?%;text-align:center;font-weight:700;z-index:99}.popup-title[data-v-609dce10]{margin-top:%?15?%;line-height:%?60?%;font-size:%?28?%;padding:%?5?% 0;text-align:center;font-weight:700}.popup-content[data-v-609dce10]{\ndisplay:-webkit-box;display:-webkit-flex;display:flex;\n-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:5px;max-height:%?850?%}",""]),e.exports=t},"476e":function(e,t,a){"use strict";a.r(t);var n=a("88aa"),i=a("3eb2");for(var r in i)"default"!==r&&function(e){a.d(t,e,(function(){return i[e]}))}(r);a("3a66");var s,c=a("f0c5"),o=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"29cb287b",null,!1,n["a"],s);t["default"]=o.exports},"88aa":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",["image"===e.fileType?a("v-uni-view",{staticClass:"flex-sub"},[e.uploadFile?a("v-uni-view",{staticClass:"bg-img",attrs:{"data-url":e.uploadFile},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.viewFile.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"cu-avatar",attrs:{src:e.uploadFile,mode:"aspectFill"}}),a("v-uni-view",{staticClass:"cu-avatar bg-red",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteFile.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-close"})],1)],1):a("v-uni-view",{staticClass:"solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseFile.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1)],1):a("v-uni-view",{staticClass:"grid col-2 grid-square flex-sub rel"},[e.uploadFile?a("v-uni-view",[e.uploadFile?a("v-uni-video",{attrs:{src:e.uploadFile,"object-fit":"cover",controls:!0,muted:!0}}):e._e()],1):a("v-uni-view",{staticClass:" grid col-4 grid-square flex-sub solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseFile.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"iconfont icon-shangchuanshipin text-gray abs center"})],1)],1)],1)},r=[]},"8fca":function(e,t,a){"use strict";var n=a("b8dd"),i=a.n(n);i.a},abb8:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var n={uniPopup:a("6ac9").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{class:1==e.isUps?"prevent":""},[a("cu-custom",{attrs:{isBack:!0}},[a("template",{attrs:{slot:"backText"},slot:"backText"},[e._v("返回")]),a("template",{attrs:{slot:"content"},slot:"content"},[e._v("名片")])],2),a("v-uni-scroll-view",[a("v-uni-form",[a("v-uni-view",{staticClass:"padding"},[a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("姓名")]),a("v-uni-text",{staticClass:"cuIcon-titles text-xs text-orange"}),a("v-uni-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.card.name,callback:function(t){e.$set(e.card,"name",t)},expression:"card.name"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("手机号码")]),a("v-uni-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.card.phone,callback:function(t){e.$set(e.card,"phone",t)},expression:"card.phone"}}),a("v-uni-button",{staticClass:"cu-btn round  line-grey",attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(t){arguments[0]=t=e.$handleEvent(t),e.getPhoneNumber.apply(void 0,arguments)}}},[e._v("授权手机号")])],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("头像")]),a("v-uni-view",[a("ups-upload",{attrs:{fileType:"image",uploadFile:e.card.avatar},on:{upload:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadAvatar.apply(void 0,arguments)},remove:function(t){arguments[0]=t=e.$handleEvent(t),e.removeAvatar.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("封面")]),a("v-uni-view",[a("ups-upload",{attrs:{fileType:"image",uploadFile:e.card.cover},on:{upload:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadCover.apply(void 0,arguments)},remove:function(t){arguments[0]=t=e.$handleEvent(t),e.removeCover.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("微信号")]),a("v-uni-input",{model:{value:e.card.wx_number,callback:function(t){e.$set(e.card,"wx_number",t)},expression:"card.wx_number"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("邮箱")]),a("v-uni-input",{model:{value:e.card.email,callback:function(t){e.$set(e.card,"email",t)},expression:"card.email"}})],1),a("v-uni-view",{staticClass:"cu-form-group margin-top-xxs"},[a("v-uni-view",{staticClass:"title"},[e._v("公司名称")]),a("v-uni-input",{attrs:{disabled:e.isBindComp},model:{value:e.card.corp_name,callback:function(t){e.$set(e.card,"corp_name",t)},expression:"card.corp_name"}}),a("v-uni-text",{staticClass:"cuIcon-searchlist",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.tapSearch.apply(void 0,arguments)}}})],1),e.isLinked?a("v-uni-view",{staticClass:"cu-list menu-avatar"},[a("v-uni-view",{staticClass:"cu-item"},[a("v-uni-view",{staticClass:"cu-avatar round lg"},[a("v-uni-image",{staticClass:"cu-avatar round lg",attrs:{src:e.currentUser.userInfo.bizCardAvatar,mode:"aspectFill"}})],1),a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"text-grey"},[e._v(e._s(e.currentUser.userInfo.bizCardName)),a("v-uni-text",{staticClass:"text-abc"})],1)],1),a("v-uni-view",[a("buttom",{staticClass:"cu-btn line-grey round light margin-left",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.removeLinked.apply(void 0,arguments)}}},[e._v("解除关联")])],1)],1)],1):e._e(),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("职位")]),a("v-uni-input",{model:{value:e.card.corp_position,callback:function(t){e.$set(e.card,"corp_position",t)},expression:"card.corp_position"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("导航地址")]),a("v-uni-view",{staticClass:"cuIcon-locationfill",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseAddress.apply(void 0,arguments)}}},[e._v(e._s(e.hasAddress?e.card.corp_address.address:"请选择地址"))])],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("联系地址")]),a("v-uni-input",{model:{value:e.card.mailing_address,callback:function(t){e.$set(e.card,"mailing_address",t)},expression:"card.mailing_address"}})],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[e._v("介绍")])],1),a("v-uni-textarea",{staticClass:"text-box font40 bg-white width100 padding-sm solid",staticStyle:{height:"500rpx"},attrs:{"scroll-y":"true",maxlength:"1200",placeholder:"请输入文字介绍"},model:{value:e.card.introduce,callback:function(t){e.$set(e.card,"introduce",t)},expression:"card.introduce"}})],1)],1),a("v-uni-view",{staticClass:"cu-tabbar-height"})],1),e.isUps?e._e():e._t("default",[a("v-uni-view",{staticClass:"cu-bar btn-group foot bg-white",staticStyle:{"z-index":"99"}},[a("v-uni-button",{staticClass:"cu-btn  round line-grey",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancelSubmit.apply(void 0,arguments)}}},[e._v("取消")]),a("v-uni-button",{staticClass:"cu-btn  round line-grey",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")])],1)]),e.isUps?a("v-uni-view",{staticClass:"shade"}):e._e(),a("uni-popup",{ref:"showBizCard",attrs:{type:"bottom"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.change.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"popup bg-white"},[a("v-uni-text",{staticClass:"cuIcon-close popup-close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel("BizCard")}}}),a("v-uni-text",{staticClass:"popup-title"},[e._v("公司列表")]),a("v-uni-view",{staticClass:"cu-bar search "},[a("v-uni-view",{staticClass:"search-form round"},[a("v-uni-text",{staticClass:"cuIcon-search"}),a("v-uni-input",{attrs:{type:"text",placeholder:"输入搜索的关键词","confirm-type":"search"},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.inputFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.inputBlur.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"action"},[a("v-uni-button",{staticClass:"cu-btn round line-grey",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getSearchList.apply(void 0,arguments)}}},[e._v("搜索")])],1)],1),a("v-uni-view",{staticClass:"popup-content"},[a("v-uni-scroll-view",{style:[{height:"calc(100vh - "+e.CustomBar+"px - 50px)"}],attrs:{"scroll-y":!0}},[e._l(e.list,(function(t,n){return[a("v-uni-view",{key:n+"_0",staticClass:"padding"},[e._v(e._s(e.list[n].group))]),a("v-uni-view",{key:n+"_1",staticClass:"cu-list menu-avatar no-padding"},e._l(t.subList,(function(t,n){return a("v-uni-view",{key:n,staticClass:"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs shadow rel"},[(t.card_type,a("v-uni-view",{staticClass:"cu-avatar round lg",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.goEdit(t.id)}}},[a("v-uni-image",{staticClass:"cu-avatar round lg",attrs:{src:t.avatar,mode:"aspectFill"}})],1)),a("v-uni-view",{staticClass:"content",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.goEdit(t.id)}}},[a("v-uni-view",{staticClass:"text-grey"},[e._v(e._s(t.name)),a("v-uni-text",{staticClass:"text-abc"})],1),a("v-uni-view",{staticClass:"text-gray text-sm"},[e._v(e._s(t.position?t.position:""))])],1),a("v-uni-view",[a("buttom",{staticClass:"cu-btn margin-left line-grey round",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.addLink(t)}}},[e._v("关联")])],1)],1)})),1)]})),a("v-uni-view",{staticClass:"cu-tabbar-height"})],2)],1)],1)],1)],2)},r=[]},b8dd:function(e,t,a){var n=a("4024");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("019afd9c",n,!0,{sourceMap:!1,shadowMode:!1})},c3ed:function(e,t,a){"use strict";(function(e){var n=a("4ea4");a("99af"),a("ac1f"),a("1276"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("b85c")),r=a("e3fb"),s={name:"UpsUpload",props:{fileType:{type:String,required:!0},uploadFile:{type:String,required:!0}},data:function(){return{}},methods:{chooseFile:function(){var t=this;"image"===this.fileType?uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(a){var n,s=(0,i.default)(a.tempFilePaths);try{for(s.s();!(n=s.n()).done;){var c=n.value,o=c.split("."),u=o[o.length-1];wx.cloud.uploadFile({cloudPath:(0,r.cloudUploadPath)()+"".concat(Date.now(),"-").concat(Math.floor(1e7*Math.random(0,1)),".")+u,filePath:c}).then((function(a){uni.hideLoading(),a.fileID&&(t.$emit("upload",a.fileID),wx.cloud.callFunction({name:"sys",data:{$url:"cloudImgSecCheck",fileID:a.fileID}}).then((function(t){e("log",t.result," at components/ups-upload/index.vue:70"),0==t.result.code||uni.showToast({icon:"none",title:"图片含有违规内容，请重新选择!"})})))}))}}catch(d){s.e(d)}finally{s.f()}},fail:function(t){e("log",t," at components/ups-upload/index.vue:86")}}):"video"===this.fileType&&uni.chooseVideo({count:1,maxDuration:15,sourceType:["camera","album"],compressed:!1,success:function(a){e("log",a," at components/ups-upload/index.vue:96"),uni.showLoading({title:"加载中"});wx.cloud.uploadFile({cloudPath:(0,r.cloudUploadPath)()+"".concat(Date.now(),"-").concat(Math.floor(1e7*Math.random(0,1)),".png"),filePath:a.tempFilePath}).then((function(e){uni.hideLoading(),e.statusCode<300&&t.$emit("upload",e.fileID)}))},fail:function(t){e("log",t," at components/ups-upload/index.vue:109")}})},viewFile:function(e){wx.previewImage({urls:this.uploadFile,current:e.currentTarget.dataset.url})},deleteFile:function(e){var t=this;uni.showModal({title:"删除",content:"确定要删除?",cancelText:"取消",confirmText:"确定",success:function(e){e.confirm&&t.$emit("remove")}})}}};t.default=s}).call(this,a("0de9")["log"])},c4af:function(e,t,a){"use strict";(function(e){var n=a("4ea4");a("498a"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var i=n(a("1da1")),r=n(a("5530")),s=a("2f62"),c=n(a("476e")),o=n(a("6ac9")),u={components:{"ups-upload":c.default,"uni-popup":o.default},data:function(){return{card:{corp_address:{address:"",latitude:0,longitude:0},mailing_address:""},isUps:!1,listGroup:{},CustomBar:this.CustomBar,list:[{}],index:-1,subList:[],listCur:"",searchList:[{}],page:1,search_str:"",hasAddress:!1,currentUser:{},isLinked:!1}},onReady:function(){this.getDetail()},computed:(0,r.default)({},(0,s.mapState)(["user"])),methods:(0,r.default)((0,r.default)({},(0,s.mapMutations)(["updateUser"])),{},{getDetail:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t,e("log","getDetail user:",n.user," at pagesSys/card/CardInput.vue:191"),!n.user._id){a.next=12;break}return n.currentUser=n.user,n.isLinked=n.currentUser.userInfo.bizCardId.trim().length>0,a.next=7,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailByUserId",userId:n.user._id||"0"}});case 7:i=a.sent,e("log","getDetail",i," at pagesSys/card/CardInput.vue:202"),0==i.result.code&&(n.card=i.result.data,n.card.corp_address?n.hasAddress=!0:(n.hasAddress=!1,n.card.corp_address={address:"",latitude:0,longitude:0}),n.user.userInfo.bizCardName&&n.user.userInfo.bizCardName.length>0&&(n.card.corp_name=n.user.userInfo.bizCardName)),a.next=20;break;case 12:n.card.user_id=n.user._id||"0",n.card.name=n.user.userInfo.nickName,n.card.avatar=n.user.userInfo.avatarUrl,n.card.videos=[],n.card.carousels=[],n.card.corp_address={address:"",latitude:0,longitude:0},n.card.mailing_address="",n.hasAddress=!1;case 20:case"end":return a.stop()}}),a)})))()},getPhoneNumber:function(e){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t,a.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"getPhone",cloudId:e.detail.cloudID}});case 3:i=a.sent,0==i.result.code&&(uni.showToast({title:"授权成功",success:function(){}}),n.card.phone=i.result.data.phoneNumber,n.$forceUpdate());case 5:case"end":return a.stop()}}),a)})))()},uploadAvatar:function(e){this.card.avatar=e,this.$forceUpdate()},removeAvatar:function(){this.card.avatar="",this.$forceUpdate()},uploadCover:function(e){this.card.cover=e,this.$forceUpdate()},removeCover:function(){this.card.cover="",this.$forceUpdate()},bindCompany:function(){this.isUps=!0,this.$refs.showComments.open()},cancelSubmit:function(){uni.navigateBack()},submit:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t,i=/^[a-zA-Z\u4e00-\u9fa5]+$/,e("log","reg",i.test(n.card.name)," at pagesSys/card/CardInput.vue:272"),n.card.name&&i.test(n.card.name)){a.next=6;break}return uni.showToast({icon:"none",title:"姓名需字母或汉字开头"}),a.abrupt("return");case 6:return e("log","card",n.card,n.card.phone," at pagesSys/card/CardInput.vue:280"),r=n.card.name+n.card.introduce+n.card.wx_number+n.card.corp_name+n.card.corp_position+n.card.mailing_address,a.next=10,wx.cloud.callFunction({name:"sys",data:{$url:"msgSecCheck",value:r}});case 10:if(s=a.sent,e("log",s," at pagesSys/card/CardInput.vue:289"),0==s.result.code){a.next=15;break}return uni.showToast({icon:"none",title:"内容含有违规内容，请修改后提交"}),a.abrupt("return");case 15:if(!n.card._id){a.next=18;break}return a.next=18,wx.cloud.callFunction({name:"sys",data:{$url:"updateCard",card:n.card}});case 18:uni.reLaunch({url:"/pagesSys/card/CardDetail?id="+n.card._id});case 19:case"end":return a.stop()}}),a)})))()},getSearchList:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.user._id){a.next=2;break}return a.abrupt("return");case 2:return n=t,n.list=[],n.index=0,n.subList=[],t.page=1,n.updateSearchList(),a.next=10,wx.cloud.callFunction({name:"sys",data:{$url:"searchBizCardList",search_str:n.search_str,page:n.page}});case 10:if(i=a.sent,e("log","page",n.page,"searchList.length",i.result.data.length," at pagesSys/card/CardInput.vue:331"),0!=i.result.code){a.next=17;break}if(n.searchList=i.result.data||[],!(0==n.searchList.length||n.page>=5)){a.next=16;break}return a.abrupt("return");case 16:n.cachedPageList();case 17:case"end":return a.stop()}}),a)})))()},getNextPage:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t,a.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"searchBizCardList",search_str:n.search_str,page:n.page}});case 3:if(i=a.sent,e("log","page",n.page,"searchList.length",i.result.data.length," at pagesSys/card/CardInput.vue:351"),0!=i.result.code){a.next=10;break}if(n.searchList=i.result.data||[],!(0==n.searchList.length||n.page>=5)){a.next=9;break}return a.abrupt("return");case 9:n.cachedPageList();case 10:case"end":return a.stop()}}),a)})))()},cachedPageList:function(){var t=this,a=t.searchList[0].group_index;for(var n in t.searchList){var i=!1;t.user._id==t.searchList[n].user_id&&(i=!0,t.searchList[n].has_holder=!0,t.searchList[n].in_exchange=!1),i||(t.searchList[n].has_holder=!1,t.searchList[n].in_exchange=!1),t.searchList[n].id=t.searchList[n]._id,t.searchList[n].position=t.searchList[n].corp_position,a==t.searchList[n].group_index||(t.list[t.index]={},t.list[t.index].group=a,t.list[t.index].subList=t.subList,t.index++,t.subList=[],a=t.searchList[n].group_index),t.subList.push(t.searchList[n]),n==t.searchList.length-1&&(t.list[t.index]={},t.list[t.index].group=a,t.list[t.index].subList=t.subList)}e("log","list",t.list,"index",t.index,"subList",t.subList," at pagesSys/card/CardInput.vue:399"),t.listCur=t.list[20*(t.page-1)],t.searchList.length<20||t.$forceUpdate()},updateSearchList:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"getCardHolderByUserId",userId:a.user._id}});case 3:n=t.sent,n.result,a.$forceUpdate();case 6:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){that.list=[],that.index=0,that.subList=[],this.page=1,uni.stopPullDownRefresh()},inputFocus:function(t){e("log",t," at pagesSys/card/CardInput.vue:427")},inputBlur:function(t){e("log",t," at pagesSys/card/CardInput.vue:430"),this.searchList=[],this.search_str=t.detail.value,this.page=1},cancel:function(e){this.$refs["show"+e].close()},change:function(e){e.show?this.isUps=!0:this.isUps=!1},tapSearch:function(){var e=this;this.getSearchList(),this.$nextTick((function(){e.isUps=!0,e.$refs["showBizCard"].open()}))},addLink:function(t){var a=this;return(0,i.default)(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=a,e("log","addLink",t," at pagesSys/card/CardInput.vue:454"),i.currentUser.userInfo.bizCardAvatar=t.avatar,i.currentUser.userInfo.bizCardName=t.name,i.currentUser.userInfo.bizCardId=t._id,i.card.corp_name=t.name,n.next=8,wx.cloud.callFunction({name:"sys",data:{$url:"updateUserInfo",id:i.currentUser._id,userInfo:i.currentUser.userInfo}});case 8:i.isLinked=!0,a.$refs["showBizCard"].close(),i.updateUser(i.user),i.$forceUpdate();case 12:case"end":return n.stop()}}),n)})))()},removeLinked:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,a.isLinked=!1,a.currentUser.userInfo.bizCardAvatar="",a.currentUser.userInfo.bizCardName="",a.currentUser.userInfo.bizCardId="",t.next=7,wx.cloud.callFunction({name:"sys",data:{$url:"updateUserInfo",id:a.currentUser._id,userInfo:a.currentUser.userInfo}});case 7:a.updateUser(a.user),a.$forceUpdate();case 9:case"end":return t.stop()}}),t)})))()},chooseAddress:function(){var t=this;wx.getSetting({success:function(a){e("log","get-setting",a.authSetting," at pagesSys/card/CardInput.vue:493");var n=a.authSetting;n["scope.userLocation"]||void 0===n["scope.userLocation"]?t.getUserLocation():n["scope.userLocation"]||wx.showModal({title:"是否授权当前位置？",content:"需要获取您的地理位置，请确认授权，否则定位功能将无法使用",success:function(a){a.confirm&&wx.openSetting({success:function(a){e("log","open-setting-suc",a.authSetting," at pagesSys/card/CardInput.vue:512");var n=a.authSetting;n["scope.userLocation"]?t.getUserLocation():wx.showToast({title:"地址授权失败，定位功能无法使用",icon:"none"})},fail:function(t){e("log","open-setting-fail",t," at pagesSys/card/CardInput.vue:526")}})}})}})},getUserLocation:function(){var t=this;wx.chooseLocation({success:function(a){e("log",a," at pagesSys/card/CardInput.vue:541"),e("log",t.card," at pagesSys/card/CardInput.vue:542"),t.card.corp_address?(t.card.corp_address.address=a.address,t.card.corp_address.latitude=a.latitude,t.card.corp_address.longitude=a.longitude):(t.card.corp_address={address:"",latitude:0,longitude:0},t.card.corp_address.address=a.address,t.card.corp_address.latitude=a.latitude,t.card.corp_address.longitude=a.longitude),t.hasAddress=!0,t.$forceUpdate()}})}})};t.default=u}).call(this,a("0de9")["log"])},d183:function(e,t,a){var n=a("f3d9");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("69669d2c",n,!0,{sourceMap:!1,shadowMode:!1})},e3fb:function(e,t,a){function n(e){return""===e||("null"===e||("undefined"===e||(!e&&0!==e&&""!==e||(!(!Array.prototype.isPrototypeOf(e)||0!==e.length)||!(!Object.prototype.isPrototypeOf(e)||0!==Object.keys(e).length)))))}function i(e,t){if(e){switch(t||(t="yyyy-MM-dd"),typeof e){case"string":e=new Date(e.replace(/-/,"/"));break;case"number":e=new Date(e);break}if(!(!e instanceof Date)){var a={yyyy:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),MM:(""+(e.getMonth()+101)).substr(1),dd:(""+(e.getDate()+100)).substr(1),HH:(""+(e.getHours()+100)).substr(1),mm:(""+(e.getMinutes()+100)).substr(1),ss:(""+(e.getSeconds()+100)).substr(1)};return t.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return a[arguments[0]]}))}}}function r(){return this.dateFormat(new Date,"yyyyMMdd")}function s(e,t){if(e){switch(t||(t="yyyy-MM-dd"),typeof e){case"string":e=new Date(e);break;case"number":e=new Date(e);break}if(!(!e instanceof Date)){var a={yyyy:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),H:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),MM:(""+(e.getMonth()+101)).substr(1),dd:(""+(e.getDate()+100)).substr(1),HH:(""+(e.getHours()+100)).substr(1),mm:(""+(e.getMinutes()+100)).substr(1),ss:(""+(e.getSeconds()+100)).substr(1)};return t.replace(/(yyyy|MM?|dd?|HH?|ss?|mm?)/g,(function(){return a[arguments[0]]}))}}}function c(e,t){var a=!1,n=Date.parse(e),i=Date.parse(t),r=new Date(i).setHours(0,0,0,0);return n<r&&(a=!0),a}function o(e,t){var a=!1,n=Date.parse(e),i=Date.parse(t);return n<i&&(a=!0),a}function u(e){if(e){var t=Date.parse(e),a=Date.parse(new Date),n=Math.abs(a-t);if(n>6048e5){var i=new Date(t),r=i.getFullYear(),s=i.getMonth()+1,c=i.getDate(),o=(new Date).getFullYear();return o==r?s+"月"+c+"日":r+"年"+s+"月"+c+"日"}if(n<6048e5&&n>864e5){var u=Math.floor(n/864e5);return u+"天前"}if(n<864e5&&n>36e5){u=Math.floor(n/36e5);return u+"小时前"}if(n<36e5&&n>=0)return"刚刚"}}function d(e){var t=/^[1][3,4,5,7,8,9][0-9]{9}$/;return!(!t.test(e)||11!=e.length)}function l(){var e=new Date,t="user/"+e.getFullYear()+(""+(e.getMonth()+101)).substr(1)+"/";return t}function p(e){var t="",a=6e4,n=60*a,i=24*n,r=30*i,s=(new Date).getTime(),c=s-e;if(!(c<0)){var o=c/r,u=c/(7*i),d=c/i,l=c/n,p=c/a;return t=o>=1?parseInt(o)+"月前":u>=1?parseInt(u)+"周前":d>=1?parseInt(d)+"天前":l>=1?parseInt(l)+"小时前":p>=1?parseInt(p)+"分钟前":"刚刚",t}}a("b64b"),a("e25e"),a("ac1f"),a("5319"),e.exports={isEmpty:n,dateFormat:i,today:r,formatTime:s,isDayBefore:c,isTimeBefore:o,formatCreateTime:u,isPhoneAvailable:d,cloudUploadPath:l,getDateDiff:p}},f3d9:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".solids[data-v-29cb287b]{border:%?1?% dashed #aaa}.iconfont[data-v-29cb287b]{font-size:%?100?%}",""]),e.exports=t}}]);