(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesMgt/BizActivityInput"],{484:function(t,e,i){"use strict";(function(t){i(5);n(i(4));var e=n(i(485));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i(1)["createPage"])},485:function(t,e,i){"use strict";i.r(e);var n=i(486),a=i(488);for(var r in a)"default"!==r&&function(t){i.d(e,t,(function(){return a[t]}))}(r);i(490);var o,c=i(15),u=Object(c["default"])(a["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],o);u.options.__file="pagesMgt/BizActivityInput.vue",e["default"]=u.exports},486:function(t,e,i){"use strict";i.r(e);var n=i(487);i.d(e,"render",(function(){return n["render"]})),i.d(e,"staticRenderFns",(function(){return n["staticRenderFns"]})),i.d(e,"recyclableRender",(function(){return n["recyclableRender"]})),i.d(e,"components",(function(){return n["components"]}))},487:function(t,e,i){"use strict";var n;i.r(e),i.d(e,"render",(function(){return a})),i.d(e,"staticRenderFns",(function(){return o})),i.d(e,"recyclableRender",(function(){return r})),i.d(e,"components",(function(){return n}));var a=function(){var t=this,e=t.$createElement;t._self._c},r=!1,o=[];a._withStripped=!0},488:function(t,e,i){"use strict";i.r(e);var n=i(489),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},489:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i(9)),a=i(12),r=o(i(39));function o(t){return t&&t.__esModule?t:{default:t}}function c(t,e,i,n,a,r,o){try{var c=t[r](o),u=c.value}catch(s){return void i(s)}c.done?e(u):Promise.resolve(u).then(n,a)}function u(t){return function(){var e=this,i=arguments;return new Promise((function(n,a){var r=t.apply(e,i);function o(t){c(r,n,a,o,u,"next",t)}function u(t){c(r,n,a,o,u,"throw",t)}o(void 0)}))}}function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v=function(){Promise.all([i.e("common/vendor"),i.e("components/ups-uploads/index")]).then(function(){return resolve(i(867))}.bind(null,i)).catch(i.oe)},f=function(){Promise.all([i.e("common/vendor"),i.e("components/ups-upload/index")]).then(function(){return resolve(i(838))}.bind(null,i)).catch(i.oe)},y={components:{"ups-uploads":v,"ups-upload":f},data:function(){return{activityId:"",activity:{address:{},carousels:[],video:[],phone_require:!1,people_num:0,cover:"",sponsor:{},sign_up:{date:"",time:""},sign_in:{date:"",time:""}},fields:[{id:0,title:"开始时间",name:"time",isShow:!0},{id:1,title:"截止时间",name:"countdown",isShow:!0},{id:2,title:"联系人",name:"service",isShow:!0},{id:3,title:"地址",name:"location",isShow:!0},{id:4,title:"人数限制",name:"group",isShow:!1},{id:5,title:"填写手机",name:"mobile",isShow:!1},{id:6,title:"活动封面",name:"pic",isShow:!0},{id:7,title:"活动图片",name:"album",isShow:!1},{id:8,title:"活动视频",name:"record",isShow:!1}]}},onLoad:function(t){var e=this;t.id&&(e.activityId=t.id),e.activity.sign_up.date=r.default.dateFormat(new Date,"yyyy-MM-dd"),e.activity.sign_up.time=r.default.dateFormat(new Date,"HH:mm"),e.activity.sign_in.date=r.default.dateFormat(new Date,"yyyy-MM-dd"),e.activity.sign_in.time=r.default.dateFormat(new Date,"HH:mm"),t.id&&wx.cloud.callFunction({name:"cmn",data:{$url:"getActivityDetail",id:e.activityId}}).then((function(t){e.activity=t.result.data,e.activity.sign_up&&(e.fields[0].isShow=!0),e.activity.sign_in&&(e.fields[1].isShow=!0),e.activity.sponsor&&(e.fields[2].isShow=!0),e.activity.address&&(e.fields[3].isShow=!0),e.activity.people_num&&(e.fields[4].isShow=!0),e.activity.phone_require&&(e.fields[5].isShow=!0),e.activity.cover&&(e.fields[6].isShow=!0),e.activity.carousels.length>0&&(e.fields[7].isShow=!0),e.activity.video&&(e.fields[8].isShow=!0),e.activity.hasEnroll=!1,e.activity.enroll_ids&&e.user._id&&e.activity.enroll_ids.indexOf(e.user._id)>-1&&(e.activity.hasEnroll=!0),e.activity.hasSignIn=!1,e.activity.sign_in_ids&&e.user._id&&e.activity.sign_in_ids.indexOf(e.user._id)>-1&&(e.activity.hasSignIn=!0)}))},computed:d({},(0,a.mapState)(["user"])),methods:{submit:function(){var e=this;return u(n.default.mark((function i(){var a,r,o,c;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=e,r="",a.activity.title||(r+=" 主题"),a.activity.sponsor.contactor&&a.activity.sponsor.phone||(r+=" 联系人"),a.activity.address.street||(r+=" 地址"),a.activity.content||(r+=" 详情"),a.activity.cover||(r+=" 活动封面"),!(r.length>0)){i.next=11;break}return t.showToast({icon:"none",title:"请输入必填信息："+r}),a.isLoad=!1,i.abrupt("return");case 11:return i.next=13,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:a.user.userInfo.bizCardId}});case 13:if(o=i.sent,c=o.result.data,a.activity.name=c.name,a.activity.avatar=c.avatar,!(a.activityId.length>0)){i.next=22;break}return i.next=20,wx.cloud.callFunction({name:"cmn",data:{$url:"updateActivity",activity:a.activity}});case 20:i.next=29;break;case 22:return a.activity.card_id=a.user.userInfo.bizCardId,i.next=25,wx.cloud.callFunction({name:"cmn",data:{$url:"addActivity",activity:a.activity}});case 25:return o=i.sent,a.activity._id=o.result._id,i.next=29,wx.cloud.callFunction({name:"cmn",data:{$url:"genActivityQrcode",id:a.activity._id,page:"pagesCmn/activity/ShareActivityDetail",width:430}});case 29:t.showToast({icon:"success",title:"提交成功"}),setTimeout((function(){t.navigateTo({url:"/pagesMgt/BizActivityList"})}),500);case 31:case"end":return i.stop()}}),i)})))()},navback:function(e){t.navigateBack()},switchShow:function(t,e){var i=this;i.fields[e].isShow=!t.isShow},uploadCover:function(t){this.activity.cover=t},removeCover:function(){this.activity.cover=""},uploadCarousels:function(t){this.activity.carousels.push(t)},removeCarousels:function(t){this.activity.carousels.splice(t,1)},uploadVideo:function(t){this.activity.video.push(t)},removeVideo:function(t){this.activity.video.splice(t,1)},signUpDateChange:function(t){this.activity.sign_up.date=t.detail.value},signUpTimeChange:function(t){this.activity.sign_up.time=t.detail.value},signInDateChange:function(t){this.activity.sign_in.date=t.detail.value},signInTimeChange:function(t){this.activity.sign_in.time=t.detail.value},onPhoneRequireChange:function(t){t.phone_require=!t.phone_require}}};e.default=y}).call(this,i(1)["default"])},490:function(t,e,i){"use strict";i.r(e);var n=i(491),a=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,(function(){return n[t]}))}(r);e["default"]=a.a},491:function(t,e,i){}},[[484,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/pagesMgt/BizActivityInput.js.map