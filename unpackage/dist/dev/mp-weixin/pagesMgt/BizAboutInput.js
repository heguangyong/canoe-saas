(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesMgt/BizAboutInput"],{416:function(e,t,r){"use strict";(function(e){r(5);n(r(4));var t=n(r(417));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=r,e(t.default)}).call(this,r(1)["createPage"])},417:function(e,t,r){"use strict";r.r(t);var n=r(418),a=r(420);for(var o in a)"default"!==o&&function(e){r.d(t,e,(function(){return a[e]}))}(o);r(422);var s,i=r(15),c=Object(i["default"])(a["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],s);c.options.__file="pagesMgt/BizAboutInput.vue",t["default"]=c.exports},418:function(e,t,r){"use strict";r.r(t);var n=r(419);r.d(t,"render",(function(){return n["render"]})),r.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(t,"components",(function(){return n["components"]}))},419:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"render",(function(){return a})),r.d(t,"staticRenderFns",(function(){return s})),r.d(t,"recyclableRender",(function(){return o})),r.d(t,"components",(function(){return n}));var a=function(){var e=this,t=e.$createElement;e._self._c},o=!1,s=[];a._withStripped=!0},420:function(e,t,r){"use strict";r.r(t);var n=r(421),a=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},421:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(9)),a=r(12);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r,n,a,o,s){try{var i=e[o](s),c=i.value}catch(u){return void r(u)}i.done?t(c):Promise.resolve(c).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){s(o,n,a,i,c,"next",e)}function c(e){s(o,n,a,i,c,"throw",e)}i(void 0)}))}}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-uploads/index")]).then(function(){return resolve(r(867))}.bind(null,r)).catch(r.oe)},p=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-upload/index")]).then(function(){return resolve(r(838))}.bind(null,r)).catch(r.oe)},f=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-movable/index")]).then(function(){return resolve(r(860))}.bind(null,r)).catch(r.oe)},_={components:{"ups-uploads":l,"ups-upload":p,"ups-movable":f},data:function(){return{card:{carousels:[],imgList:[],videos:[]},hasAddress:!1,currentUser:{}}},onLoad:function(e){var t=this;e.id&&(t.card._id=e.id,t.getBizCardDetail(e.id))},computed:u({},(0,a.mapState)(["user","httpPath"])),methods:{getBizCardDetail:function(e){var t=this;return i(n.default.mark((function r(){var a,o;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t,r.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:e}});case 3:o=r.sent,console.log(o),a.card=o.result.data,a.card.corp_address?a.hasAddress=!0:(a.hasAddress=!1,a.card.corp_address={address:"",latitude:0,longitude:0}),a.card.imgList=[],a.card.carousels&&a.card.carousels.length>0&&a.card.carousels.forEach((function(e){a.card.imgList.push({url:e})}));case 9:case"end":return r.stop()}}),r)})))()},uploadAvatar:function(e){this.card.avatar=e,this.$forceUpdate()},removeAvatar:function(){this.card.avatar="",this.$forceUpdate()},moveEndListHandle:function(e){var t=this;t.card.imgList=e,t.card.carousels=[],t.card.imgList.forEach((function(e){t.card.carousels.push(e.url)})),t.$forceUpdate()},uploadCarousels:function(e){this.card.carousels||(this.card.carousels=[]),this.card.carousels.push(e),this.card.imgList.push({url:e}),this.$forceUpdate()},removeCarousels:function(e){this.card.carousels.splice(e,1),this.card.imgList.splice(e,1),this.$forceUpdate()},uploadVideos:function(e){this.card.videos||(this.card.videos=[]),this.card.videos.push(e),this.$forceUpdate()},removeVideos:function(e){this.card.videos.splice(e,1),this.$forceUpdate()},cancelSubmit:function(){e.navigateBack()},submit:function(){var t=this;return i(n.default.mark((function r(){var a,o,s,i;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t,o=a.card.name+a.card.introduce,r.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"msgSecCheck",value:o}});case 4:if(s=r.sent,console.log(s),0==s.result.code){r.next=9;break}return e.showToast({icon:"none",title:"内容含有违规内容，请修改后提交"}),r.abrupt("return");case 9:if(!a.card._id){r.next=14;break}return r.next=12,wx.cloud.callFunction({name:"sys",data:{$url:"updateCard",card:a.card}});case 12:r.next=24;break;case 14:return a.card.site_bg="https://7072-prod-9goq82ctb17bd75f-1306535128.tcb.qcloud.la/resource/MainBg.png",a.card.site=[{title:"最新产品",name:"product",color:"purple",cuIcon:"shop",isOpen:!0,auth:!0},{title:"企业展厅",name:"trend",color:"mauve",cuIcon:"pic",isOpen:!0,auth:!0},{title:"线上活动",name:"activity",color:"cyan",cuIcon:"activity",isOpen:!0,auth:!0},{title:"客服沟通",name:"service",color:"blue",cuIcon:"service",isOpen:!0,auth:!0},{title:"企业服务",name:"company",color:"red",cuIcon:"moreandroid",isOpen:!0,auth:!0},{title:"关于我们",name:"about",color:"green",cuIcon:"info",isOpen:!0,auth:!0}],a.card.accounts=[{account_key:"0000",api_map:{},h5_link:"/pagesSys/card/CardDetail",is_forbidden:!1,is_show:!0,name:"vipcard",need_role:"normal",password:"",remark:"",support_h5:!0,title:"我的名片",url:"/pagesSys/card/CardDetail",user_name:"",view_count:0},{account_key:"1100",api_map:{},h5_link:"",is_forbidden:!1,is_show:!0,name:"edit",need_role:"cardAdmin",password:"",remark:"",support_h5:!1,title:"关于我们",url:"/pagesMgt/BizCardInput",user_name:"",view_count:0},{account_key:"2200",api_map:{},h5_link:"/pagesMgt/BizProductList",is_forbidden:!0,is_show:!0,name:"goods",need_role:"cardAdmin",password:"",remark:"",support_h5:!0,title:"最新产品",url:"/pagesMgt/BizProductList",user_name:"",view_count:0},{account_key:"3300",api_map:{},h5_link:"/pagesMgt/BizActivityList",is_forbidden:!0,is_show:!0,name:"activity",need_role:"cardAdmin",password:"",remark:"",support_h5:!0,title:"线上活动",url:"/pagesMgt/BizActivityList",user_name:"",view_count:0},{account_key:"4400",api_map:{},h5_link:"",is_forbidden:!0,is_show:!0,name:"record",need_role:"cardAdmin",password:"",remark:"",support_h5:!1,title:"企业展厅",url:"/pagesMgt/BizTrendList",user_name:"",view_count:0},{account_key:"5500",api_map:{},h5_link:"/pagesMgt/BizMsgList",is_forbidden:!0,is_show:!0,name:"community",need_role:"cardAdmin",password:"",remark:"",support_h5:!0,title:"客服消息",url:"/pagesMgt/BizMsgList",user_name:"",view_count:0},{account_key:"8810",api_map:{},h5_link:"",is_forbidden:!0,is_show:!1,name:"news",need_role:"cardAdmin",password:"",remark:"",support_h5:!1,title:"企业服务",url:"/pagesMgt/BizCardList",user_name:"",view_count:"0"},{account_key:"8800",api_map:{},h5_link:"/pagesMgt/PersonCardList",is_forbidden:!0,is_show:!0,name:"friend",need_role:"cardAdmin",password:"",remark:"",support_h5:!0,title:"用户管理",url:"/pagesMgt/PersonCardList",user_name:"",view_count:0},{account_key:"9900",api_map:{},h5_link:"/pagesMgt/BizServiceList",is_forbidden:!0,is_show:!0,name:"global",need_role:"sysAdmin",password:"",remark:"",support_h5:!0,title:"系统配置",url:"/pagesMgt/BizServiceList",user_name:"",view_count:0}],r.next=19,wx.cloud.callFunction({name:"sys",data:{$url:"addBizCard",card:a.card}});case 19:return i=r.sent,a.card._id=i.result._id,console.log("新建企业名片 ID",i),r.next=24,wx.cloud.callFunction({name:"sys",data:{$url:"genBizCardQrcode",cardId:a.card._id,page:"/pagesSys/card/BizAboutExt?id="+a.card._id,width:430}});case 24:e.reLaunch({url:"/pagesSys/card/BizAboutExt?id="+a.card._id});case 25:case"end":return r.stop()}}),r)})))()},chooseAddress:function(){var e=this;wx.getSetting({success:function(t){console.log("get-setting",t.authSetting);var r=t.authSetting;r["scope.userLocation"]||void 0===r["scope.userLocation"]?e.getUserLocation():r["scope.userLocation"]||wx.showModal({title:"是否授权当前位置？",content:"需要获取您的地理位置，请确认授权，否则定位功能将无法使用",success:function(t){t.confirm&&wx.openSetting({success:function(t){console.log("open-setting-suc",t.authSetting);var r=t.authSetting;r["scope.userLocation"]?e.getUserLocation():wx.showToast({title:"地址授权失败，定位功能无法使用",icon:"none"})},fail:function(e){console.log("open-setting-fail",e)}})}})}})},getUserLocation:function(){var e=this;wx.chooseLocation({success:function(t){console.log(t),console.log(e.card),e.card.corp_address?(e.card.corp_address.address=t.address,e.card.corp_address.latitude=t.latitude,e.card.corp_address.longitude=t.longitude):(e.card.corp_address={address:"",latitude:0,longitude:0},e.card.corp_address.address=t.address,e.card.corp_address.latitude=t.latitude,e.card.corp_address.longitude=t.longitude),e.hasAddress=!0,e.$forceUpdate()}})}}};t.default=_}).call(this,r(1)["default"])},422:function(e,t,r){"use strict";r.r(t);var n=r(423),a=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},423:function(e,t,r){}},[[416,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/pagesMgt/BizAboutInput.js.map