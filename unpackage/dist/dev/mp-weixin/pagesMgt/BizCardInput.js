(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesMgt/BizCardInput"],{408:function(e,t,r){"use strict";(function(e){r(5);n(r(4));var t=n(r(409));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=r,e(t.default)}).call(this,r(1)["createPage"])},409:function(e,t,r){"use strict";r.r(t);var n=r(410),o=r(412);for(var c in o)"default"!==c&&function(e){r.d(t,e,(function(){return o[e]}))}(c);r(414);var a,s=r(15),i=Object(s["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],a);i.options.__file="pagesMgt/BizCardInput.vue",t["default"]=i.exports},410:function(e,t,r){"use strict";r.r(t);var n=r(411);r.d(t,"render",(function(){return n["render"]})),r.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(t,"components",(function(){return n["components"]}))},411:function(e,t,r){"use strict";var n;r.r(t),r.d(t,"render",(function(){return o})),r.d(t,"staticRenderFns",(function(){return a})),r.d(t,"recyclableRender",(function(){return c})),r.d(t,"components",(function(){return n}));var o=function(){var e=this,t=e.$createElement;e._self._c},c=!1,a=[];o._withStripped=!0},412:function(e,t,r){"use strict";r.r(t);var n=r(413),o=r.n(n);for(var c in n)"default"!==c&&function(e){r.d(t,e,(function(){return n[e]}))}(c);t["default"]=o.a},413:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(r(9)),o=r(12);function c(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,n,o,c,a){try{var s=e[c](a),i=s.value}catch(u){return void r(u)}s.done?t(i):Promise.resolve(i).then(n,o)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function s(e){a(c,n,o,s,i,"next",e)}function i(e){a(c,n,o,s,i,"throw",e)}s(void 0)}))}}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-uploads/index")]).then(function(){return resolve(r(867))}.bind(null,r)).catch(r.oe)},f=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-upload/index")]).then(function(){return resolve(r(838))}.bind(null,r)).catch(r.oe)},p=function(){Promise.all([r.e("common/vendor"),r.e("components/ups-movable/index")]).then(function(){return resolve(r(860))}.bind(null,r)).catch(r.oe)},h={components:{"ups-uploads":l,"ups-upload":f,"ups-movable":p},data:function(){return{title:"",card:{corp_address:{address:"",latitude:0,longitude:0},mailing_address:"",carousels:[],imgList:[],videos:[]},hasAddress:!1,currentUser:{}}},onLoad:function(e){this.title=e.title,this.getBizCardDetail()},computed:u({},(0,o.mapState)(["user"])),methods:{getBizCardDetail:function(){var e=this;return s(n.default.mark((function t(){var r,o;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e,t.next=3,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:r.user.userInfo.bizCardId}});case 3:o=t.sent,console.log(o),r.card=o.result.data,r.card._id?(r.card.corp_address?r.hasAddress=!0:(r.hasAddress=!1,r.card.corp_address={address:"",latitude:0,longitude:0}),r.card.imgList=[],r.card.carousels.forEach((function(e){r.card.imgList.push({url:e})}))):(r.card.videos=[],r.card.carousels=[],r.card.corp_address={address:"",latitude:0,longitude:0},r.card.mailing_address="",r.hasAddress=!1);case 7:case"end":return t.stop()}}),t)})))()},uploadCover:function(e){this.card.cover=e,this.$forceUpdate()},removeCover:function(){this.card.cover="",this.$forceUpdate()},uploadAvatar:function(e){this.card.avatar=e,this.$forceUpdate()},removeAvatar:function(){this.card.avatar="",this.$forceUpdate()},moveEndListHandle:function(e){var t=this;t.card.imgList=e,t.card.carousels=[],t.card.imgList.forEach((function(e){t.card.carousels.push(e.url)})),t.$forceUpdate()},uploadCarousels:function(e){this.card.carousels||(this.card.carousels=[]),this.card.carousels.push(e),this.card.imgList.push({url:e}),this.$forceUpdate()},removeCarousels:function(e){this.card.carousels.splice(e,1),this.card.imgList.splice(e,1),this.$forceUpdate()},uploadVideos:function(e){this.card.videos||(this.card.videos=[]),this.card.videos.push(e),this.$forceUpdate()},removeVideos:function(e){this.card.videos.splice(e,1),this.$forceUpdate()},cancelSubmit:function(){e.navigateBack()},submit:function(){var t=this;return s(n.default.mark((function r(){var o,c,a;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=t,c=o.card.name+o.card.introduce,r.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"msgSecCheck",value:c}});case 4:if(a=r.sent,console.log(a),0==a.result.code){r.next=9;break}return e.showToast({icon:"none",title:"内容含有违规内容，请修改后提交"}),r.abrupt("return");case 9:if(!o.card._id){r.next=12;break}return r.next=12,wx.cloud.callFunction({name:"sys",data:{$url:"updateCard",card:o.card}});case 12:e.reLaunch({url:"/pagesSys/site/about"});case 13:case"end":return r.stop()}}),r)})))()},chooseAddress:function(){var e=this;wx.getSetting({success:function(t){console.log("get-setting",t.authSetting);var r=t.authSetting;r["scope.userLocation"]||void 0===r["scope.userLocation"]?e.getUserLocation():r["scope.userLocation"]||wx.showModal({title:"是否授权当前位置？",content:"需要获取您的地理位置，请确认授权，否则定位功能将无法使用",success:function(t){t.confirm&&wx.openSetting({success:function(t){console.log("open-setting-suc",t.authSetting);var r=t.authSetting;r["scope.userLocation"]?e.getUserLocation():wx.showToast({title:"地址授权失败，定位功能无法使用",icon:"none"})},fail:function(e){console.log("open-setting-fail",e)}})}})}})},getUserLocation:function(){var e=this;wx.chooseLocation({success:function(t){e.card.corp_address||(e.card.corp_address={address:"",latitude:0,longitude:0}),e.card.corp_address.address=t.address,e.card.corp_address.latitude=t.latitude,e.card.corp_address.longitude=t.longitude,e.hasAddress=!0,e.$forceUpdate()}})}}};t.default=h}).call(this,r(1)["default"])},414:function(e,t,r){"use strict";r.r(t);var n=r(415),o=r.n(n);for(var c in n)"default"!==c&&function(e){r.d(t,e,(function(){return n[e]}))}(c);t["default"]=o.a},415:function(e,t,r){}},[[408,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/pagesMgt/BizCardInput.js.map