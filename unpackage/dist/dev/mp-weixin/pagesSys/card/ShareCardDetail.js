(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesSys/card/ShareCardDetail"],{100:function(e,t,n){},86:function(e,t,n){"use strict";(function(e){n(5);r(n(4));var t=r(n(87));function r(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},87:function(e,t,n){"use strict";n.r(t);var r=n(88),a=n(90);for(var u in a)"default"!==u&&function(e){n.d(t,e,(function(){return a[e]}))}(u);n(99);var o,i=n(15),c=Object(i["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"2ef45369",null,!1,r["components"],o);c.options.__file="pagesSys/card/ShareCardDetail.vue",t["default"]=c.exports},88:function(e,t,n){"use strict";n.r(t);var r=n(89);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},89:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return o})),n.d(t,"recyclableRender",(function(){return u})),n.d(t,"components",(function(){return r}));try{r={uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,810))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.isUps?null:e.canTalk());e.$mp.data=Object.assign({},{$root:{m0:n}})},u=!1,o=[];a._withStripped=!0},90:function(e,t,n){"use strict";n.r(t);var r=n(91),a=n.n(r);for(var u in r)"default"!==u&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a},91:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(9)),a=n(12);u(n(92));function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,a,u,o){try{var i=e[u](o),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function i(e){o(u,r,a,i,c,"next",e)}function c(e){o(u,r,a,i,c,"throw",e)}i(void 0)}))}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){n.e("components/ups-card/index").then(function(){return resolve(n(831))}.bind(null,n)).catch(n.oe)},f=function(){n.e("components/ups-waterfalls/index").then(function(){return resolve(n(817))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/uni-popup/uni-popup").then(function(){return resolve(n(810))}.bind(null,n)).catch(n.oe)},h={components:{"ups-card":l,"ups-waterfalls":f,"uni-popup":p},data:function(){return{card:{_id:"",qrcode:""},cardUser:{},trendList:[],page:1,isUps:!1,authBizInfo:{}}},onLoad:function(e){var t=this;if(e.id)t.card._id=e.id,t.getDetailById();else if(e.userId)t.userId=e.userId,t.getDetailByUserId();else if(e.scene){var n={},r=decodeURIComponent(e.scene).split("&");r.forEach((function(e){var r=e.split("=");n[r[0]]=r[1],"qrcode"==r[0]&&(t.card.qrcode=r[1])})),t.getDetailByQrcode()}},onShareAppMessage:function(e){return e.from,{title:"这是"+this.card.name+"的名片，请惠存。",imageUrl:this.card.cover||"",path:"/pagesSys/card/ShareCardDetail?id="+this.card._id,success:function(e){}}},computed:s(s({},(0,a.mapState)(["needAuthFlag","user","cardAccount"])),{},{canTalk:function(){return function(){var e=this.user.userInfo||{cardId:""},t=this.card._id;return t.length>0&&e.cardId!=t}}}),methods:s(s({},(0,a.mapMutations)(["needWxAuth","wxAuth","updateUser","updateUserAuth"])),{},{getDetailById:function(){var e=this;return i(r.default.mark((function t(){var n,a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,a={},t.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailById",id:n.card._id}});case 4:a=t.sent,n.card=a.result.data,n.initTrendList(n.card);case 7:case"end":return t.stop()}}),t)})))()},getDetailByUserId:function(){var e=this;return i(r.default.mark((function t(){var n,a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,a={},t.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailByUserId",userId:n.userId}});case 4:a=t.sent,n.card=a.result.data,n.initTrendList(n.card);case 7:case"end":return t.stop()}}),t)})))()},getDetailByQrcode:function(){var e=this;return i(r.default.mark((function t(){var n,a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,a={},t.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"getCardDetailByQrcode",qrcode:n.card.qrcode}});case 4:a=t.sent,n.card=a.result.data,n.initTrendList(n.card);case 7:case"end":return t.stop()}}),t)})))()},initTrendList:function(e){var t=this;return i(r.default.mark((function n(){var a,u,o,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t,console.log("card",e),n.next=4,wx.cloud.callFunction({name:"sys",data:{$url:"getUserDetail",id:e.user_id}});case 4:return u=n.sent,console.log("cardUser",u),a.cardUser=u.result.data,o=[],1==a.page&&(a.trendList=[]),n.next=11,wx.cloud.callFunction({name:"cmn",data:{$url:"getTrendListByCardId",cardId:a.cardUser.userInfo.bizCardId,page:a.page}});case 11:u=n.sent,o=u.result.data,i=o[0],a.authBizInfo={_id:i.card_id,name:i.name,avatar:i.avatar},a.needWxAuth(a.authBizInfo),o.forEach((function(e){a.trendList.push({id:e._id,image_url:e.cover,title:e.title||"",carousels:e.carousels||[],needAuthFlag:a.needAuthFlag})}));case 17:case"end":return n.stop()}}),n)})))()},doAuth:function(){var e=this;return i(r.default.mark((function t(){var n;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,!n.needAuthFlag){t.next=5;break}return n.wxAuth(n.authBizInfo),setTimeout((function(){n.doAuth()}),2e3),t.abrupt("return");case 5:n.updateUserAuth(n.authBizInfo),n.trendList.forEach((function(e){e.needAuthFlag=!1})),n.$forceUpdate();case 8:case"end":return t.stop()}}),t)})))()},getTrendList:function(){var e=this;return i(r.default.mark((function t(){var n,a,u;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e,a=[],u=null,1==n.page&&(n.trendList=[]),t.next=6,wx.cloud.callFunction({name:"cmn",data:{$url:"getTrendListByCardId",cardId:n.cardUser.userInfo.bizCardId,page:n.page}});case 6:u=t.sent,a=u.result.data,a.forEach((function(e){n.trendList.push({id:e._id,image_url:e.cover,title:e.title||"",carousels:e.carousels||[],needAuthFlag:n.needAuthFlag})}));case 9:case"end":return t.stop()}}),t)})))()},onPullDownRefresh:function(){this.page=1,this.getTrendList(),this.trendList=[],this.$refs.upsWaterfalls.refresh(),e.stopPullDownRefresh()},onReachBottom:function(){this.page++,this.getTrendList()},shareCardDetail:function(){e.showShareMenu({withShareTicket:!0})},goHome:function(){var t=this;return i(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t,!a.needAuthFlag){n.next=5;break}return a.wxAuth(a.authBizInfo),setTimeout((function(){a.goHome()}),2e3),n.abrupt("return");case 5:a.updateUserAuth(a.authBizInfo),setTimeout((function(){e.reLaunch({url:"/pages/site/trend?id="+a.authBizInfo._id})}),1e3);case 7:case"end":return n.stop()}}),n)})))()},goQQMap:function(){var e=this;wx.openLocation({latitude:e.card.corp_address.latitude,longitude:e.card.corp_address.longitude})},goWebLogin:function(){e.navigateTo({url:"/pages/my/WebLogin"})},startTalk:function(){var t=this;return i(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t,!a.needAuthFlag){n.next=5;break}return a.wxAuth(a.authBizInfo),setTimeout((function(){a.startTalk()}),2e3),n.abrupt("return");case 5:a.updateUserAuth(a.authBizInfo),setTimeout((function(){e.navigateTo({url:"/pagesSys/site/service?sourceCardId="+a.user.userInfo.cardId+"&targetCardId="+a.card._id})}),1e3);case 7:case"end":return n.stop()}}),n)})))()},popupOperate:function(){var e=this;console.log("popupOperate"),this.$nextTick((function(){e.$refs["showPopupOperate"].open()}))},popupAbout:function(){var e=this;console.log("popupAbout"),e.isUps=!0,this.$nextTick((function(){e.$refs["showPopupAbout"].open()}))},change:function(e){e.show?this.isUps=!0:this.isUps=!1},cancel:function(e){this.$refs["show"+e].close()}})};t.default=h}).call(this,n(1)["default"])},92:function(e,t,n){"use strict";n.r(t);var r=n(93),a=n(95);for(var u in a)"default"!==u&&function(e){n.d(t,e,(function(){return a[e]}))}(u);n(97);var o,i=n(15),c=Object(i["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"b7a28ab8",null,!1,r["components"],o);c.options.__file="components/uni-rate/uni-rate.vue",t["default"]=c.exports},93:function(e,t,n){"use strict";n.r(t);var r=n(94);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},94:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return o})),n.d(t,"recyclableRender",(function(){return u})),n.d(t,"components",(function(){return r}));try{r={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(n.bind(null,845))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var a=function(){var e=this,t=e.$createElement;e._self._c},u=!1,o=[];a._withStripped=!0},95:function(e,t,n){"use strict";n.r(t);var r=n(96),a=n.n(r);for(var u in r)"default"!==u&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a},96:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){Promise.all([n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(function(){return resolve(n(845))}.bind(null,n)).catch(n.oe)},a={name:"UniRate",components:{uniIcons:r},props:{isFill:{type:[Boolean,String],default:!0},color:{type:String,default:"#ececec"},activeColor:{type:String,default:"#ffca3e"},size:{type:[Number,String],default:24},value:{type:[Number,String],default:0},max:{type:[Number,String],default:5},margin:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1}},data:function(){return{valueSync:""}},computed:{stars:function(){for(var e=this.valueSync?this.valueSync:0,t=[],n=Math.floor(e),r=Math.ceil(e),a=0;a<this.max;a++)n>a?t.push({activeWitch:"100%"}):r-1===a?t.push({activeWitch:100*(e-n)+"%"}):t.push({activeWitch:"0"});return t}},created:function(){this.valueSync=Number(this.value)},methods:{_onClick:function(e){this.disabled||(this.valueSync=e+1,this.$emit("change",{value:this.valueSync}))}}};t.default=a},97:function(e,t,n){"use strict";n.r(t);var r=n(98),a=n.n(r);for(var u in r)"default"!==u&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a},98:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var r=n(100),a=n.n(r);for(var u in r)"default"!==u&&function(e){n.d(t,e,(function(){return r[e]}))}(u);t["default"]=a.a}},[[86,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagesSys/card/ShareCardDetail.js.map