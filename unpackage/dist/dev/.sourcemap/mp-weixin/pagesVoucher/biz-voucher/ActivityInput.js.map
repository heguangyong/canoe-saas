{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesVoucher/biz-voucher/ActivityInput.vue?9db8","webpack:////Users/fustic/Workspace/canoe-saas/pagesVoucher/biz-voucher/ActivityInput.vue?1e36","webpack:////Users/fustic/Workspace/canoe-saas/pagesVoucher/biz-voucher/ActivityInput.vue?1ed5","webpack:////Users/fustic/Workspace/canoe-saas/pagesVoucher/biz-voucher/ActivityInput.vue?829d","uni-app:///pagesVoucher/biz-voucher/ActivityInput.vue","webpack:////Users/fustic/Workspace/canoe-saas/pagesVoucher/biz-voucher/ActivityInput.vue?efe0"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniPopup","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","that","isLoad","existEntryFlag","loadingType","searchList","name","data","log","type","activity","price","parseInt","uni","reLaunch"],"mappings":"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","file":"pagesVoucher/biz-voucher/ActivityInput.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesVoucher/biz-voucher/ActivityInput.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./ActivityInput.vue?vue&type=template&id=b2c525ee&\"\nvar renderjs\nimport script from \"./ActivityInput.vue?vue&type=script&lang=js&\"\nexport * from \"./ActivityInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ActivityInput.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesVoucher/biz-voucher/ActivityInput.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ActivityInput.vue?vue&type=template&id=b2c525ee&\"","var components\ntry {\n  components = {\n    uniPopup: function() {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ActivityInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ActivityInput.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n        <cu-custom    :isBack=\"true\">\n            <block slot=\"content\">{{title}}</block>\n            <block slot=\"right\">\n                <view class=\"action\">\n                    <view class=\"cu-load load-cuIcon\" :class=\"isLoad?'loading':'over'\"></view>\n                </view>\n            </block>\n        </cu-custom>\n\t\t<view class=\"page bg-white\">\n\t\t\t<scroll-view>\n\t\t\t\t<form>\n\t\t\t\t\t<view class=\"padding\">\n\t\t\t\t\t\t<view class=\"cu-form-group\" v-if=\"activity.type_name=='兑换券'\">\n\t\t\t\t\t\t\t<view class=\"title\">券名称</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"如蛋糕抵用券\" v-model=\"activity.name\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\" v-if=\"activity.type_name=='满减券'\">\n\t\t\t\t\t\t\t<view class=\"title\">优惠额度</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"满 100 减 10 元\" v-model=\"activity.name\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\" v-if=\"activity.type_name=='折扣券'\">\n\t\t\t\t\t\t\t<view class=\"title\">券名称</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"如海鲜产品9折券\" v-model=\"activity.name\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<block v-if=\"activity.type_name=='代金券'\">\n\t\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t\t<view class=\"title\">券名称</view>\n\t\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t\t<input placeholder=\"如蛋糕抵用券\" v-model=\"activity.name\"></input>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t\t<view class=\"title\">面额</view>\n\t\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t\t<input placeholder=\"请输入面额\" v-model=\"activity.price\"></input>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</block>\n\t\t\t\t\t\t<view class=\"cu-form-group\" v-if=\"activity.type_name=='裂变券'\">\n\t\t\t\t\t\t\t<view class=\"title\">优惠额度</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"满 100 减 10 元\" v-model=\"activity.name\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\" v-if=\"activity.type_name=='裂变券'\">\n\t\t\t\t\t\t\t<view class=\"title\">抵用面值</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"10\" v-model=\"activity.price\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">券封面</view>\n\t\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t\t<ups-upload\n\t\t\t\t\t\t\t\t\t\tfileType=\"image\"\n\t\t\t\t\t\t\t\t\t\t:uploadFile = \"activity.cover\"\n\t\t\t\t\t\t\t\t\t\t@upload =\"uploadCover\"\n\t\t\t\t\t\t\t\t\t\t@remove = \"removeCover\"\n\t\t\t\t\t\t\t\t></ups-upload>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">使用条件</view>\n\t\t\t\t\t\t\t<input placeholder=\"使用条件...\" v-model=\"activity.use_condition\"></input>\n\t\t\t\t\t\t</view>\n\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">发券总量</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"请输入发券总量\" v-model=\"activity.num_total\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<!--<view class=\"cu-form-group\">-->\n\t\t\t\t\t\t\t<!--<view class=\"title\">限领张数</view>-->\n\t\t\t\t\t\t\t<!--<text class='cuIcon-titles text-xs text-pink-light'></text>-->\n\t\t\t\t\t\t\t<!--<input placeholder=\"请输入限领张数\" v-model=\"activity.num_limit\"></input>-->\n\t\t\t\t\t\t<!--</view>-->\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">有效日期</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"例如：2021.01.01-2021.01.31\" v-model=\"activity.valid_date\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">可用时段</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"例如：周一至周五 9:00-18:00\" v-model=\"activity.valid_time\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">使用需知</view>\n\t\t\t\t\t\t\t<textarea placeholder=\"使用需知...\" class=\"text-grey\" maxlength=\"140\" v-model=\"activity.remark\"></textarea>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group margin-top-xxs ﻿margin-bottom-xxs\">\n\t\t\t\t\t\t\t<view class=\"title\">核销入口关联</view>\n\t\t\t\t\t\t\t<text class=\"cuIcon-searchlist\"  @click.stop=\"tapSearch\"></text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">核销入口</view>\n\t\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-pink-light'></text>\n\t\t\t\t\t\t\t<input placeholder=\"请输入核销入口\" v-model=\"activity.entry_name\"></input>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</form>\n\t\t\t\t<!--页面底部抬升-->\n\t\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t\t</scroll-view>\n\t\t</view>\n\t\t<!-- 底部操作菜单 -->\n\t\t<view  v-if=\"!isUps\" class=\"cu-bar btn-group foot bg-white\">\n\t\t\t<button class=\"cu-btn  line-grey round\"   :disabled=\"isLoad\" @click=\"cancel\">取消</button>\n\t\t\t<button class=\"cu-btn  line-grey round\"   :disabled=\"isLoad\" @click=\"submit\">提交</button>\n\t\t</view>\n\t\t<!-- 遮罩 -->\n\t\t<view class=\"shade\" v-if=\"isUps\"></view>\n\t\t﻿<!-- 底部展现弹窗 -->\n\t\t<uni-popup ref=\"showEntryList\" type=\"bottom\" @change=\"change\">\n\t\t\t﻿<!-- 底部商务名片弹窗 -->\n\t\t\t<view class=\"trend-popup bg-white\">\n\t\t\t\t<text class=\"cuIcon-close trend-popup-close\" @click=\"cancelPopup('EntryList')\"></text>\n\t\t\t\t<text class=\"trend-popup-title\" >核销入口</text>\n\t\t\t\t<view class=\"cu-bar search \">\n\t\t\t\t\t<view class=\"search-form round\">\n\t\t\t\t\t\t<text class=\"cuIcon-search\"></text>\n\t\t\t\t\t\t<input @focus=\"inputFocus\" @blur=\"inputBlur\" type=\"text\" placeholder=\"输入搜索的关键词\" confirm-type=\"search\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action\">\n\t\t\t\t\t\t<button class=\"cu-btn round shadow-blur bg-grey\"     :disabled=\"isLoad\" @tap=\"getSearchList\">搜索</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"trend-popup-content\">\n\t\t\t\t\t<scroll-view scroll-y  :style=\"[{height:'calc(100vh - '+ CustomBar + 'px - 50px)'}]\">\n\t\t\t\t\t\t<view class=\"cu-list menu-avatar no-padding\">\n\t\t\t\t\t\t\t<view class=\"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs shadow rel\"  v-for=\"(item,index) in searchList\" :key=\"index\">\n\t\t\t\t\t\t\t\t<!--检索时展示区-->\n\t\t\t\t\t\t\t\t<view  class=\"cu-avatar round lg\" @tap=\"goEdit(item._id)\">\n\t\t\t\t\t\t\t\t\t<image :src=\"item.avatar\" mode=\"aspectFill\" class=\"cu-avatar round lg\"></image>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"content\" @tap=\"goEdit(item._id)\">\n\t\t\t\t\t\t\t\t\t<view class=\"text-grey\">{{item.name}}\n\t\t\t\t\t\t\t\t\t\t<text class=\"text-abc\"></text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t\t\t<buttom class=\"cu-btn margin-left radius\" @tap=\"switchEntry(index,item)\">关联</buttom>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<!--页面底部抬升-->\n\t\t\t\t\t\t<view class=\"cu-bar solid-bottom margin-top-100\"></view>\n\t\t\t\t\t</scroll-view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</uni-popup>\n\t</view>\n</template>\n\n<script>\n\timport { mapState ,mapMutations} from 'vuex';\n    import upsUpload from '@/components/ups-upload/index.vue'\n    import uniPopup from '@/components/uni-popup/uni-popup.vue';\n\n\texport default {\n\t\tcomponents:{\n            \"ups-upload\":upsUpload,\n            \"uni-popup\":uniPopup,\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n                isLoad:false,\n                isUps:false,\n                title:'',\n\t\t\t\tactivity:{\n                    template_id:'',//模版ID\n                    name:'',\n\t\t\t\t\tcover:'',//分享用图片\n                    avatar:'',//企业头像\n                    card_id:'',//卡ID\n                    card_name:'',\n                    type_code:'',\n                    type_name:'',\n                    entry_id:'',\n                    entry_name:'',\n                    price:0,\n                    use_condition:'',\n                    num_total:100,\n                    num_limit:1,\n\t\t\t\t\tnum_used:0,\n\t\t\t\t\trule:{\n                        forbidden_region:false,\n                        verified_reward:false,\n                        forbidden_reward:false,\n                        forbidden_share:false\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tentryNameChanged:false,//活动入口改变标志\n                dbEntryName:'',//缓存加载的入口名称\n                CustomBar: this.CustomBar,\n                existEntryFlag:false,//存在备选入口\n                searchList: [{}],//核销备选入口\n                //检索\n                page: 1,\n                loadingType: 0,//上拉的状态：0-loading前；1-loading中；2-没有更多了\n                search_str: '',//检索关键字\n\t\t\t}\n\t\t},\n\t\tonLoad(options) {\n\t\t    let that = this;\n            if(options.id){\n                that.getDetail(options.id);\n            }\n            // if(options.cardId){\n            //     that.activity.card_id=options.cardId;\n            //     that.getCard(options.cardId);\n            // }\n            // if(options.cardName){\n            //     that.activity.card_name = options.cardName;\n            // }\n            if(options.templateId){\n                that.getTemplate(options.templateId);\n            }\n            that.$forceUpdate();\n\t\t},\n\t\tcomputed:{\n\t\t\t...mapState(['user']),\n\t\t},\n\t\tmethods: {\n            async getTemplate(templateId){\n                let that = this;\n                that.isLoad = true;\n                if(templateId){\n                    let res = await wx.cloud.callFunction({\n                        name:'vou',\n                        data:{\n                            $url:'getTemplateDetail',\n                            id:templateId||'0',\n                        }\n                    });\n                    console.log('getTemplateDetail',res);\n                    if(res.result.code==0){\n                        let template = res.result.data;\n                        that.title = template.title;\n                        that.activity.template_id= template._id;\n                        that.activity.template_name=template.name;\n                        that.activity.type_code = template.type_code;\n                        that.activity.type_name = template.type_name;\n                        that.activity.bg_color = template.bg_color;\n                        that.activity.icon = template.icon;\n                        that.activity.num_total = template.num_total;\n                        that.activity.num_limit = template.num_limit;\n                        that.activity.valid_date = template.valid_date;\n                        that.activity.valid_time = template.valid_time;\n                        that.activity.remark = template.remark;\n                        that.activity.use_condition = template.use_condition;\n                        that.$forceUpdate();\n                        that.getSearchList();\n                    }\n\t\t\t\t}\n\t\t\t},\n            \n\t\t\tasync getDetail(id){\n\t\t\t\tlet that = this;\n                that.isLoad = true;\n\t\t\t\tif(id){\n\t\t\t\t\tlet res = await wx.cloud.callFunction({\n\t\t\t\t\t\tname:'vou',\n\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t  $url:'getActivityDetail',\n\t\t\t\t\t\t  id:id||'0',\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n                    console.log('getDetail',res);\n                    if(res.result.code==0){\n                        that.activity = res.result.data;\n                        //缓存入口名称，如果被修改，需要更新入口表数据\n                        that.dbEntryName = that.activity.entry_name;\n                    }\n\t\t\t\t}\n\t\t\t\t//初始化创建券\n\t\t\t\telse{\n\t\t\t\t\tthat.activity.user_id = that.user._id||'0';\n\t\t\t\t}\n                that.isLoad = false;\n\t\t\t},\n\n            uploadCover(fileId){\n                this.activity.cover = fileId;\n                this.$forceUpdate()\n            },\n            removeCover(){\n                this.activity.cover = \"\";\n                this.$forceUpdate()\n            },\n\n            // //领券者地区限制\n            // forbiddenRegionSwitch(e){\n            //     let that = this;\n            //     console.log('forbiddenRegionSwitch',e);\n            //     that.activity.rule.forbidden_region = !that.activity.rule.forbidden_region;\n            // },\n            // //核销后赠券\n            // verifiedRewardSwitch(e){\n            //     let that = this;\n            //     console.log('verifiedRewardSwitch',e);\n            //     that.activity.rule.verified_reward = !that.activity.rule.verified_reward;\n            // },\n            // //禁止赠送\n            // forbiddenRewardSwitch(e){\n            //     let that = this;\n            //     console.log('forbiddenRewardSwitch',e);\n            //     that.activity.rule.forbidden_reward = !that.activity.rule.forbidden_reward;\n            // },\n            // //禁止分享\n            // forbiddenShareSwitch(e){\n            //     let that = this;\n            //     console.log('forbiddenShareSwitch',e);\n            //     that.activity.rule.forbidden_share = !that.activity.rule.forbidden_share;\n            // },\n            cancel(){\n\t\t\t\tif(this.fromCreate){\n                    uni.reLaunch({url: '/pages/jm-card-holder/index',});\n\t\t\t\t}else{\n                    uni.navigateBack();\n\t\t\t\t}\n\t\t\t},\n\n            inputFocus(e) {\n                console.log(e)\n            },\n            inputBlur(e) {\n                console.log(e)\n                this.searchList = [];\n                this.search_str = e.detail.value;\n                this.page = 1;\n            },\n\n            cancelPopup(type){\n                this.$refs['show' + type].close()\n            },\n            change(e){\n                if(e.show){\n                    this.isUps = true;\n                }else{\n                    this.isUps =false;\n                }\n            },\n\n            tapSearch(){\n                this.getSearchList();\n                this.$nextTick(() => {\n                    this.isUps=true;\n                    this.$refs['showEntryList'].open();\n                })\n            },\n\n            async getSearchList(type) {\n                let that = this;\n                that.isLoad = true;\n                that.existEntryFlag = false;\n                that.loadingType = 1;\n                that.searchList = [];\n                this.page = 1;\n                let res = await wx.cloud.callFunction({\n                    name: 'vou',\n                    data: {\n                        $url: 'getEntryListBySearch',\n                        searchStr: that.search_str,\n                        cardId: that.activity.card_id,\n                        page: that.page,\n                    }\n                });\n                console.log('page',that.page,'searchList.length', res.result.data.data.length);\n                if (res.result.code == 0) {\n                    that.searchList = res.result.data.data || [];\n                    if(that.searchList.length==0){\n                        that.activity.entry_name='系统将自动创建默认核销入口';\n                    }\n                    if(that.activity._id && that.searchList.length==1){\n                        that.activity.entry_name=that.searchList[0].name;\n                        that.activity.entry_id=that.searchList[0]._id;\n\t\t\t\t\t}\n                    that.$forceUpdate();\n                    if (that.searchList.length == 0 || that.page >= 5) {\n                        that.loadingType = 2;\n                        that.isLoad = false;\n                        return;\n                    }\n                }\n                if (type == \"refresh\") {\n                    uni.stopPullDownRefresh(); // 停止刷新\n                }\n                that.isLoad = false;\n\n            },\n\n\t\t\tswitchEntry(index,item){\n                let that = this;\n                console.log('switchEntry',index,item);\n\t\t\t\tthat.activity.entry_id= item._id;\n\t\t\t\tthat.activity.entry_name= item.name;\n\t\t\t\tthat.$forceUpdate();\n                this.$refs['showEntryList'].close();\n            },\n\n\t\t\tasync submit(){\n\t\t\t    let that = this;\n\t\t\t\tthat.activity.card_id = that.user.userInfo.bizCardId;\n\t\t\t\tthat.activity.card_name = that.user.userInfo.bizCardName;\n\t\t\t\tthat.activity.avatar = that.user.userInfo.bizCardAvatar;\n\t\t\t\t//首字母为英文或汉字\n\t\t\t\tlet reg = /^[a-zA-Z\\u4e00-\\u9fa5]+$/;\n\t\t\t\tconsole.log('reg',reg.test(that.activity.name));\n                if(!that.activity.name || !reg.test(that.activity.name)){\n                    uni.showToast({\n                        icon:'none',\n                        title:'券名称需字母或汉字开头'\n                    })\n                    return;\n                }\n                //只能输入数字\n                 reg = /^[0-9]*$/;\n                let tempNum = that.activity.num_limit+that.activity.num_total;\n                if(that.activity.price!=0){\n                    tempNum +=that.activity.price;\n\t\t\t\t}\n                console.log('只能输入数字',reg.test(tempNum));\n                if(!reg.test(tempNum)){\n                    uni.showToast({\n                        icon:'none',\n                        title:'只能输入数字'\n                    })\n                    return;\n                }\n                if(that.activity.price && parseInt(that.activity.price)==0){\n                    uni.showToast({\n                        icon:'none',\n                        title:'面额不能为零'\n                    })\n                    return;\n                }\n                if(parseInt(that.activity.num_total)==0){\n                    uni.showToast({\n                        icon:'none',\n                        title:'发券总量不能为零'\n                    })\n                    return;\n                }\n                if(parseInt(that.activity.num_limit)==0){\n                    uni.showToast({\n                        icon:'none',\n                        title:'限领张数不能为零'\n                    })\n                    return;\n                }\n                if(!that.activity.valid_date){\n                    uni.showToast({\n                        icon:'none',\n                        title:'请输入有效日期'\n                    })\n                    return;\n                }\n                if(!that.activity.valid_time){\n                    uni.showToast({\n                        icon:'none',\n                        title:'请输入可用时段'\n                    })\n                    return;\n                }\n\n                that.activity.price = parseInt(that.activity.price);\n\n\t\t\t\t//如果没有关联核销入口\n\t\t\t\tif(!that.activity.entry_id){\n                    let res = await wx.cloud.callFunction({\n                        name:'vou',\n                        data:{\n                            $url:'getEntryList',\n                            cardId:that.activity.card_id,\n\t\t\t\t\t\t\ttypeCode:that.activity.type_code,\n                            status:'USING'\n                        }\n                    });\n                    console.log('vou-entries getEntryList cardId:',that.activity.card_id,'typeCode',that.activity.type_code,res.result);\n                    let result=res.result;\n                    if (result.code == 0) {\n                        if (that.page == 1) {\n                            that.isEndPage = false;\n                                that.searchList = [];\n                        }\n                        //加载为备选列表\n                        that.searchList = result.data;\n                    }\n                    //后面没数据了\n                    if(result.data.length<10){\n                        that.isEndPage = true;\n                        that.loadingType = 2;\n                    }\n                    that.isLoad=false;\n\n                    //如果没有备选核销入口，自动新建一个核销入口\n                    if(that.searchList.length==0){\n                        //初始化本类型入口信息\n\t\t\t\t\t\t//默认活动名设定为入口名称\n                        let entry = {\n                            name:that.activity.name+'核销入口',\n\t\t\t\t\t\t\tavatar:that.activity.avatar,\n\t\t\t\t\t\t\tcard_id:that.activity.card_id,\n\t\t\t\t\t\t\tcard_name:that.activity.card_name,\n                            usable:true\n                        };\n                        let res = await wx.cloud.callFunction({\n                            name:'vou',\n                            data:{\n                                $url:'saveEntry',\n                                entry:entry\n                            }\n                        });\n                        console.log('vou-entries getEntryList',res.result);\n                        if(res.result.code == 0){\n                            entry._id=res.result.data;\n                            entry.number= entry._id.substr(1,24);\n                            let res2 = await wx.cloud.callFunction({\n                                name:'vou',\n                                data:{\n                                    $url:'genEntryQrCode',\n\t\t\t\t\t\t\t\t\tid:entry._id,\n                                    number:entry.number\n                                }\n                            });\n                            console.log('生成二维码',res2);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//反写入活动中\n\t\t\t\t\t\tthat.activity.entry_id=entry._id;\n\t\t\t\t\t\tthat.activity.entry_name=entry.name;\n                    }\n\t\t\t\t}\n\n                //检查是否关联核销入口\n                if(!that.activity.entry_name){\n                    uni.showToast({\n                        icon:'none',\n                        title:'请先关联核销入口'\n                    })\n                    return;\n                }\n                console.log('activity',that.activity);\n\n                that.isLoad = true;\n                let checkValue = that.activity.name+that.activity.use_condition+that.activity.valid_date+that.activity.valid_time+that.activity.remark;\n\t\t\t\tlet secRes = await wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'msgSecCheck',\n\t\t\t\t\t\tvalue:checkValue\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconsole.log('msg security Check',secRes);\n\t\t\t\tif(secRes.result.code!=0){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\ttitle:'内容含有违规内容，请修改后提交'\n\t\t\t\t\t});\n\t\t\t\t\tthat.isLoad = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//初始化活动状态\n\t\t\t\tthat.activity.status='SAVED';\n\t\t\t\t//编辑提交\n\t\t\t\tif(that.activity._id){\n                    //更新核销入口名称\n\t\t\t\t    if(that.dbEntryName != that.activity.entry_name){\n                        await wx.cloud.callFunction({\n                            name:'vou',\n                            data:{\n                                $url:'updateEntryName',\n                                id:that.activity.entry_id,\n                                name:that.activity.entry_name\n                            }\n                        });\n\t\t\t\t\t}\n\n                    await wx.cloud.callFunction({\n                       name:'vou',\n                       data:{\n                           $url:'saveActivity',\n                           activity:that.activity\n                       }\n                    })\n\t\t\t\t}\n\t\t\t\t//新增\n\t\t\t\telse{\n                    that.activity.user_id = that.user._id;\n                    that.activity.user_name = that.user.userInfo.nickName;\n                    that.activity.user_avatar = that.user.userInfo.avatarUrl;\n                    console.log('add activity',that.activity);\n                    let res = await wx.cloud.callFunction({\n                        name:'vou',\n                        data:{\n                            $url:'saveActivity',\n                            activity:that.activity\n                        }\n                    });\n                    console.log('add activity',res);\n\t\t\t\t}\n                that.isLoad = false;\n                uni.reLaunch({\n                    url: '/pagesVoucher/biz-voucher/index?cardId='+that.activity.card_id+'&cardName='+that.activity.card_name,\n                })\n\t\t\t},\n\t\t}\n\t}\n</script>\n\n<style>\n\t.padding {\n\t\tpadding: 10rpx;\n\t}\n\n\t.text-box {\n\t\theight: 100rpx;\n\t\t/* background-color: #FFFFFF; */\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tfont-size: 24rpx;\n\t\tcolor: #353535;\n\t\tline-height: 1.8;\n\t}\n\tvideo {\n\t\twidth: 750rpx;\n\t}\n\timage {\n\t\twidth: 750rpx;\n\t}\n\n\t.comp{\n\t\tfont-size: 32rpx;\n\t\twidth: 700rpx;\n\t\tmargin: 0 auto;\n\t\tpadding: 20rpx 10rpx;\n\t\tborder-bottom: 1rpx solid #dddddd;\n\t}\n\n    /* 遮罩样式 */\n    .shade{\n        width:100%;\n        height: 100%;\n        position: fixed;\n        top:0;\n        left:0;\n        z-index: 90;\n    }\n\n    ﻿/* 底部分享 */\n    .trend-popup {\n        display: flex;\n        flex-direction: column;\n        height: 950rpx;\n        padding-bottom:62px;\n        position: fixed;\n        left:0;\n        bottom: 0;\n        width:100%;\n        z-index: 95;\n        border-top-left-radius: 3%;\n        border-top-right-radius: 3%;\n    }\n    .trend-remove-popup {\n        display: flex;\n        flex-direction: row;\n        flex-wrap: wrap;\n        justify-content: center;\n        padding: 5px;\n        height: 350rpx;\n    }\n    .trend-popup-close {\n        position:absolute;\n        top:30rpx;\n        left:30rpx;\n        font-size: 39rpx;\n        text-align: center;\n        font-weight: bold;\n        z-index: 99;\n    }\n\n    .trend-popup-title {\n        margin-top:15rpx;\n        line-height: 60rpx;\n        font-size: 28rpx;\n        padding: 5rpx 0;\n        text-align: center;\n        font-weight: bold;\n    }\n\n    .trend-popup-content {\n        /* #ifndef APP-NVUE */\n        display: flex;\n        /* #endif */\n        flex-direction: row;\n        flex-wrap: wrap;\n        justify-content: center;\n        padding: 5px;\n        max-height: 850rpx;\n    }\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ActivityInput.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ActivityInput.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}