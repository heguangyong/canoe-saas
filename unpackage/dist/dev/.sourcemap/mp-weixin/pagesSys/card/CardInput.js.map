{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardInput.vue?0365","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardInput.vue?3a2d","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardInput.vue?0fbf","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardInput.vue?e545","uni-app:///pagesSys/card/CardInput.vue","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardInput.vue?b252"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniPopup","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","log","that","list","index","subList","updateSearchList","name","data","$forceUpdate","currentUser","userInfo","bizCardId","bizCard","_id","isLinked","updateUser","user","bizCardAvatar","bizCardName"],"mappings":"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","file":"pagesSys/card/CardInput.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesSys/card/CardInput.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./CardInput.vue?vue&type=template&id=96ac8dfa&\"\nvar renderjs\nimport script from \"./CardInput.vue?vue&type=script&lang=js&\"\nexport * from \"./CardInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CardInput.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesSys/card/CardInput.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardInput.vue?vue&type=template&id=96ac8dfa&\"","var components\ntry {\n  components = {\n    uniPopup: function() {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardInput.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"\" :class=\"isUps == true ? 'prevent' : ''\">\n        <cu-custom    :isBack=\"true\">\n\t\t\t<block slot=\"backText\">返回</block>\n            <block slot=\"content\">名片</block>\n        </cu-custom>\n\t\t<scroll-view> \n\t\t\t<form>\n\t\t\t\t<view class=\"padding\">\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">姓名</view>\n\t\t\t\t\t\t<text class='cuIcon-titles text-xs text-orange'></text>\n\t\t\t\t\t\t<input placeholder=\"请输入姓名\" v-model=\"card.name\"></input>\n\t\t\t\t\t</view>\t\t\t\t\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">手机号码</view>\n\t\t\t\t\t\t<input placeholder=\"请输入手机号\" v-model=\"card.phone\"></input>\n\t\t\t\t\t\t<button open-type=\"getPhoneNumber\" @getphonenumber=\"getPhoneNumber\" class=\"cu-btn round  line-grey\"> 授权手机号 </button>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">头像</view>\n\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t<ups-upload\n\t\t\t\t\t\t\t\tfileType=\"image\"\n\t\t\t\t\t\t\t\t:uploadFile = \"card.avatar\"\n\t\t\t\t\t\t\t\t@upload =\"uploadAvatar\"\n\t\t\t\t\t\t\t\t@remove = \"removeAvatar\">\n\t\t\t\t\t\t\t</ups-upload>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">封面</view>\n\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t<ups-upload\n\t\t\t\t\t\t\t\t\tfileType=\"image\"\n\t\t\t\t\t\t\t\t\t:uploadFile = \"card.cover\"\n\t\t\t\t\t\t\t\t\t@upload =\"uploadCover\"\n\t\t\t\t\t\t\t\t\t@remove = \"removeCover\"\n\t\t\t\t\t\t\t></ups-upload>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">微信号</view>\n\t\t\t\t\t\t<input  v-model=\"card.wx_number\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">邮箱</view>\n\t\t\t\t\t\t<input v-model=\"card.email\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group margin-top-xxs\">\n\t\t\t\t\t\t<view class=\"title\">公司名称</view>\n\t\t\t\t\t\t<input  v-model=\"card.corp_name\" :disabled=\"isBindComp\"></input>\n\t\t\t\t\t\t<text class=\"cuIcon-searchlist\"  @click.stop=\"tapSearch\"></text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view v-if=\"isLinked\" class=\"cu-list menu-avatar\">\n\t\t\t\t\t\t<view class=\"cu-item\">\n\t\t\t\t\t\t\t<view  class=\"cu-avatar round lg\" >\n\t\t\t\t\t\t\t\t<image :src=\"currentUser.userInfo.bizCardAvatar\" mode=\"aspectFill\" class=\"cu-avatar round lg\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"content\">\n\t\t\t\t\t\t\t\t<view class=\"text-grey\">{{currentUser.userInfo.bizCardName}}\n\t\t\t\t\t\t\t\t\t<text class=\"text-abc\"></text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view>\n\t\t\t\t\t\t\t\t<buttom class=\"cu-btn line-grey round light margin-left\" @tap=\"removeLinked\">解除关联</buttom>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">职位</view>\n\t\t\t\t\t\t<input  v-model=\"card.corp_position\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">导航地址</view>\n\t\t\t\t\t\t<view class=\"cuIcon-locationfill\" @tap=\"chooseAddress\">{{hasAddress?card.corp_address.address:'请选择地址'}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">联系地址</view>\n\t\t\t\t\t\t<input  v-model=\"card.mailing_address\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t<view class=\"title\">介绍</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<textarea class=\"text-box font40 bg-white width100 padding-sm solid\" style=\"height: 500rpx;\" scroll-y=\"true\" maxlength=\"1200\" placeholder=\"请输入文字介绍\" v-model=\"card.introduce\" >\n\t\t\t\t\t</textarea>\n\t\t\t\t</view>\n\t\t\t</form>\n\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t</scroll-view>\n\t\t<slot v-if=\"!isUps\">\n            <!-- 底部操作菜单 -->\n            <view class=\"cu-bar btn-group foot bg-white\" style=\"z-index: 99;\">\n                <button class=\"cu-btn  round line-grey\"    @click=\"cancelSubmit\">取消</button>\n                <button class=\"cu-btn  round line-grey\"    @click=\"submit\">提交</button>\n            </view>\n\t\t</slot>\n\t\t<!-- 遮罩 -->\n\t\t<view class=\"shade\" v-if=\"isUps\"></view>\n\n\t\t<!-- 底部公司列表弹窗 -->\n\t\t<uni-popup ref=\"showBizCard\" type=\"bottom\" @change=\"change\">\n\t\t\t<view class=\"popup bg-white\">\n\t\t\t\t<text class=\"cuIcon-close popup-close\" @click=\"cancel('BizCard')\"></text>\n\t\t\t\t<text class=\"popup-title\" >公司列表</text>\n\t\t\t\t<view class=\"cu-bar search \">\n\t\t\t\t\t<view class=\"search-form round\">\n\t\t\t\t\t\t<text class=\"cuIcon-search\"></text>\n\t\t\t\t\t\t<input @focus=\"inputFocus\" @blur=\"inputBlur\" type=\"text\" placeholder=\"输入搜索的关键词\" confirm-type=\"search\"></input>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"action\">\n\t\t\t\t\t\t<button class=\"cu-btn round line-grey\"  @tap=\"getSearchList\">搜索</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"popup-content\">\n\t\t\t\t\t<scroll-view scroll-y  :style=\"[{height:'calc(100vh - '+ CustomBar + 'px - 50px)'}]\">\n\t\t\t\t\t\t<block v-for=\"(item,index) in list\" :key=\"index\">\n\t\t\t\t\t\t\t<view class=\"padding\">{{list[index].group}}</view>\n\t\t\t\t\t\t\t<view class=\"cu-list menu-avatar no-padding\">\n\t\t\t\t\t\t\t\t<view class=\"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs shadow rel\"  v-for=\"(subItem,subIndex) in item.subList\" :key=\"subIndex\">\n\t\t\t\t\t\t\t\t\t<!--检索时展示区-->\n\t\t\t\t\t\t\t\t\t<view v-if=\"subItem.card_type=='biz'\" class=\"cu-avatar round lg\" @tap=\"goEdit(subItem.id)\">\n\t\t\t\t\t\t\t\t\t\t<image :src=\"subItem.avatar\" mode=\"aspectFill\" class=\"cu-avatar round lg\"></image>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view v-else class=\"cu-avatar round lg\" @tap=\"goEdit(subItem.id)\">\n\t\t\t\t\t\t\t\t\t\t<image :src=\"subItem.avatar\" mode=\"aspectFill\" class=\"cu-avatar round lg\"></image>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view class=\"content\" @tap=\"goEdit(subItem.id)\">\n\t\t\t\t\t\t\t\t\t\t<view class=\"text-grey\">{{subItem.name}}\n\t\t\t\t\t\t\t\t\t\t\t<text class=\"text-abc\"></text>\n\t\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\t<view class=\"text-gray text-sm\">{{subItem.position?subItem.position:''}}</view>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view >\n\t\t\t\t\t\t\t\t\t\t<buttom class=\"cu-btn margin-left line-grey round\" @tap=\"addLink(subItem)\">关联</buttom>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</block>\n\t\t\t\t\t\t <view class=\"cu-tabbar-height\"></view>\n\t\t\t\t\t</scroll-view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</uni-popup>\n\t</view>\n</template>\n\n<script>\n\timport { mapState ,mapMutations} from 'vuex'\n\timport upsUpload from '@/components/ups-upload/index.vue'\n\timport uniPopup from '@/components/uni-popup/uni-popup.vue'\n\n\texport default {\n\t\tcomponents:{\n\t\t\t\"ups-upload\":upsUpload,\n\t\t\t\"uni-popup\":uniPopup,\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tcard:{\n\t\t\t\t\tcorp_address:{address:'',latitude:0,longitude:0},\n\t\t\t\t\tmailing_address:''\n\t\t\t\t},\n\n\t\t\t\tisUps:false,\n                listGroup: {},//包含字母分组的名片\n                CustomBar: this.CustomBar,\n                list: [{}],\n                index: -1,//list index\n                subList:[],//list.subList 字母分类下的名片数组\n                listCur: '',\n                searchList: [{}],\n                //检索\n                page: 1,\n                search_str: '',//检索关键字\n\t\t\t\thasAddress:false,\n                currentUser:{},//当前编辑的用户帐号\n\t\t\t\tisLinked:false//是否关联公司名片\n\t\t\t}\n\t\t},\n\t\tonReady() {\n\t\t\tthis.getDetail();\n\t\t},\n\t\tcomputed:{\n\t\t\t...mapState(['user']),\n\t\t},\n\t\tmethods: {\n            ...mapMutations(['updateUser']),\n\t\t\tasync getDetail(){\n\t\t\t\tlet that = this;\n\t\t\t\tconsole.log('getDetail user:',that.user);\n\t\t\t\tif(that.user._id){\n                    that.currentUser = that.user;\n\t\t\t\t\tthat.isLinked = that.currentUser.userInfo.bizCardId.trim().length>0;\n\t\t\t\t\tlet res = await wx.cloud.callFunction({\n\t\t\t\t\t\tname:'sys',\n\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t  $url:'getCardDetailByUserId',\n\t\t\t\t\t\t  userId:that.user._id||'0',\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log('getDetail',res);\n                    if(res.result.code==0){\n                        that.card = res.result.data;\n\t\t\t\t\t\tif(that.card.corp_address){\n                            that.hasAddress= true;\n\t\t\t\t\t\t}else{\n                            that.hasAddress= false;\n\t\t\t\t\t\t\tthat.card.corp_address = {address:'',latitude:0,longitude:0}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(that.user.userInfo.bizCardName && that.user.userInfo.bizCardName.length>0){\n                            that.card.corp_name = that.user.userInfo.bizCardName;\n\t\t\t\t\t\t}\n                    }\n\t\t\t\t}else{\n\t\t\t\t\tthat.card.user_id = that.user._id||'0';\n\t\t\t\t\tthat.card.name = that.user.userInfo.nickName;\n\t\t\t\t\tthat.card.avatar = that.user.userInfo.avatarUrl;\n\t\t\t\t\tthat.card.videos=[];\n\t\t\t\t\tthat.card.carousels =[];\n\t\t\t\t\tthat.card.corp_address = {address:'',latitude:0,longitude:0};\n\t\t\t\t\tthat.card.mailing_address='';\n                    that.hasAddress= false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync getPhoneNumber(e) {\n\t\t\t\tlet that = this;\n\t\t\t    const res = await wx.cloud.callFunction({\n\t\t\t        name: 'sys',\n\t\t\t        data: {\n\t\t\t            $url:'getPhone',\n\t\t\t            cloudId:e.detail.cloudID\n\t\t\t        }\n\t\t\t    });\n\t\t\t\tif(res.result.code == 0){\n                    uni.showToast({\n\t\t\t\t\t\ttitle: '授权成功',\n\t\t\t\t\t    success: function() {\n\t\t\t\t\t    }\n\t\t\t\t\t});\n\t\t\t\t\tthat.card.phone = res.result.data.phoneNumber;\n\t\t\t\t\tthat.$forceUpdate();\n\t\t\t\t}\n\t\t\t}, \n\t\t\tuploadAvatar(fileId){\n\t\t\t\tthis.card.avatar = fileId;\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n\t\t\tremoveAvatar(){\n\t\t\t\tthis.card.avatar = \"\";\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n            uploadCover(fileId){\n                this.card.cover = fileId;\n                this.$forceUpdate()\n            },\n            removeCover(){\n                this.card.cover = \"\";\n                this.$forceUpdate()\n            },\n\t\t\tbindCompany(){\n\t\t\t\tthis.isUps = true;\n\t\t\t\tthis.$refs.showComments.open();\n\t\t\t},\n            cancelSubmit(){\n\t\t\t\tuni.navigateBack();\n\t\t\t},\n\t\t\tasync submit(){\n\t\t\t    let that = this;\n\t\t\t\t//首字母为英文或汉字\n\t\t\t\tlet reg = /^[a-zA-Z\\u4e00-\\u9fa5]+$/;\n\t\t\t\tconsole.log('reg',reg.test(that.card.name));\n                if(!that.card.name || !reg.test(that.card.name)){\n                    uni.showToast({\n                        icon:'none',\n                        title:'姓名需字母或汉字开头'\n                    });\n                    return;\n                }\n                console.log('card',that.card,that.card.phone);\n                let checkValue = that.card.name+that.card.introduce+that.card.wx_number+that.card.corp_name+that.card.corp_position+that.card.mailing_address;\n\t\t\t\tlet res = await wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'msgSecCheck',\n\t\t\t\t\t\tvalue:checkValue\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconsole.log(res);\n\t\t\t\tif(res.result.code!=0){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\ttitle:'内容含有违规内容，请修改后提交'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//编辑提交\n\t\t\t\tif(that.card._id){\n                    await wx.cloud.callFunction({\n                        name:'sys',\n                        data:{\n                            $url:'updateCard',\n                            card:that.card,\n                        }\n                    })\n\t\t\t\t}\n\t\t\t\tuni.reLaunch({\n\t\t\t\t\turl: '/pagesSys/card/CardDetail?id='+that.card._id,\n\t\t\t\t})\n\t\t\t},\n\n            async getSearchList() {\n                if (!this.user._id) {\n                    return;\n                }\n                let that = this;\n                that.list = [];\n                that.index = 0;\n                that.subList=[];\n                this.page = 1;\n                //抓取最新的收藏记录（应对在搜索结果中进行交换名片的行为）\n                that.updateSearchList();\n                let res = await wx.cloud.callFunction({\n                    name: 'sys',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str,\n                        page: that.page,\n                    }\n                });\n                console.log('page',that.page,'searchList.length', res.result.data.length);\n                if (res.result.code == 0) {\n                    that.searchList = res.result.data || [];\n                    if (that.searchList.length == 0 || that.page >= 5) {\n                        return;\n                    }\n                    that.cachedPageList();\n                }\n            },\n\n            async getNextPage(){\n                let that = this;\n                let res = await wx.cloud.callFunction({\n                    name: 'sys',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str,\n                        page: that.page,\n                    }\n                });\n                console.log('page',that.page,'searchList.length', res.result.data.length);\n                if (res.result.code == 0) {\n                    that.searchList = res.result.data || [];\n                    if (that.searchList.length == 0 || that.page >= 5) {\n                        return;\n                    }\n                    that.cachedPageList();\n                }\n            },\n\n            cachedPageList(){\n                let that = this;\n                //字母索引\n                let start_group_index = that.searchList[0].group_index;\n                for (let searchIndex in that.searchList) {\n                    let match = false;\n                    //自己排除在外\n                    if (that.user._id == that.searchList[searchIndex].user_id) {\n                        match = true;\n                        that.searchList[searchIndex].has_holder = true;\n                        that.searchList[searchIndex].in_exchange = false;\n                    }\n                    //初始化\n                    if (!match) {\n                        that.searchList[searchIndex].has_holder = false;\n                        that.searchList[searchIndex].in_exchange = false;\n                    }\n                    //用于匹配展示字段的一致性\n                    that.searchList[searchIndex].id = that.searchList[searchIndex]._id;\n                    that.searchList[searchIndex].position = that.searchList[searchIndex].corp_position;\n                    //对检索记录结构化分组，适配收藏夹显示索引\n                    if (start_group_index == that.searchList[searchIndex].group_index) {\n                        that.subList.push(that.searchList[searchIndex])\n                    } else {\n                        that.list[that.index] = {};\n                        that.list[that.index].group = start_group_index;\n                        that.list[that.index].subList = that.subList;\n                        that.index++;\n                        that.subList = [];\n                        start_group_index = that.searchList[searchIndex].group_index;\n                        that.subList.push(that.searchList[searchIndex]);\n                    }\n                    if (searchIndex == that.searchList.length - 1) {\n                        that.list[that.index] = {};\n                        that.list[that.index].group = start_group_index;\n                        that.list[that.index].subList = that.subList;\n                    }\n                }\n                console.log('list',that.list,'index',that.index,'subList',that.subList);\n                that.listCur = that.list[20 * (that.page - 1)];\n                if (that.searchList.length < 20 ) {\n                    return;\n                }\n                that.$forceUpdate()\n            },\n\n            async updateSearchList() {\n                let that = this;\n                let res = await wx.cloud.callFunction({\n                    name: 'sys',\n                    data: {\n                        $url: 'getCardHolderByUserId',\n                        userId: that.user._id\n                    }\n                });\n                let result = res.result;\n                that.$forceUpdate();\n            },\n\t\t\tonPullDownRefresh() {\n\t\t\t\tthat.list = [];\n\t\t\t\tthat.index = 0;\n\t\t\t\tthat.subList=[];\n\t\t\t\tthis.page = 1;\n\t\t\t    uni.stopPullDownRefresh(); // 停止刷新\n\t\t\t},\n            inputFocus(e) {\n                console.log(e)\n            },\n            inputBlur(e) {\n                console.log(e);\n                this.searchList = [];\n                this.search_str = e.detail.value;\n                this.page = 1;\n            },\n            cancel(type){\n                this.$refs['show' + type].close()\n            },\n            change(e){\n                if(e.show){\n                    this.isUps = true;\n                }else{\n                    this.isUps =false;\n                }\n            },\n            tapSearch(){\n                this.getSearchList();\n                this.$nextTick(() => {\n                    this.isUps=true;\n                    this.$refs['showBizCard'].open();\n                })\n\t\t\t},\n            async addLink(bizCard){\n                let that = this;\n\t\t\t\tconsole.log('addLink',bizCard);\n\t\t\t\tthat.currentUser.userInfo.bizCardAvatar=bizCard.avatar;\n\t\t\t\tthat.currentUser.userInfo.bizCardName=bizCard.name;\n                that.currentUser.userInfo.bizCardId = bizCard._id;\n               \n\t\t\t\tawait wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'updateUserInfo',\n\t\t\t\t\t\tid:that.currentUser._id,\n                        userInfo:that.currentUser.userInfo\n\t\t\t\t\t}\n\t\t\t\t});\n                that.isLinked = true;\n                this.$refs['showBizCard'].close();\n                that.updateUser(that.user);\n\t\t\t\tthat.card.corp_name = bizCard.name;\n\t\t\t\tthat.card.corp_id = bizCard._id;\n\t\t\t\tawait wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'updateCard',\n\t\t\t\t\t\tcard:that.card,\n\t\t\t\t\t}\n\t\t\t\t})\n                that.$forceUpdate();\n\t\t\t},\n            async removeLinked(){\n                let that = this;\n                that.isLinked = false;\n                that.currentUser.userInfo.bizCardAvatar='';\n                that.currentUser.userInfo.bizCardName='';\n                that.currentUser.userInfo.bizCardId = '';\n\t\t\t\tawait wx.cloud.callFunction({\n                    name:'sys',\n                    data:{\n                        $url:'updateUserInfo',\n                        id:that.currentUser._id,\n                        userInfo:that.currentUser.userInfo\n                    }\n                });\n                that.updateUser(that.user);\n\t\t\t\tthat.card.corp_name = '';\n\t\t\t\tthat.card.corp_id = '';\n\t\t\t\tawait wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'updateCard',\n\t\t\t\t\t\tcard:that.card,\n\t\t\t\t\t}\n\t\t\t\t})\n                that.$forceUpdate();\n\t\t\t},\n\t\t\tchooseAddress(){\n\t\t\t\tlet that = this;\n\t\t\t\twx.getSetting({\n\t\t\t\t    success(res) {\n\t\t\t\t        console.log('get-setting', res.authSetting);\n\t\t\t\t        // 只返回用户请求过的授权\n\t\t\t\t        let auth = res.authSetting;\n\t\t\t\t        if (auth['scope.userLocation']) {\n\t\t\t\t            // 已授权，申请定位地址\n\t\t\t\t            that.getUserLocation();\n\t\t\t\t        } else if (auth['scope.userLocation'] === undefined) {\n\t\t\t\t            // 用户没有请求过的授权，不需要我们主动弹窗，微信会提供弹窗\n\t\t\t\t            that.getUserLocation();\n\t\t\t\t        } else if (!auth['scope.userLocation']) {\n\t\t\t\t            // 没有授权过，需要用户重新授权\n\t\t\t\t            // 这个弹窗是为了实现点击，不然openSetting会失败\n\t\t\t\t            wx.showModal({\n\t\t\t\t                title: '是否授权当前位置？',\n\t\t\t\t                content: '需要获取您的地理位置，请确认授权，否则定位功能将无法使用',\n\t\t\t\t                success: res => {\n\t\t\t\t                    if (res.confirm) {\n\t\t\t\t                        wx.openSetting({\n\t\t\t\t                            success(res) {\n\t\t\t\t                                console.log('open-setting-suc', res.authSetting);\n\t\t\t\t                                let setting = res.authSetting;\n\t\t\t\t                                if (!setting['scope.userLocation']) {\n\t\t\t\t                                    wx.showToast({\n\t\t\t\t                                        title: '地址授权失败，定位功能无法使用',\n\t\t\t\t                                        icon: 'none',\n\t\t\t\t                                    });\n\t\t\t\t                                } else {\n\t\t\t\t                                    // 地址授权成功，申请定位地址\n\t\t\t\t                                    that.getUserLocation();\n\t\t\t\t                                }\n\t\t\t\t                            },\n\t\t\t\t                            fail(err) {\n\t\t\t\t                                // 需要点击，有时候没有点击，是无法触发openSetting\n\t\t\t\t                                console.log('open-setting-fail',err);\n\t\t\t\t                            }\n\t\t\t\t                        });\n\t\t\t\t                    }\n\t\t\t\t                }\n\t\t\t\t            });\n\t\t\t\t        } \n\t\t\t\t    }\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tgetUserLocation () {\n\t\t\t\tlet that = this;\n\t\t\t    wx.chooseLocation({\n\t\t\t\t\tsuccess(res){\n\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\tconsole.log(that.card);\n\t\t\t\t\t\tif(that.card.corp_address){\n\t\t\t\t\t\t\tthat.card.corp_address.address = res.address;\n\t\t\t\t\t\t\tthat.card.corp_address.latitude = res.latitude;\n\t\t\t\t\t\t\tthat.card.corp_address.longitude = res.longitude;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tthat.card.corp_address = {address:'',latitude:0,longitude:0};\n\t\t\t\t\t\t\tthat.card.corp_address.address = res.address;\n\t\t\t\t\t\t\tthat.card.corp_address.latitude = res.latitude;\n\t\t\t\t\t\t\tthat.card.corp_address.longitude = res.longitude;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthat.hasAddress= true;\n\t\t\t\t\t\tthat.$forceUpdate();\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.padding {\n\t\tpadding: 10rpx;\n\t}\n\n\t.text-box {\n\t\theight: 100rpx;\n\t\t/* background-color: #FFFFFF; */\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tfont-size: 24rpx;\n\t\tcolor: #353535;\n\t\tline-height: 1.8;\n\t}\n\tvideo {\n\t\twidth: 750rpx;\n\t}\n\timage {\n\t\twidth: 750rpx;\n\t}\n\n\t.card-radius {\n\t\tborder-radius: 10upx;\n\t}\n\n\t/* 起到固定的作用 ,从而解决原页面触摸穿透的问题*/\n\t.prevent {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\t/*自动回到顶部*/\n\t\t/*position: fixed;*/\n\t\ttop: 0;\n\t\tleft: 0;\n\t\toverflow: hidden;\n\t}\n\n\t/* 遮罩样式 */\n\t.shade{\n\t\twidth:100%;\n\t\theight: 100%;\n\t\tposition: fixed;\n\t\ttop:0;\n\t\tleft:0;\n\t\tz-index: 90;\n\t}\n\n\t/* 底部分享 */\n\t.popup {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\theight: 950rpx;\n\t\tpadding-bottom:62px;\n\t\tposition: fixed;\n\t\tleft:0;\n\t\tbottom: 0;\n\t\twidth:100%;\n\t\tz-index: 95;\n\t\tborder-top-left-radius: 3%;\n\t\tborder-top-right-radius: 3%;\n\t}\n\t.trend-remove-popup {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\tjustify-content: center;\n\t\tpadding: 5px;\n\t\theight: 350rpx;\n\t}\n\t.popup-close {\n\t\tposition:absolute;\n\t\ttop:30rpx;\n\t\tleft:30rpx;\n\t\tfont-size: 39rpx;\n\t\ttext-align: center;\n\t\tfont-weight: bold;\n\t\tz-index: 99;\n\t}\n\n\t.popup-title {\n\t\tmargin-top:15rpx;\n\t\tline-height: 60rpx;\n\t\tfont-size: 28rpx;\n\t\tpadding: 5rpx 0;\n\t\ttext-align: center;\n\t\tfont-weight: bold;\n\t}\n\n\t.popup-content {\n\t\t/* #ifndef APP-NVUE */\n\t\tdisplay: flex;\n\t\t/* #endif */\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t\tjustify-content: center;\n\t\tpadding: 5px;\n\t\tmax-height: 850rpx;\n\t}\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardInput.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardInput.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}