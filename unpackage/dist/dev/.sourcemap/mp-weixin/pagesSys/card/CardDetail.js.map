{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardDetail.vue?889f","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardDetail.vue?6888","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardDetail.vue?5c70","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardDetail.vue?4889","uni-app:///pagesSys/card/CardDetail.vue","webpack:////Users/fustic/Workspace/canoe-saas/pagesSys/card/CardDetail.vue?232d"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","uni","showModal","that","updateUser","user","getDetail"],"mappings":"qIAAA,KACA,YACA,W,mDAFmBA,GAAGC,kCAAoCC,EAG1DC,EAAWC,a,+DCHX,sHACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,WACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,+BACZ,aAAAF,E,yCCvBf,sQ,gCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,gCCRvB,6GAAy0B,eAAG,G,6HC4E50B,Q,gxCAIA,CACE,WAAF,CACI,WAAJ,EACI,WAAJ,GAEE,KALF,WAMI,MAAJ,CACM,KAAN,oBACM,SAAN,GACM,UAAN,OAIE,QAbF,WAcI,KAAJ,aAEE,kBAhBF,SAgBA,GAGI,OAFJ,OAEA,CACM,MAAN,+BACM,SAAN,oBACM,KAAN,mDACM,QAAN,gBAIE,SAAF,MACE,EAAF,uBAEE,QAAF,QACE,EAAF,iCADA,IAEI,UAFJ,WAEA,oIACgB,EAAhB,GACgB,EAAhB,SAFA,wBAGgB,EAAhB,GAHA,SAIkB,GAAlB,oBACoB,KAApB,MACoB,KAApB,CACsB,KAAtB,wBACsB,OAAtB,cARA,OAIA,EAJA,OAWgB,EAAhB,mBACgB,EAAhB,kBACgB,EAAhB,YACgB,EAAhB,4CACA,gBACoB,EAApB,oBAhBA,+CAsBI,GAxBJ,SAwBA,GACM,EAAN,yBAGA,SA5BA,WA4BA,8GACA,cACA,iCAFA,8CAMI,KAlCJ,WAmCM,EAAN,UACQ,IAAR,oBAKI,aAzCJ,WAyCA,4HACA,sCADA,uBAEgB,EAAhB,WACkB,KAAlB,OACkB,MAAlB,YAEgB,YAAhB,WACkB,EAAlB,YACoB,IAApB,+BAEA,KAVA,0BAagBC,EAAIC,UAAU,CACZ,KAAlB,OACkB,MAAlB,MACkB,QAAlB,iBACkB,WAAlB,KACkB,YAAlB,KACkB,QAAlB,YACoB,GAApB,UACsB,EAAtB,kBAMsB,IAJA,IAAtB,IAEA,wBAEA,aAEwB,IAAxB,8BAEwB,EAAxB,qBAEsB,EAAtB,eACsB,GAAtB,oBACwB,KAAxB,MACwB,KAAxB,CAC0B,KAA1B,aAC0B,KAA1B,UAGsB,EAAtB,mBAzCA,8CA8CA,UAvFA,WAuFA,yHACA,+BACA,cACA,iEAHA,8CAOI,UA9FJ,WA+FM,KAAN,0BAEI,UAjGJ,WAkGM,KAAN,gBAEI,cApGJ,SAoGA,sIACgB,EAAhB,EACgB,EAAhB,eAFA,oBAGgB,EAAhB,qBAHA,iDAGA,EAHA,WAIgB,GAAhB,mCAJA,wBAKgB,EAAhB,2DACgB,EAAhB,+DACgB,EAAhB,mEACgB,EAAhB,iDAEgB,EAAhB,yDAVA,2DAcgBC,EAAKC,WAAWD,EAAKE,MAdrC,UAeA,uBACA,WACA,MACsB,KAAtB,iBACsB,GAAtB,WACsB,SAAtB,mBApBA,QAuBgBF,EAAKG,YAvBrB,kD,0EClNA,6GAAojD,eAAG,G","file":"pagesSys/card/CardDetail.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesSys/card/CardDetail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./CardDetail.vue?vue&type=template&id=52c20ae8&scoped=true&\"\nvar renderjs\nimport script from \"./CardDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./CardDetail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CardDetail.vue?vue&type=style&index=0&id=52c20ae8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"52c20ae8\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesSys/card/CardDetail.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardDetail.vue?vue&type=template&id=52c20ae8&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardDetail.vue?vue&type=script&lang=js&\"","<template>\n    <view>\n        <cu-custom :isBack=\"true\">\n\t\t\t<block slot=\"backText\">返回</block>\n            <block slot=\"content\">我的面板</block>\n        </cu-custom>\n        <view class=\"cu-list menu-avatar\">\n            <view class=\"cu-item  card-radius margin-sm bg-white.light shadow\" style=\"background-color:#ececec;height:110rpx;\">\n\t\t\t\t<view  class=\"cu-avatar round\"  @tap=\"goBizCard\">\n\t\t\t\t\t<image class=\"cu-avatar round\"  :src=\"user.userInfo.bizCardAvatar\"></image>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"content\"  @tap=\"goBizCard\">\n\t\t\t\t\t<view class=\"text-df text-bold\">{{user.userInfo.bizCardName}}\n\t\t\t\t\t\t<text class=\"text-abc\"></text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n                <view v-if=\"user.userInfo.sites && user.userInfo.sites.length>1\" class=\"action\">\n                    <view class=\"margin-right text-grey text-bold cuIcon-moreandroid\" style=\"font-size: 20px;\" @tap=\"showModal\"></view>\n                </view>\n            </view>\n\t\t\t<ups-card :card=\"card\">\n\t\t\t</ups-card>\n            <view class=\"cu-item  card-radius margin-sm shadow bg-white.light\" style=\"height:110rpx;\"\n                  v-for=\"(account,index) in accounts\" v-if='index>=1' :key=\"index\" @tap=\"go(account)\">\n                <view  class=\"cu-avatar bg-white\" >\n                    <image class=\"cu-avatar \"><text class=\"text-grey\" :class=\"'cuIcon-' + account.name\" style=\"font-size: 36px;\"></text></image>\n                </view>\n                <view class=\"content\" >\n                    <view class=\"text-grey\">{{account.title}}\n                        <text class=\"text-abc\"></text>\n                    </view>\n                    <view class=\"text-gray text-sm text-cut\">{{account.remark}}</view>\n                </view>\n            </view>\n        </view>\n        <view class=\"cu-modal\" :class=\"modalName=='bizCardModal'?'show':''\" @tap=\"hideModal\">\n            <view class=\"cu-dialog\" @tap.stop=\"\">\n                <view class=\"cu-bar bg-white justify-end\">\n                    <view class=\"content\">切换</view>\n                    <view class=\"action\" @tap=\"hideModal\">\n                        <text class=\"cuIcon-close text-red\"></text>\n                    </view>\n                </view>\n                <radio-group class=\"block\" @change=\"bizCardChange\">\n                    <view class=\"cu-list menu text-left\">\n                        <view class=\"cu-item\" v-for=\"(site,index) in user.userInfo.sites\" :key=\"index\">\n                            <label class=\"flex justify-between align-center flex-sub\">\n                                <view class=\"flex-sub\">{{site.bizCardName}}</view>\n                                <radio class=\"round\" :class=\"site.bizCardId==user.userInfo.bizCardId?'checked':''\"\n                                       :checked=\"site.bizCardId==user.userInfo.bizCardId\"\n                                       :value=\"site.bizCardId\"></radio>\n                            </label>\n                        </view>\n                    </view>\n                </radio-group>\n            </view>\n        </view>\n        <view class=\"cu-tabbar-height\"></view>\n        <view class=\"cu-tabbar-height\"></view>\n        <view  class=\"cu-bar bg-white tabbar border shop foot\">\n            <button class=\"action\" @tap=\"goMy\">\n                <view class=\"cuIcon-my\"></view>我的\n            </button>\n            <button class=\"action\" open-type=\"share\" >\n                <view class=\"cuIcon-share\"></view> 分享名片\n            </button>\n            <view class=\"action\" @tap=\"showAuthCode\">\n                <view class=\"cuIcon-lock\"></view>授权码\n            </view>\n            <view class=\"bg-red submit text-lg\" @tap=\"editCard\">名片编辑</view>\n        </view>\n    </view>\n</template>\n\n<script>\n\n    import { mapState,mapMutations } from 'vuex'\n    import upsCard from '@/components/ups-card/index.vue'\n    import uniRate from '@/components/uni-rate/uni-rate.vue'\n\n    export default {\n        components:{\n            'ups-card':upsCard,\n            \"uni-rate\":uniRate\n        },\n        data() {\n            return {\n                card:{name:'',remark:''},\n                accounts:[],//账号列表\n                modalName: null//模态框名称\n            }\n        },\n\n        onReady() {\n            this.getDetail();\n        },\n        onShareAppMessage(res){\n          if(res.from==='button'){\n          }\n          return{\n            title:'这是'+this.card.name+'的名片，请惠存。',\n                    imageUrl:this.card.cover||'',\n            path:\"/pagesSys/card/ShareCardDetail?id=\"+this.card._id,\n            success:function(res){\n            }\n          }\n        },\n        computed:{\n            ...mapState(['user']),\n        },\n        methods: {\n            ...mapMutations(['updateUser']),\n            async getDetail(){\n                let that = this;\n                if(that.user._id){\n                    let res = {};\n                    res = await wx.cloud.callFunction({\n                        name:'sys',\n                        data:{\n                            $url:'getCardDetailByUserId',\n                            userId:that.user._id\n                        }\n                    });\n                    that.card = res.result.data;\n                    that.cardId=that.card._id;\n                    that.accounts=[];\n                    that.user.userInfo.accounts.forEach(each=>{\n                        if(!each.is_forbidden){\n                            that.accounts.push(each);\n                        }\n                    });\n                }\n            },\n\n            go(account){\n                uni.navigateTo({\"url\":account.url,});\n            },\n\n\t\t\tasync editCard(){\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl:'/pagesSys/card/CardInput',\n\t\t\t\t})\n\t\t\t},\n\n            goMy(){\n                uni.reLaunch({\n                    url: '/pages/my/home',\n                })\n            },\n\n            //查看跨端授权码\n            async showAuthCode(){\n                if(!this.card.phone || this.card.phone.length!=11){\n                    uni.showToast({\n                        icon:'none',\n                        title:'请先完善手机号'\n                    });\n                    setTimeout(()=>{\n                        uni.navigateTo({\n                            url:'/pagesSys/card/CardInput',\n                        })\n                    },1000);\n                    return;\n                }\n                uni.showModal({\n                    icon:'none',\n                    title:'授权码',\n                    content:this.card.auth_code,\n                    cancelText: '更新',\n                    confirmText: '确认',\n                    success: res => {\n                        if (res.cancel) {\n                            this.card.auth_code = '';\n                            //设置长度，这里看需求，我这里设置了4\n                            let codeLength = 4;\n                            //设置随机字符\n                            let random = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];\n                            //循环codeLength 我设置的4就是循环4次\n                            for (let i = 0; i < codeLength; i++) {\n                                //设置随机数范围,这设置为0 ~ 36\n                                let index = Math.floor(Math.random() * 9);\n                                //字符串拼接 将每次随机的字符 进行拼接\n                                this.card.auth_code += random[index];\n                            }\n                            this.$forceUpdate();\n                            wx.cloud.callFunction({\n                                name:'sys',\n                                data:{\n                                    $url:'updateCard',\n                                    card:this.card\n                                }\n                            });\n                            this.showAuthCode();\n                        }\n                    }\n                })\n            },\n\t\t\tasync goBizCard(){\n\t\t\t\tif(this.user.userInfo.bizCardId!=''){\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\"url\": \"/pagesSys/card/BizAboutExt?id=\"+this.user.userInfo.bizCardId,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n            showModal() {\n                this.modalName = 'bizCardModal'\n            },\n            hideModal() {\n                this.modalName = null\n            },\n            async bizCardChange(e) {\n                let that = this;\n                let bizCardId = e.detail.value;\n                for(let i in that.user.userInfo.sites){\n                    if(bizCardId == that.user.userInfo.sites[i].bizCardId){\n                        that.user.userInfo.bizCardId = that.user.userInfo.sites[i].bizCardId;\n                        that.user.userInfo.bizCardName = that.user.userInfo.sites[i].bizCardName;\n                        that.user.userInfo.bizCardAvatar = that.user.userInfo.sites[i].bizCardAvatar;\n                        that.user.userInfo.role = that.user.userInfo.sites[i].role;\n                        //相应权限也需要切换\n                        that.user.userInfo.accounts = that.user.userInfo.sites[i].accounts;\n                        break;\n                    }\n                }\n                that.updateUser(that.user);\n                await wx.cloud.callFunction({\n                   name:'sys',\n                   data:{\n                       $url:'updateUserInfo',\n                       id:that.user._id,\n                       userInfo:that.user.userInfo\n                   }\n                });\n                that.getDetail();\n            },\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .page{\n        z-index: 0;\n        height: 100vh;\n    }\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardDetail.vue?vue&type=style&index=0&id=52c20ae8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./CardDetail.vue?vue&type=style&index=0&id=52c20ae8&lang=scss&scoped=true&\""],"sourceRoot":""}