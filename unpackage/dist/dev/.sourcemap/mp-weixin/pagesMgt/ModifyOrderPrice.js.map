{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/ModifyOrderPrice.vue?dd0c","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/ModifyOrderPrice.vue?6f64","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/ModifyOrderPrice.vue?9d4b","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/ModifyOrderPrice.vue?fa8c","uni-app:///pagesMgt/ModifyOrderPrice.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","l0","_self","_c","__map","order","items","item","itemIndex","$orig","__get_orig","g0","parseFloat","price","toFixed","g1","price_shipping","g2","free_price","g3","need_price","$mp","data","Object","assign","$root","recyclableRender","staticRenderFns","_withStripped","that","page","name","res","result","uni","showToast","setTimeout"],"mappings":"uIAAA,KACA,YACA,Y,mDAFmBA,GAAGC,kCAAoCC,EAG1DC,EAAWC,a,gECHX,kHACIC,EADJ,QAQIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,gCACZ,aAAAF,E,0CCtBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eAETC,GADKJ,EAAIK,MAAMC,GACVN,EAAIO,MAAMP,EAAIQ,MAAMC,OAAO,SAASC,EAAMC,GACjD,IAAIC,EAAQZ,EAAIa,WAAWH,GAEvBI,EAAKC,WAAWL,EAAKM,OAAOC,QAAQ,GACxC,MAAO,CACLL,MAAOA,EACPE,GAAIA,OAIJI,EAAKH,WAAWf,EAAIQ,MAAMW,gBAAgBF,QAAQ,GAClDG,EAAKL,WAAWf,EAAIQ,MAAMa,YAAYJ,QAAQ,GAC9CK,EAAKP,WAAWf,EAAIQ,MAAMe,YAAYN,QAAQ,GAClDjB,EAAIwB,IAAIC,KAAOC,OAAOC,OACpB,GACA,CACEC,MAAO,CACLxB,GAAIA,EACJc,GAAIA,EACJE,GAAIA,EACJE,GAAIA,MAKRO,GAAmB,EACnBC,EAAkB,GACtB/B,EAAOgC,eAAgB,G,iCChCvB,8GAAg0B,eAAG,G,8HC4Dn0B,QACA,W,4iCAGA,CACE,KADF,WAEI,MAAJ,CACM,MAAN,CACQ,IAAR,GACA,yDACA,SACA,cACA,cACA,iBACA,uBACA,aACA,eACA,aACQ,WAAR,KAIA,OAlBA,SAkBA,GACA,OACM,KAAN,eACM,QAAN,gCAGE,OAxBF,WAyBI,KAAJ,aAGE,SAAF,QACE,EAAF,uBADA,IAEI,eAFJ,WAGM,OAAN,YACQ,IAAR,IACQ,OAAR,EACA,2CAEA,OAKE,QAAF,QACE,EAAF,iCADA,IAEI,UAFJ,WAEA,wIACgB,EAAhB,EACiC,GAAbC,EAAKC,OACP,EAAlB,cAEgB,EAAhB,KALA,SAMA,uBACoBC,KAApB,MACoBT,KAApB,CACsB,KAAtB,eACsB,GAAtB,eAVA,OAMA,EANA,OAagBO,EAAKxB,MAAQ2B,EAAIC,OAAOX,KAbxC,8CAgBI,eAlBJ,SAkBA,GACM,IAAN,OACM,QAAN,wBACA,QACM,EAAN,iCACA,aACU,EAAV,6CACU,EAAV,8CAEA,+BACU,GAAV,cAEU,GAAV,qBAIM,EAAN,8DAEM,EAAN,0CACM,EAAN,gBAGI,kBAxCJ,SAwCA,GACM,IAAN,OACM,QAAN,2BACM,IAAN,IACM,EAAN,iCACA,aACU,EAAV,2CACU,EAAV,0DAEA,+BACU,GAAV,cAEU,GAAV,qBAIM,EAAN,8DAEM,EAAN,0CACM,EAAN,gBAGI,YA9DJ,WA8DA,sIACgB,EAAhB,EADA,SAEA,uBACoBS,KAApB,MACoBT,KAApB,CACsB,KAAtB,cACsB,MAAtB,WANA,OASgBY,EAAIC,UAAU,CACZ,KAAlB,UACkB,MAAlB,WAEgBC,YAAhB,WACkB,EAAlB,YACoB,IAApB,6BAEA,KAjBA,iD","file":"pagesMgt/ModifyOrderPrice.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesMgt/ModifyOrderPrice.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./ModifyOrderPrice.vue?vue&type=template&id=8d4ac8a0&\"\nvar renderjs\nimport script from \"./ModifyOrderPrice.vue?vue&type=script&lang=js&\"\nexport * from \"./ModifyOrderPrice.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesMgt/ModifyOrderPrice.vue\"\nexport default component.exports","export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ModifyOrderPrice.vue?vue&type=template&id=8d4ac8a0&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.order.items, function(item, itemIndex) {\n    var $orig = _vm.__get_orig(item)\n\n    var g0 = parseFloat(item.price).toFixed(2)\n    return {\n      $orig: $orig,\n      g0: g0\n    }\n  })\n\n  var g1 = parseFloat(_vm.order.price_shipping).toFixed(2)\n  var g2 = parseFloat(_vm.order.free_price).toFixed(2)\n  var g3 = parseFloat(_vm.order.need_price).toFixed(2)\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        g1: g1,\n        g2: g2,\n        g3: g3\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ModifyOrderPrice.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./ModifyOrderPrice.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"\" :class=\"isUps == true ? 'prevent' : ''\">\n\t\t<cu-custom    :isBack=\"true\">\n\t\t\t<block slot=\"backText\">返回</block>\n\t\t\t<block slot=\"content\">订单改价</block>\n\t\t</cu-custom>\n\t\t<view class=\"page\">\n\t\t\t<view  class=\"cu-card article solid-bottom\" style=\"width: 100%\">\n\t\t\t\t<block v-for=\"(item,itemIndex) in order.items\" :key=\"itemIndex\">\n\t\t\t\t\t<view class=\"cu-item shadow flex solid-bottom\" style=\"margin: 0 10rpx 0 10rpx; padding: 20rpx 0\" >\n\t\t\t\t\t\t<view class=\"content\" >\n\t\t\t\t\t\t\t<image :src=\"item.cover\" class=\"bg-gray\" style=\"width: 30%\"  mode=\"aspectFill\" ></image>\n\t\t\t\t\t\t\t<view class=\"desc\" style=\"width: 70%\" >\n\t\t\t\t\t\t\t\t<view class=\"text-content\" >\n\t\t\t\t\t\t\t\t\t<text clas=\"text-bold\">{{item.title}}</text>\n\t\t\t\t\t\t\t\t\t<text class=\"text-cut text-sm\">\n\t\t\t\t\t\t\t\t\t\t{{item.content}}\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<view class=\"flex margin-top-sm  justify-between\">\n\t\t\t\t\t\t\t\t\t<view  class=\"cu-capsule radius \">\n\t\t\t\t\t\t\t\t\t\t<text class=\"text-gray\">\n\t\t\t\t\t\t\t\t\t\t\t{{'¥ '+parseFloat(item.price).toFixed(2)+item.unit_name}}\n\t\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<text class=\"text-gray\">{{'x'+item.num}}</text>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t\t\t<view class=\"title\">改价为:<text class=\"margin-left-xs text-lg\">{{'¥'}}</text></view>\n\t\t\t\t\t\t\t<input type=\"number\" @blur=\"inputPriceBlur(item)\" class=\"margin-top-lg text-bold justify-center solid-bottom bg-gray\" style=\"margin-left: -20rpx;\" v-model=\"item.new_price\"></input>\n\t\t\t\t\t\t\t<view class=\"title\">折扣:</view>\n\t\t\t\t\t\t\t<input type=\"number\" @blur=\"inputDiscountBlur(item)\" class=\"margin-top-lg text-bold solid-bottom bg-gray\" style=\"margin-left: -20rpx;\" v-model=\"item.discount\"></input>\n\t\t\t\t\t\t\t<view class=\"margin-left-sm margin-top-lg action text-bold\">折</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</block>\n\t\t\t</view>\n\t\t\t<view class=\"margin-xs solid-bottom\">\n\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t<view class=\"radio title\" style=\"font-size: 26upx\">运费</view>\n\t\t\t\t\t<view class=\"text-left\">{{'¥ '+parseFloat(order.price_shipping).toFixed(2)}}</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t<view class=\"title\" ></view>\n\t\t\t\t\t<view class=\"text-left\">共减免:{{'¥ '+parseFloat(order.free_price).toFixed(2)}} 需支付<text class=\"margin-left-sm text-red text-lg text-bold\">{{'¥ '+parseFloat(order.need_price).toFixed(2)}}</text></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t\t<view class=\"cu-bar bg-white tabbar border  foot\">\n\t\t\t\t<view class=\"bg-green submit text-lg\" @tap=\"submitPrice\">确定</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n    import { mapState,mapMutations } from 'vuex'\n    import cmnUtils from '@/utils/cmnUtils.js'\n\n\n    export default {\n        data() {\n            return {\n                order: {\n                    _id:'',\n\t\t\t\t\trecipient:{key:'',name:'',phone:'',address:'',remark:''},\n\t\t\t\t\titems:[],\n\t\t\t\t\torder_price:0,\n\t\t\t\t\tprice_items:0,\n\t\t\t\t\tprice_shipping:0,\n\t\t\t\t\torder_total_item_num:0,\n\t\t\t\t\torder_num:'',\n\t\t\t\t\tcreate_at:null,\n\t\t\t\t\tfree_price:0.00,//减免费用\n                    need_price:0//应付费用\n\t\t\t\t}\n            }\n        },\n\t\tonLoad(options){\n            if(options.id){\n                this.order._id = options.id;\n                console.log('orderId',this.order._id);\n\t\t\t}\n\t\t},\n        onShow() {\n            this.getDetail();\n        },\n\n        computed:{\n            ...mapState(['user']),\n            formatDateTime(){\n                return function(time){\n                    let currentTime = time;\n                    if(currentTime){\n                        return cmnUtils.formatTime(currentTime,'yyyy-MM-dd HH:mm')\n                    }else{\n                        return \"\";\n                    }\n                }\n            },\n        },\n        methods:{\n            ...mapMutations(['updateUser']),\n            async getDetail(){\n                let that = this;\n                if (that.page == 1) {\n                    that.orderList=[]\n                }\n                let res = null;\n                res = await wx.cloud.callFunction({\n                    name:'cmn',\n                    data:{\n                        $url:'getOrderById',\n                        id:that.order._id,\n                    }\n                });\n                that.order = res.result.data;\n            },\n\n            inputPriceBlur(item) {\n                let that = this;\n                console.log('inputPriceBlur',item);\n\t\t\t\tlet newOrderPrice = 0;\n                that.order.items.forEach(_item=>{\n                    if(_item.id==item.id){\n                        _item.new_price = parseFloat(item.new_price).toFixed(2);\n                        _item.discount = ((item.new_price/item.price)*10).toFixed(1);\n                    }\n                    if(cmnUtils.isEmpty(item.new_price)){\n                        newOrderPrice +=_item.price*_item.num;\n\t\t\t\t\t}else{\n                        newOrderPrice +=_item.new_price*_item.num;\n\t\t\t\t\t}\n\t\t\t\t});\n                //减免费用\n                that.order.free_price = parseFloat(that.order.order_price - newOrderPrice).toFixed(2);\n                //应付费用\n                that.order.need_price = parseFloat(newOrderPrice).toFixed(2);\n                that.$forceUpdate();\n            },\n\n            inputDiscountBlur(item) {\n                let that =this;\n                console.log('inputDiscountBlur',item);\n                let newOrderPrice = 0;\n                that.order.items.forEach(_item=>{\n                    if(_item.id==item.id){\n                        _item.discount = parseFloat(item.discount).toFixed(1);\n                        _item.new_price = (parseFloat(item.discount)/10*item.price).toFixed(2);\n                    }\n                    if(cmnUtils.isEmpty(item.new_price)){\n                        newOrderPrice +=_item.price*_item.num;\n                    }else{\n                        newOrderPrice +=_item.new_price*_item.num;\n                    }\n                });\n                //减免费用\n                that.order.free_price = parseFloat(that.order.order_price - newOrderPrice).toFixed(2);\n                //应付费用\n                that.order.need_price = parseFloat(newOrderPrice).toFixed(2);\n                that.$forceUpdate();\n            },\n\n            async submitPrice(){\n                let that = this;\n                await wx.cloud.callFunction({\n                    name:'cmn',\n                    data:{\n                        $url:'updateOrder',\n                        order:that.order\n                    }\n                });\n                uni.showToast({\n                    icon:'success',\n                    title:'价格修改成功'\n                });\n                setTimeout (() => {\n                    uni.redirectTo({\n                        url:'/pagesMgt/BizOrderList',\n                    });\n                } , 1000 )\n\t\t\t},\n        }\n    }\n</script>\n\n<style>\n\n</style>\n"],"sourceRoot":""}