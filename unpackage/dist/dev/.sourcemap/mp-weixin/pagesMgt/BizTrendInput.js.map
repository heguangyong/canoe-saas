{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizTrendInput.vue?4309","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizTrendInput.vue?f6cd","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizTrendInput.vue?42a7","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizTrendInput.vue?f6aa","uni-app:///pagesMgt/BizTrendInput.vue","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizTrendInput.vue?0884"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","that","trend","place_order_flag","data","console","log","uni","showToast","setTimeout"],"mappings":"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","file":"pagesMgt/BizTrendInput.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesMgt/BizTrendInput.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./BizTrendInput.vue?vue&type=template&id=153f0316&\"\nvar renderjs\nimport script from \"./BizTrendInput.vue?vue&type=script&lang=js&\"\nexport * from \"./BizTrendInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BizTrendInput.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesMgt/BizTrendInput.vue\"\nexport default component.exports","export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizTrendInput.vue?vue&type=template&id=153f0316&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizTrendInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizTrendInput.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<cu-custom    :isBack=\"true\">\n\t\t\t<block slot=\"content\">布置展厅</block>\n\t\t</cu-custom>\n\t\t<scroll-view scroll-y class=\"DrawerPage\" :class=\"modalName=='viewModal'?'show':''\">\n\t\t\t<form>\n\t\t\t\t<view class=\"cu-form-group\">\n\t\t\t\t\t<view class=\"title\">标题</view>\n\t\t\t\t\t<text class='cuIcon-titles text-xs text-orange'></text>\n\t\t\t\t\t<input v-model=\"trend.title\" placeholder=\"添加标题...\"></input>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-form-group align-start\">\n\t\t\t\t\t<textarea maxlength=\"140\" v-model=\"trend.content\" placeholder=\"添加说明...\"></textarea>\n\t\t\t\t</view>\n\t\t\t\t<view v-if=\"!isShowSelectPhotoOrVideo\" class=\"padding flex\">\n\t\t\t\t\t<button class=\"flex-subline-grey  margin-xs radius justify-center\"     @tap=\"selectVideo(false)\">\n\t\t\t\t\t\t\t<text class=\"cuIcon-cameraadd margin-right\" style=\"font-size: 30px;\"></text>拍照片\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class=\"flex-sub line-grey  margin-xs radius  justify-center\"     @tap=\"selectVideo(true)\">\n\t\t\t\t\t\t<text class=\"cuIcon-record  margin-right\" style=\"font-size: 30px;\"></text>拍视频\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t\t<view v-if=\"isShowSelectPhotoOrVideo\" class=\"margin-top-lg\">\n\t\t\t\t\t<view  v-if=\"!isVideosType\" class=\"padding\" >\n\t\t\t\t\t\t<ups-movable\n\t\t\t\t\t\t\t\t:imgList = \"trend.imgList\"\n\t\t\t\t\t\t\t\timgSize= 75\n\t\t\t\t\t\t\t\tmaxNum = 9\n\t\t\t\t\t\t\t\t@moveEndList=\"moveEndListHandle\"\n\t\t\t\t\t\t\t\t@upload = \"uploadCarousels\"\n\t\t\t\t\t\t\t\t@remove = \"removeCarousels\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</ups-movable>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view v-if=\"isVideosType\" class=\"padding\" >\n\t\t\t\t\t\t<ups-uploads\n\t\t\t\t\t\t\t\tfileType=\"video\"\n\t\t\t\t\t\t\t\t:fileList = \"trend.videos\"\n\t\t\t\t\t\t\t\tmaxNum = 1\n\t\t\t\t\t\t\t\t@upload = \"uploadVideos\"\n\t\t\t\t\t\t\t\t@remove = \"removeVideos\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</ups-uploads>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t\t\t<view class=\"cu-tabbar-height\"></view>\n\t\t\t\t<!--选取展品-->\n\t\t\t\t<view class=\"grid col-2 padding bg-gray \">\n\t\t\t\t\t<button class=\"cu-btn  round line-grey\"     @tap=\"showModal\" data-target=\"viewModal\">选取关联资源</button>\n\t\t\t\t</view>\n\t\t\t\t<slot>\n\t\t\t\t\t<!--已选列表-->\n\t\t\t\t\t<view scroll-y class=\"cu-list menu product-menu margin-bottom-xl shadow-lg\">\n\t\t\t\t\t\t<slot v-if=\"isPickProduct\">\n\t\t\t\t\t\t\t<slot v-if=\"trend.productList.length>0\">\n\t\t\t\t\t\t\t\t<text class=\"cu-item text-30\"    >关联产品</text>\n\t\t\t\t\t\t\t\t<view  class=\"cu-item flow\" v-for=\"(item,index) in  trend.productList\" :key=\"index\">\n\t\t\t\t\t\t\t\t\t<ups-product :product=\"item\"></ups-product>\n\t\t\t\t\t\t\t\t\t<view class=\"action text-gray\"  @tap=\"removeProduct(item)\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"cuIcon-backdelete\"></text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t\t<slot v-else>\n\t\t\t\t\t\t\t\t<view  class=\"cu-item\">\n\t\t\t\t\t\t\t\t\t<view class=\"content\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"cuIcon-info text-gray\"></text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"text-gray\">没有放置资源</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t<slot v-if=\"!isPickProduct\">\n\t\t\t\t\t\t\t<slot v-if=\" trend.activityList.length>0\">\n\t\t\t\t\t\t\t\t<text class=\"cu-item text-30\"    >关联活动</text>\n\t\t\t\t\t\t\t\t<view  class=\"cu-item flow\" v-for=\"(item,index) in  trend.activityList\" :key=\"index\">\n\t\t\t\t\t\t\t\t\t<ups-activity :activity=\"item\"></ups-activity>\n\t\t\t\t\t\t\t\t\t<view class=\"action text-gray\"  @tap=\"removeActivity(item)\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"cuIcon-backdelete\"></text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t\t<slot v-else>\n\t\t\t\t\t\t\t\t<view  class=\"cu-item\">\n\t\t\t\t\t\t\t\t\t<view class=\"content \">\n\t\t\t\t\t\t\t\t\t\t<text class=\"cuIcon-info text-gray\"></text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"text-gray\">没有放置资源</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</slot>\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t</view>\n\t\t\t\t</slot>\n\t\t\t</form>\n\t\t</scroll-view>\n\n\t\t<view v-if=\"!isShowResource\" class=\"cu-bar btn-group  foot bg-white\">\n\t\t\t<button class=\"cu-btn   round line-grey\"    @click=\"navBack\"> 取消 </button>\n\t\t\t<button class=\"cu-btn   round line-grey\"   @click=\"submit\"> 发布 </button>\n\t\t</view>\n\t\t<view class=\"DrawerClose\" :class=\"modalName=='viewModal'?'show':''\" @tap=\"hideModal\">\n\t\t\t<text class=\"cuIcon-pullright\"></text>\n\t\t</view>\n\t\t<!--备选列表-->\n\t\t<scroll-view scroll-y class=\"DrawerWindow\" :class=\"modalName=='viewModal'?'show':''\">\n\t\t\t<view class=\"cu-list menu card-menu margin-top-xl margin-bottom-xl shadow-lg\">\n\t\t\t\t<scroll-view scroll-x class=\"bg-white nav\">\n\t\t\t\t\t<view class=\"flex text-center\">\n\t\t\t\t\t\t<view class=\"cu-item flex-sub solid-bottom\" :class=\"index==tabCur?'text-green cur':''\" v-for=\"(item,index) in 2\" :key=\"index\" @tap=\"tabSelect\" :data-id=\"index\">\n\t\t\t\t\t\t\t{{tab[index]}}\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</scroll-view>\n\t\t\t\t<slot v-if=\"tabCur==0\">\n\t\t\t\t\t<slot v-if=\"productList.length>0\">\n\t\t\t\t\t\t<view v-if=\"categories.length>1\" class='padding-sm flex flex-wrap'>\n\t\t\t\t\t\t\t<view class=\"padding-xs\" v-for=\"(item,index) in categories\" :key=\"index\">\n\t\t\t\t\t\t\t\t<view v-if=\"item.checked\" class='cu-tag bg-green radius'  @tap=\"chooseTag(index)\">{{item.label}}</view>\n\t\t\t\t\t\t\t\t<view v-else class='cu-tag line-gray radius' @tap=\"chooseTag(index,item)\">{{item.label}}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<!--仅显示未被选中的商品-->\n\t\t\t\t\t\t<view v-if=\"!item.isSelected\" class=\"cu-item flow\"     v-for=\"(item,index) in checkedProductList\" :key=\"index\">\n\t\t\t\t\t\t\t<ups-product :product=\"item\"></ups-product>\n\t\t\t\t\t\t\t<view class=\"action text-gray\"  @tap=\"addProduct(item)\">\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-add\"></text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</slot>\n\t\t\t\t\t<slot v-if=\"productList.length==0\">\n\t\t\t\t\t\t<view  class=\"cu-item arrow\"     @click=\"newProduct\">\n\t\t\t\t\t\t\t<view class=\"content\">\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-cart text-grey\"></text>\n\t\t\t\t\t\t\t\t<text class=\"text-grey\">新增展品</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</slot>\n\t\t\t\t</slot>\n\t\t\t\t<slot v-if=\"tabCur==1\">\n\t\t\t\t\t<slot v-if=\"activityList.length>0\">\n\t\t\t\t\t\t<!--仅显示未被选中的活动-->\n\t\t\t\t\t\t<view v-if=\"!item.isSelected\" class=\"cu-item flow\"     v-for=\"(item,index) in activityList\" :key=\"index\">\n\t\t\t\t\t\t\t<ups-activity :activity=\"item\"></ups-activity>\n\t\t\t\t\t\t\t<view class=\"action text-gray\"  @tap=\"addActivity(item)\">\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-add\"></text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</slot>\n\t\t\t\t\t<slot v-if=\"activityList.length==0\">\n\t\t\t\t\t\t<view  class=\"cu-item arrow\"     @click=\"newActivity\">\n\t\t\t\t\t\t\t<view class=\"content \">\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-new text-grey\"></text>\n\t\t\t\t\t\t\t\t<text class=\"text-grey\">新增活动</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</slot>\n\t\t\t\t</slot>\n\t\t\t</view>\n\t\t</scroll-view>\n\t</view>\n</template>\n\n<script>\n    import { mapState, mapMutations } from 'vuex'\n\timport upsUploads from '@/components/ups-uploads/index'\n    import upsMovable from '@/components/ups-movable/index'\n\timport upsProduct from '@/components/ups-product/index';\n\timport upsActivity from '@/components/ups-activity/index';\n\n\texport default {\n\t\tcomponents:{\n\t\t\t\"ups-uploads\":upsUploads,\n            \"ups-movable\":upsMovable,\n\t\t\t\"ups-product\":upsProduct,\n\t\t\t\"ups-activity\":upsActivity\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\ttrend:{\n\t\t\t\t\tcarousels:[],\n                    imgList:[],\n\t\t\t\t\tvideos:[],\n\t\t\t\t\tcover:'',\n\t\t\t\t\tcontent:\"\",\n\t\t\t\t\tlikes_ids:[],\n\t\t\t\t\tproductList:[],\n\t\t\t\t\tactivityList:[],\n\t\t\t\t},\n                isPickProduct:false,//是否选择货物\n\t\t\t\tproductList:[],\n                checkedProductList:[],//选中的货物\n                //产品标签分类\n                categories:[{label:'全部',checked:true}],\n\t\t\t\tactivityList:[],\n                isShowSelectPhotoOrVideo: false,//用于控制选择拍摄照片还是视频的判断，缺省隐藏\n\t\t\t\tisShowResource: false,//在选取资源后展示相关设置，缺省隐藏\n                isVideosType: false,\n                modalName:null,\n                tab:['产品','活动'],\n                tabCur: 0,\n\t\t\t}\n\t\t},\t\n\t\tonLoad() {\n            let that = this;\n            that.getProductList();\n            that.getActivityList();\n\t\t},\n\n\t\tcomputed:{\n\t\t\t...mapState(['user'])\n\t\t},\n\t\tmethods: {\n\t\t    //选择拍照还是拍视频\n            selectVideo(isVideo){\n                this.isVideosType = isVideo;\n                this.isShowSelectPhotoOrVideo = true;\n\t\t\t},\n\n\n\t\t\tasync submit(e){\n\t\t\t\tlet that = this\n\t\t\t\tlet checkValue = that.trend.title+that.trend.content;\n\t\t\t\tlet secRes = await wx.cloud.callFunction({\n\t\t\t\t\tname:'sys',\n\t\t\t\t\tdata:{\n\t\t\t\t\t  $url:'msgSecCheck',\n\t\t\t\t\t  value:checkValue\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(secRes.result.code!=0){\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ticon:'none',\n\t\t\t\t\t\ttitle:'内容含有违规内容，请修改后提交'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//内容校验\n\t\t\t\tif(that.trend.carousels.length==0 && that.trend.videos.length==0){\n                    uni.showToast({\n                        icon:'none',\n                        title:'请先选好照片或视频。'\n                    });\n                    return;\n\t\t\t\t}\n\t\t\t\t//用名片信息\n\t\t\t\tthat.trend.user_id = that.user._id;\n\t\t\t\tthat.trend.user_name = that.user.userInfo.nickName;\n\t\t\t\tthat.trend.card_id = that.user.userInfo.bizCardId;\n\t\t\t\tlet res = await wx.cloud.callFunction({\n\t\t\t\t\tname:\"sys\",\n\t\t\t\t\tdata:{\n\t\t\t\t\t    $url:'getCardDetailById',\n\t\t\t\t\t\tid:that.user.userInfo.bizCardId\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlet card = res.result.data;\n\t\t\t\tthat.trend.name = card.name;\n\t\t\t\tthat.trend.avatar = card.avatar;\n\t\t\t\tthat.trend.is_open_comments = true;\n                //默认的商品不可下订单\n                that.trend.place_order_flag = false;\n\n                //保存cover图片\n                let fileUrl = '';\n                if(that.trend.carousels.length>0){\n                    fileUrl = that.trend.carousels[0];\n                }else if(that.trend.videos.length>0){\n                    fileUrl = that.trend.videos[0];\n                }\n\n                //设定分享封面图\n\t\t\t\tres = await wx.cloud.callFunction({\n                    name:'sys',\n                    data:{\n                        $url:'convertFileIdToUrl',\n                        fileId:fileUrl,\n                    }\n                });\n                if(that.trend.carousels.length>0){\n                    that.trend.cover=res.result.data;\n                }else if(that.trend.videos.length>0){\n                    that.trend.cover=res.result.data.substring(0,res.result.data.length-3)+'jpg';\n                }\n\n\t\t\t\tres = await wx.cloud.callFunction({\n\t\t\t\t\tname:'cmn',\n                    data:{\n                        $url:'addTrend',\n                        trend:that.trend,\n                    }\n\t\t\t\t});\n                console.log(\"new trendId\",res.result._id);\n\t\t\t\t// 注意二维码需要发布上线后才能调用生成\n\t\t\t\tawait wx.cloud.callFunction({\n\t\t\t\t\tname:'cmn',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t$url:'genTrendQrcode',\n\t\t\t\t\t\tid:res.result._id,\n\t\t\t\t\t\tpage:'pagesCmn/trend/ShareTrendDetail',\n\t\t\t\t\t\twidth:430,\n\t\t\t\t\t}\n\t\t\t\t});\n                uni.showToast({\n                    icon:'success',\n                    title:'发布成功'\n                })\n                setTimeout (() => {\n                    uni.navigateTo({\n                        \"url\":\"/pagesMgt/BizTrendList\"\n                    });\n                } , 1000 )\n\t\t\t},\n\t\t\tnavBack(e){\n                uni.navigateBack();\n\t\t\t},\n            newProduct(){\n\t\t\t  \tuni.navigateTo({url:'/pagesMgt/BizProductInput'})\n\t\t\t},\n            newActivity(){\n                uni.navigateTo({url:'/pagesMgt/BizActivityInput'})\n            },\n            moveEndListHandle(imgArr){\n                let that = this;\n                that.trend.imgList = imgArr;\n                that.trend.carousels = [];\n                that.trend.imgList.forEach(each=>{\n                    that.trend.carousels.push(each.url);\n                });\n                that.$forceUpdate();\n            },\n\t\t\tuploadCarousels(fileId){\n                let that =this;\n\t\t\t\tthis.trend.carousels.push(fileId);\n                that.trend.imgList.push({'url':fileId});\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n\t\t\tremoveCarousels(idx){\n\t\t\t\tthis.trend.carousels.splice(idx, 1);\n                this.trend.imgList.splice(idx, 1);\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n\t\t\tuploadVideos(fileId){\n\t\t\t\tthis.trend.videos.push(fileId)\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n\t\t\tremoveVideos(idx){\n\t\t\t\tthis.trend.videos.splice(idx, 1)\n\t\t\t\tif(this.trend.videos.length==0){\n\t\t\t\t}\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n            async getProductList(){\n\t\t\t\t// 选择所有上架商品\n\t\t\t\tif(this.productList.length==0){\n\t\t\t\t\tlet  that = this;\n                    //获取商品\n                    let res = await wx.cloud.callFunction({\n                        name:'cmn',\n                        data:{\n                            $url:'getProductListByCardId',\n                            cardId:that.user.userInfo.bizCardId,\n                        }\n                    });\n                    let result=res.result;\n                    result.data.forEach(item => {\n                            that.productList.push(item);\n                        });\n                        that.checkedProductList = that.productList;\n                        //获取名片中的标签集\n                        res = await wx.cloud.callFunction({\n                            name:'sys',\n                            data:{\n                                $url:'getCardDetailById',\n                                id:that.user.userInfo.bizCardId,\n                            }\n                        });\n                        let card = res.result.data;\n                        let tags = card.tags||{card:'',product:'',activity:'',trend:''};\n                        let dbProductTags=tags.product||'';\n                        that.categories=[{label:'全部',checked:true}];\n                        let checkStr = '';\n                        //中文逗号替换成英文逗号\n                        dbProductTags = dbProductTags.replace(RegExp('，','g'),',');\n                        //英文逗号\n                        if(dbProductTags.indexOf(',')>0){\n                            dbProductTags.split(',').forEach(each=>{\n                                if(each.trim().length>0 && checkStr.indexOf(each)<0){\n                                    checkStr += each;\n                                    that.categories.push({label:each,checked:false});\n                                }\n                            })\n                        }\n                    }\n\t\t\t},\n\n            chooseTag(index){\n                let that = this;\n                that.isLoad =true;\n                //计算当前选中标签\n                let checkedLabels=[];\n                that.checkedProductList=[];\n\n                //点全部\n                if(index==0 ){\n                    checkedLabels.push('全部');\n                    that.categories[0].checked = true;\n                    that.checkedProductList = that.productList;\n                    that.categories.forEach(category=>{\n                        if(category.label!='全部') {\n                            category.checked = false;\n                        }\n                    });\n                }else {\n                    //计算当前被选中的标签集合\n                    that.categories[index].checked = !that.categories[index].checked;\n                    that.categories.forEach(category=>{\n                        if(category.checked){\n                            if(category.label!='全部'){\n                                checkedLabels.push(category.label);\n                            }\n                        }\n                    });\n\n                    //如果没有选中，设定默认全部\n                    if(checkedLabels.length==0){\n                        checkedLabels.push('全部');\n                        that.categories[0].checked = true;\n                        that.checkedProductList = that.productList;\n                    }else{\n                        //去掉全部\n                        that.categories[0].checked = false;\n                        //刷新选中标签对应产品列表\n                        that.productList.forEach(product=>{\n                            let productTags = product.tags||'';\n                            for(let x in checkedLabels){\n                                if(productTags.indexOf(checkedLabels[x])>=0){\n                                    that.checkedProductList.push(product);\n                                    break;\n                                }\n                            }\n                        })\n                    }\n                }\n                that.$forceUpdate();\n            },\n\n\t\t\taddProduct(item){\n                let that = this;\n                that.isPickProduct = true;\n                that.trend.activityList=[];\n                item.isSelected =true;\n                that.trend.productList.push(item);\n                that.isShowResource = that.trend.productList.length>0;\n                that.$forceUpdate()\n\t\t\t},\n\t\t\tremoveProduct(item){\n\t\t\t    let removeIndex = -1;\n\t\t\t\tfor(let i=0;i<this.trend.productList.length;i++){\n\t\t\t\t    if(item._id=== this.trend.productList[i]._id){\n                        removeIndex = i;\n                        break;\n\t\t\t\t\t}\n\t\t\t\t}\n                this.trend.productList.splice(removeIndex,1);\n\t\t\t\titem.isSelected = false;\n\t\t\t\tthis.$forceUpdate()\n\t\t\t},\n            async getActivityList(){\n                // 选择所有上架商品\n                if(this.activityList.length==0){\n                    let  that = this;\n\t\t\t\t\tlet res = await wx.cloud.callFunction({\n                        name:'cmn',\n                        data:{\n                            $url:'getActivityListByCardId',\n                            cardId:that.user.userInfo.bizCardId\n                        }\n                    });\n                    that.activityList = res.result.data;\n                    if(that.activityList.length>0){\n                        that.activityList.forEach(each=>{\n                            each.isSelected = false;\n                            let parseSignUp = each.sign_up.date+' '+each.sign_up.time;\n                            let parseSignIn = each.sign_in.date+' '+each.sign_in.time;\n                            each.sign_up = parseSignUp;\n                            each.sign_in = parseSignIn;\n                        });\n                        that.$forceUpdate()\n                    }\n                }\n            },\n            addActivity(item){\n                this.isPickProduct = false;\n                this.trend.productList=[];\n                item.isSelected =true;\n                this.trend.activityList.push(item);\n                this.isShowResource = this.trend.activityList.length>0;\n                this.$forceUpdate()\n            },\n            removeActivity(item){\n                let removeIndex = -1;\n                for(let i=0;i<this.trend.activityList.length;i++){\n                    if(item._id=== this.trend.activityList[i]._id){\n                        removeIndex = i;\n                        break;\n                    }\n                }\n                this.trend.activityList.splice(removeIndex,1);\n                item.isSelected = false;\n                this.$forceUpdate()\n            },\n\n            showModal(e) {\n                this.isShowResource = true;\n                this.modalName = e.currentTarget.dataset.target;\n            },\n\n            hideModal(e) {\n                this.isShowResource = false;\n                this.modalName = null\n            },\n            tabSelect(e) {\n                this.tabCur = e.currentTarget.dataset.id;\n                this.scrollLeft = (e.currentTarget.dataset.id - 1) * 60\n                if(this.tabCur===0){\n                }else if(this.tabCur===1){\n                }\n                else if(this.tabCur===2){\n                }\n            },\n\t\t}\n\t}\n</script>\n\n<style>\n    .product-menu{\n\t\tborder-radius: 20rpx;\n\t}\n\tpage {\n\t\tbackground-image: var(--gradualBlue);\n\t\twidth: 100vw;\n\t\toverflow: hidden;\n\t}\n\n\t.DrawerPage {\n\t\tposition: fixed;\n\t\twidth: 100vw;\n\t\theight: 85vh;\n\t\tleft: 0vw;\n\t\tbackground-color: #f1f1f1;\n\t\ttransition: all 0.4s;\n\t}\n\n\t.DrawerPage.show {\n\t\ttransform: scale(0.9, 0.9);\n\t\tleft: 88vw;\n\t\tbox-shadow: 0 0 60upx rgba(0, 0, 0, 0.2);\n\t\ttransform-origin: 0;\n\t}\n\n\t.DrawerWindow {\n\t\tposition: absolute;\n\t\twidth: 85vw;\n\t\theight: 100vh;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\ttransform: scale(0.9, 0.9) translateX(-100%);\n\t\topacity: 0;\n\t\tpointer-events: none;\n\t\ttransition: all 0.4s;\n\t\tpadding: 100upx 0;\n\t}\n\n\t.DrawerWindow.show {\n\t\ttransform: scale(1, 1) translateX(0%);\n\t\topacity: 1;\n\t\tpointer-events: all;\n\t}\n\n\t.DrawerClose {\n\t\tposition: absolute;\n\t\twidth: 40vw;\n\t\theight: 100vh;\n\t\tright: 0;\n\t\ttop: 0;\n\t\tcolor: transparent;\n\t\tpadding-bottom: 30upx;\n\t\tdisplay: flex;\n\t\talign-items: flex-end;\n\t\tjustify-content: center;\n\t\tbackground-image: linear-gradient(90deg, rgba(0, 0, 0, 0.01), rgba(0, 0, 0, 0.6));\n\t\tletter-spacing: 5px;\n\t\tfont-size: 50upx;\n\t\topacity: 0;\n\t\tpointer-events: none;\n\t\ttransition: all 0.4s;\n\t}\n\n\t.DrawerClose.show {\n\t\topacity: 1;\n\t\tpointer-events: all;\n\t\twidth: 15vw;\n\t\tcolor: #fff;\n\t}\n\n\t.DrawerPage .cu-bar.tabbar .action button.cuIcon {\n\t\twidth: 64upx;\n\t\theight: 64upx;\n\t\tline-height: 64upx;\n\t\tmargin: 0;\n\t\tdisplay: inline-block;\n\t}\n\n\t.DrawerPage .cu-bar.tabbar .action .cu-avatar {\n\t\tmargin: 0;\n\t}\n\n\t.DrawerPage .nav {\n\t\tflex: 1;\n\t}\n\n\t.DrawerPage .nav .cu-item.cur {\n\t\tborder-bottom: 0;\n\t\tposition: relative;\n\t}\n\n\t.DrawerPage .nav .cu-item.cur::after {\n\t\tcontent: \"\";\n\t\twidth: 10upx;\n\t\theight: 10upx;\n\t\tbackground-color: currentColor;\n\t\tposition: absolute;\n\t\tbottom: 10upx;\n\t\tborder-radius: 10upx;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tmargin: auto;\n\t}\n\n\t.DrawerPage .cu-bar.tabbar .action {\n\t\tflex: initial;\n\t}\n\n\t.action{\n\t\tpadding: 20rpx 20rpx 20rpx 20rpx;\n\t\tfont-size: 42rpx;\n\t}\n\n</style>\n","import mod from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizTrendInput.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizTrendInput.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}