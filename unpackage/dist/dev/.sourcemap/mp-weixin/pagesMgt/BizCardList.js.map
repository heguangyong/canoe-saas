{"version":3,"sources":["uni-app:///main.js","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizCardList.vue?d161","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizCardList.vue?5fe5","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizCardList.vue?e884","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizCardList.vue?9235","uni-app:///pagesMgt/BizCardList.vue","webpack:////Users/fustic/Workspace/canoe-saas/pagesMgt/BizCardList.vue?42bf"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","that","list","index","subList","name","data","searchList","res","result","sortBizCardList"],"mappings":"kIAAA,KACA,YACA,Y,mDAFmBA,GAAGC,kCAAoCC,EAG1DC,EAAWC,a,gECHX,yHACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,2BACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCCRvB,8GAA2zB,eAAG,G,8HCkD9zB,Q,4iCAKA,CACE,KADF,WAEI,MAAJ,CACM,WAAN,GACM,WAAN,KACM,UAAN,GACA,yBACM,UAAN,eACM,KAAN,KACM,OAAN,EACM,QAAN,GACA,OACM,OAAN,EACM,aAAN,EACM,gBAAN,EACM,eAAN,OAKE,OApBF,WAqBI,KAAJ,kBAEE,kBAvBF,WAwBI,KAAJ,QACI,KAAJ,QACI,KAAJ,WACI,KAAJ,OACA,sBACA,yBAGE,SAAF,MACE,EAAF,uBAEE,QAAF,QACE,EAAF,iCADA,IAGI,eAHJ,WAGA,wIACgB,EAAhB,EACgBC,EAAKC,KAAO,GACZD,EAAKE,MAAQ,EACbF,EAAKG,QAArB,GACgB,EAAhB,OAEgB,EAAhB,KAPA,SASA,uBACoBC,KAAM,MACNC,KAAM,CACJ,KAAtB,oBACsB,WAAtB,gBAbA,OASA,EATA,OAgBgBL,EAAKM,WAAaC,EAAIC,OAAOH,MAAQ,GAYrD,wBACkB,EAAlB,kBACkB,EAAlB,gBA9BA,+CAkCI,YArCJ,WAqCA,wIACgB,EAAhB,EACgB,EAAhB,KAFA,SAIA,uBACoBD,KAAM,MACNC,KAAM,CACJ,KAAtB,oBACsB,WAAtB,gBARA,UAIA,EAJA,OAWgBL,EAAKM,WAAaC,EAAIC,OAAOH,MAAQ,KAYrD,GAAgB,EAAhB,8BAvBA,iDA0BgBL,EAAKS,kBA1BrB,8CA6BI,gBAlEJ,WAmEM,IAAN,OAEA,8BACM,IAAN,uBAGA,sCACA,EAIA,iCAIU,EAAV,iBACU,EAAV,sBACU,EAAV,gCACU,EAAV,QACU,EAAV,WACU,EAAV,6BAPU,EAAV,8BAWA,2BACU,EAAV,iBACU,EAAV,sBACU,EAAV,iCAKM,EAAN,gBAGI,WAtGJ,SAsGA,GACM,QAAN,QAGI,UA1GJ,SA0GA,GACM,QAAN,OACM,KAAN,cACM,KAAN,0BACM,KAAN,QAGA,SAjHA,SAiHA,GACM,EAAN,YACQ,IAAR,mCAII,KAvHJ,WAwHM,EAAN,UACQ,IAAR,oBAII,MA7HJ,WA8HM,EAAN,YACQ,IAAR,gC,2ECzNA,8GAA4pC,eAAG,G","file":"pagesMgt/BizCardList.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pagesMgt/BizCardList.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./BizCardList.vue?vue&type=template&id=45734996&\"\nvar renderjs\nimport script from \"./BizCardList.vue?vue&type=script&lang=js&\"\nexport * from \"./BizCardList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BizCardList.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pagesMgt/BizCardList.vue\"\nexport default component.exports","export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizCardList.vue?vue&type=template&id=45734996&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizCardList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizCardList.vue?vue&type=script&lang=js&\"","<template>\n    <view>\n        <cu-custom    :isBack=\"true\">\n            <block slot=\"backText\">返回</block>\n            <block slot=\"content\">园区公司</block>\n        </cu-custom>\n        <view class=\"cu-bar bg-white search fixed\" :style=\"[{top:(CustomBar) + 'px'}]\">\n            <view class=\"search-form round\">\n                <text class=\"cuIcon-search\"></text>\n                <input @focus=\"inputFocus\" @blur=\"inputBlur\" type=\"text\" placeholder=\"输入搜索的关键词\" confirm-type=\"search\"></input>\n            </view>\n            <view class=\"action\">\n                <button class=\"cu-btn round  text-grey shadow-blur\"   @tap=\"getBizCardList\">搜索</button>\n            </view>\n        </view>\n        <scroll-view scroll-y  :style=\"[{height:'calc(100vh - '+ CustomBar + 'px)'}]\">\n            <block v-for=\"(item,index) in list\" :key=\"index\">\n                <view class=\"padding\">{{list[index].group}}</view>\n                <view class=\"cu-list menu-avatar no-padding\">\n                    <view class=\"cu-item  card-radius margin-top-xxs margin-left-xs margin-right-xs margin-bottom-xs shadow bg-white.light\"\n                          @tap=\"goDetail(subItem._id)\"  v-for=\"(subItem,subIndex) in item.subList\" :key=\"subIndex\">\n                        <view  class=\"cu-avatar round\" >\n                            <image :src=\"subItem.avatar\" mode=\"aspectFill\" class=\"cu-avatar round\"></image>\n                        </view>\n\n                        <view class=\"content\" >\n                            <view class=\"text-grey\">{{subItem.name}}\n                                <text class=\"text-abc\"></text>\n                            </view>\n                            <view class=\"text-gray text-sm text-cut\" >{{subItem.mailing_address}}</view>\n                        </view>\n                    </view>\n                </view>\n            </block>\n        </scroll-view>\n        <view class=\"cu-bar bg-white tabbar border foot\">\n            <button class=\"action\" @tap=\"goMy\">\n                <view class=\"cuIcon-my\"></view>我的\n            </button>\n            <!--  #ifdef MP-WEIXIN -->\n            <view class=\"bg-red submit text-lg\" @tap=\"goAdd\">录入新公司</view>\n            <!--  #endif -->\n            <!--  #ifdef H5 -->\n            <view class=\"bg-white submit text-lg\"></view>\n            <!--  #endif -->\n        </view>\n    </view>\n</template>\n\n<script>\n    import {mapState,mapMutations} from 'vuex'\n    // #ifdef H5\n    import cloudbase from '@cloudbase/js-sdk';\n    // #endif\n\n    export default {\n        data() {\n            return {\n                search_str:'',\n                searchList: [{}],\n                listGroup: {},//包含字母分组的名片\n\t\t\t\tStatusBar: this.StatusBar,\n                CustomBar: this.CustomBar,\n                list: [{}],\n                index: -1,//list index\n                subList:[],//list.subList 字母分类下的名片数组\n\t\t\t\tpage: 1,\n                isUps:false,\n                selectedIdx:-1,//选中索引\n                selectedSubIdx:-1,//选中子索引\n                selectedCardId:'-1'//选中名片ID\n            }\n        },\n\n\n        onShow() {\n            this.getBizCardList();\n        },\n        onPullDownRefresh() {\n            this.list = [];\n            this.index = 0;\n            this.subList=[];\n            this.page = 1;\n\t\t\tthis.getBizCardList();\n\t\t\tuni.stopPullDownRefresh(); // 停止刷新\n        },\n      \n        computed: {\n            ...mapState(['user']),\n        },\n        methods: {\n            ...mapMutations(['updateUser']),\n\n            async getBizCardList() {\n                let that = this;\n                that.list = [];\n                that.index = 0;\n                that.subList=[];\n                this.page = 1;\n                //根据cardId检索收藏的历史名片\n                let res = null;\n                // #ifdef MP-WEIXIN\n                res= await wx.cloud.callFunction({\n                    name: 'sys',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str\n                    }\n                });\n                that.searchList = res.result.data || [];\n                // #endif\n                // #ifdef H5\n                res= await cloudbase.callFunction({\n                    name: 'web',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str\n                    }\n                });\n                that.searchList = JSON.parse(res.result.data) || [];\n                // #endif\n                if(that.searchList.length>0){\n                    that.sortBizCardList();\n                    that.$forceUpdate()\n                }\n            },\n\n            async getNextPage(){\n                let that = this;\n                let res = null;\n                // #ifdef MP-WEIXIN\n                res= await wx.cloud.callFunction({\n                    name: 'sys',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str\n                    }\n                });\n                that.searchList = res.result.data || [];\n                // #endif\n                // #ifdef H5\n                res= await cloudbase.callFunction({\n                    name: 'web',\n                    data: {\n                        $url: 'searchBizCardList',\n                        search_str: that.search_str\n                    }\n                });\n                that.searchList = JSON.parse(res.result.data) || [];\n                // #endif\n                if (that.searchList.length == 0 || that.page >= 5) {\n                    return;\n                }\n                that.sortBizCardList();\n            },\n\n            sortBizCardList(){\n                let that = this;\n                //字母索引\n                let start_group_index = that.searchList[0].group_index;\n                for (let searchIndex in that.searchList) {\n                    let match = false;\n                    //自己排除在外\n                    if (that.user._id == that.searchList[searchIndex].user_id) {\n                        match = true;\n                    }\n\n                    //对检索记录结构化分组，适配收藏夹显示索引\n                    if (start_group_index == that.searchList[searchIndex].group_index) {\n\n                        that.subList.push(that.searchList[searchIndex])\n                    } else {\n                        that.list[that.index] = {};\n                        that.list[that.index].group = start_group_index;\n                        that.list[that.index].subList = that.subList;\n                        that.index++;\n                        that.subList = [];\n                        start_group_index = that.searchList[searchIndex].group_index;\n\n                        that.subList.push(that.searchList[searchIndex]);\n                    }\n                    if (searchIndex == that.searchList.length - 1) {\n                        that.list[that.index] = {};\n                        that.list[that.index].group = start_group_index;\n                        that.list[that.index].subList = that.subList;\n                    }\n                }\n                // console.log('list',that.list,'index',that.index,'subList',that.subList);\n\n                that.$forceUpdate()\n            },\n\n            inputFocus(e) {\n                console.log(e)\n            },\n\n            inputBlur(e) {\n                console.log(e)\n                this.searchList = [];\n                this.search_str = e.detail.value;\n                this.page = 1;\n            },\n\n\t\t\tgoDetail(cardId) {\n                uni.navigateTo({\n                    \"url\": \"/pagesSys/card/BizAbout?id=\" + cardId,\n                })\n            },\n\t\t\t\n            goMy(){\n                uni.reLaunch({\n                    url:\"/pages/my/home\"\n                })\n            },\n\n            goAdd(){\n                uni.navigateTo({\n                    \"url\":\"/pagesMgt/BizAboutInput\"\n                })\n            },\n        }\n    }\n</script>\n\n<style>\n    page {\n        padding-top: 100upx;\n    }\n\n    .card-radius {\n        border-radius: 10upx;\n    }\n    /* 起到固定的作用 ,从而解决原页面触摸穿透的问题*/\n    .prevent {\n        width: 100%;\n        height: 100%;\n        /*自动回到顶部*/\n        /*position: fixed;*/\n        top: 0;\n        left: 0;\n        overflow: hidden;\n    }\n    /* 遮罩样式 */\n    .shade{\n        width:100%;\n        height: 100%;\n        position: fixed;\n        top:0;\n        left:0;\n        z-index: 90;\n    }\n    /* 底部分享 */\n    .card-popup {\n        /* #ifndef APP-NVUE */\n        display: flex;\n        flex-direction: column;\n        /* #endif */\n        border-top-left-radius: 3%;\n        border-top-right-radius: 3%;\n    }\n\n    .card-popup-content {\n        /* #ifndef APP-NVUE */\n        display: flex;\n        /* #endif */\n        flex-direction: row;\n        flex-wrap: wrap;\n        justify-content: center;\n        padding: 5px;\n        max-height: 850rpx;\n    }\n\n    .card-popup-btn {\n        height: 90rpx;\n        line-height: 90rpx;\n        font-size: 14px;\n        border-top-color: #DADADA;\n        border-top-width: 1px;\n        border-top-style: solid;\n        text-align: center;\n        color: #666;\n    }\n\n    .remove-popup-btn {\n        height: 90rpx;\n        line-height: 90rpx;\n        font-size: 14px;\n        text-align: center;\n        color: #666;\n    }\n</style>\n","import mod from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizCardList.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./BizCardList.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}